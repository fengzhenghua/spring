<?xml version="1.0" encoding="UTF-8"?>
<services>
  <service data="com.tydic.unicom.uoc.base.common.po.SqlPo" type="jdbc">
        <create>${sql}</create>
        <update>${sql}</update>
        <delete>${sql}</delete>
    </service> 
    
  <service data="com.tydic.unicom.uoc.base.common.po.CrawlerInfoPo" type="jdbc">
      <update>
          update crawler_info set order_uuid=#{order_uuid},order_id=#{order_id},order_sourceinfo=#{order_sourceinfo},order_info=#{order_info},order_malltype=#{order_malltype},order_status=#{order_status},
          order_time1=#{order_time1},order_time2=#{order_time2},order_time3=#{order_time3},order_time4=#{order_time4},order_time5=#{order_time5},oth1=#{oth1},oth2=#{oth2},
          sale_order_no=#{sale_order_no},serv_order_no_list=#{serv_order_no_list},cbssnum=#{cbssnum},usim=#{usim},logistics_no=#{logistics_no} where order_uuid=#{order_uuid}
      </update>
      <query name="queryCrawlerInfoBySaleOrderNo">
          select order_uuid,order_id,order_sourceinfo,order_info,order_malltype,order_createtime,order_status,order_time1,order_time2,
          order_time3,order_time4,order_time5,oth1,oth2,sale_order_no,serv_order_no_list,cbssnum,usim,logistics_no from crawler_info where sale_order_no=#{filter.sale_order_no}
      </query>
      <query name="queryCrawlerInfoByServOrderNo">
          select order_uuid,order_id,order_sourceinfo,order_info,order_malltype,order_createtime,order_status,order_time1,order_time2,
          order_time3,order_time4,order_time5,oth1,oth2,sale_order_no,serv_order_no_list,cbssnum,usim,logistics_no from crawler_info where serv_order_no_list=#{filter.serv_order_no_list}
      </query>
  </service>
  
  <service data="com.tydic.unicom.uoc.base.uochis.po.ProcInstTaskAssignDepartHisPo" type="jdbc">
      <create>
          insert into task_assign_depart_h (order_no, province_code, area_code, part_month, assign_depart_no) 
	    	values (#{order_no}, #{province_code}, #{area_code}, #{part_month}, #{assign_depart_no})
      </create>
  </service>
  <service data="com.tydic.unicom.uoc.base.uochis.po.ProcInstTaskAssignRecordHisPo" type="jdbc">
      <create>
         insert into task_assign_record_h (id,task_id,order_no,province_code, area_code, part_month, assign_time,assign_oper_no,to_depart_no,to_oper_no) 
	    	values (#{id}, #{task_id}, #{order_no}, #{province_code}, #{area_code}, #{part_month}, all_to_date(#{assign_time},'yyyy-mm-dd hh:mm:ss'),#{assign_oper_no},#{to_depart_no},#{to_oper_no})
      </create>
  </service>
  <service data="com.tydic.unicom.uoc.base.uochis.po.ProcInstTaskAssignOperHisPo" type="jdbc">
      <create>
         insert into task_assign_oper_h (order_no, province_code, area_code, part_month, assign_oper_no) 
	    	values (#{order_no}, #{province_code}, #{area_code}, #{part_month}, #{assign_oper_no})
      </create>
  </service>
   <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcModAppPo" type="jdbc">
        <create>
           insert into proc_mod_app (id,proc_mod_code,proc_mod_name,province_code,area_code,oper_code,used_time_len) 
           values (#{id},#{proc_mod_code},#{proc_mod_name},#{province_code},#{area_code},#{oper_code},#{used_time_len}) 
        </create>
        <delete>
            delete from proc_mod_app where id=#{id}
        </delete>      
        <update>
            update proc_mod_app set id=#{id},proc_mod_code=#{proc_mod_code},proc_mod_name=#{proc_mod_name},province_code=#{province_code},area_code=#{area_code},oper_code=#{oper_code},used_time_len=#{used_time_len}
             where id=#{id}
        </update>
        <query name="queryProcModAppAll">
            select id,proc_mod_code,proc_mod_name,province_code,province_code,area_code,oper_code,used_time_len from proc_mod_app
        </query>
        <query name= "queryProcModAppList">
           select id,proc_mod_code,proc_mod_name,province_code,province_code,area_code,oper_code,used_time_len from proc_mod_app where 1=1 
             <if test="filter.proc_mod_code != null and filter.proc_mod_code != ''">
          			 and proc_mod_code=#{filter.proc_mod_code}
         	 </if>
             <if test="filter.proc_mod_name != null and filter.proc_mod_name != ''">
          			 and proc_mod_name like '${filter.proc_mod_name}%'
         	 </if>
            limit ${filter.offset},${filter.limit}
        </query>
        <query name= "queryProcModAppListCount">
           select id,proc_mod_code,proc_mod_name,province_code,province_code,area_code,oper_code,used_time_len from proc_mod_app where 1=1 
       		  <if test="filter.proc_mod_code != null and filter.proc_mod_code != ''">
          			 and proc_mod_code=#{filter.proc_mod_code}
         	</if>
       		 <if test="filter.proc_mod_name != null and filter.proc_mod_name != ''">
          			 and proc_mod_name like '${filter.proc_mod_name}%'
         	</if>
        </query>        
        <query name="queryProcModAppByProvinceCodeAndAreaCodeAndOperCode">
            select id,proc_mod_code,proc_mod_name,province_code,province_code,area_code,oper_code,used_time_len from proc_mod_app where 1=1
            <if test="filter.province_code != null and filter.province_code != ''">
                and province_code = '${filter.province_code}'
            </if>
            <if test="filter.area_code != null and filter.area_code != ''">
                and area_code = '${filter.area_code}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
        </query>
    </service>
    <service data="com.tydic.unicom.uoc.base.uoccode.po.CodeListPo" type="jdbc">
        <query name="queryCodeListByTypeCode">
            select list_id,type_code,code_id,code_name,seq_id,macro_code,parent_type_code,parent_code_id,eff_flag,province_code,area_code from code_list where type_code=#{filter.type_code}
        </query>
        <query name="queryCodeListAll">
            select list_id,type_code,code_id,code_name,seq_id,macro_code,parent_type_code,parent_code_id,eff_flag,province_code,area_code from code_list
        </query>
        <update>
            update code_list set code_id=#{code_id}
            where list_id=#{list_id}
        </update>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.CodeOperSendPo" type="jdbc">
   		<get>
   		    select oper_no,send_name,real_phone,send_addr from code_oper_send where oper_no =#{oper_no}
   		</get>
   		<create>
   		    insert into code_oper_send(oper_no,send_name,real_phone,send_addr) values(#{oper_no},#{send_name},#{real_phone},#{send_addr})
   		</create>
   		<update>
   		    update code_oper_send t set t.oper_no=#{oper_no},t.send_name=#{send_name},t.real_phone=#{real_phone},t.send_addr=#{send_addr} where t.oper_no=#{oper_no}
   		</update>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcFlowParamPo" type="jdbc">
        <query name="queryProcFlowParamByProcModCodeAndTacheCode">
            select id,proc_mod_code,province_code,area_code,tache_code,cond_param from proc_flow_param where proc_mod_code=#{filter.proc_mod_code} and tache_code=#{filter.tache_code}
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.CodeListMapPo" type="jdbc">
        <query name="queryCodeListMapAll">
            select map_list_id,type_code,code_id,map_id,map_name,system,province_code,area_code from code_list_map
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.CodeListTabFieldPo" type="jdbc">
        <query name="queryCodeListTabFieldAll">
            select id,real_engine,tab_name,field_name,type_code,province_code,area_code from code_list_tab_field
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.CodeTypePo" type="jdbc">
        <query name="queryCodeTypeAll">
            select type_code,type_name,max_length,load_flag,app_type,data_type,province_code,area_code from code_type
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.CodeTaskPkgAppPo" type="jdbc">
    	<query name="queryCodeTaskPkgAppById">
    	 	select id,pkg_id,role_id from code_task_pkg_app where 1=1
            <if test="filter.pkg_id != null and filter.pkg_id != ''">
                and pkg_id=#{filter.pkg_id}
       		</if>
       		<if test="filter.role_id != null and filter.role_id != ''">
                and role_id in (${filter.role_id})
       		</if> 
    	</query>
    	<query name="queryCodeTaskPkgApp">
    	 	select distinct pkg_id from code_task_pkg_app where 1=1
       		<if test="filter.role_id != null and filter.role_id != ''">
                and role_id in (${filter.role_id})
       		</if>
       		 limit ${filter.offset},${filter.limit}
    	</query>
    	<query name="queryCodeTaskPkgAppCount">
    	 	select distinct pkg_id from code_task_pkg_app where 1=1
            <if test="filter.role_id != null and filter.role_id != ''">
                and role_id in (${filter.role_id})
       		</if>
    	</query>
    	<create>
    	    insert into  code_task_pkg_app(id,pkg_id,role_id) values (#{id},#{pkg_id},#{role_id})
    	</create>
    	<update>
    	    update code_task_pkg_app set pkg_id=#{pkg_id},role_id=#{role_id} where id=#{id}
    	</update>
    	<delete>
    	    delete from code_task_pkg_app where pkg_id=#{pkg_id}
    	</delete>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.CodeTaskPkgDefinePo" type="jdbc">
    	<query name="queryCodeTaskPkgDefineByPo">
    	 	select pkg_id,pkg_name,task_num,state,create_oper_no,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss') create_time from code_task_pkg_define where 1=1
            <if test="filter.pkg_id != null and filter.pkg_id != ''">
                and pkg_id=#{filter.pkg_id}
       		</if>
       		<if test="filter.pkg_name != null and filter.pkg_name != ''">
                and pkg_name like '%${filter.pkg_name}%'
       		</if>
       		order by create_time desc
    	</query>
    	<query name="queryCodeTaskPkgDefine">
    	 	select distinct pkg_id,pkg_name,task_num,state,create_oper_no,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss') create_time from code_task_pkg_define where 1=1
            <if test="filter.pkg_id != null and filter.pkg_id != ''">
                and pkg_id=#{filter.pkg_id}
       		</if>
       		 limit ${filter.offset},${filter.limit}
    	</query>
    	<query name="queryCodeTaskPkgDefineCount">
    	 	select pkg_id,pkg_name,task_num,state,create_oper_no,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss') create_time from code_task_pkg_define where 1=1
            <if test="filter.pkg_id != null and filter.pkg_id != ''">
                and pkg_id=#{filter.pkg_id}
       		</if>
    	</query>
    	<create>
    	    insert into code_task_pkg_define (pkg_id,pkg_name,task_num,state,create_oper_no,create_time) values (#{pkg_id},#{pkg_name},#{task_num},#{state},#{create_oper_no},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'))
    	</create>
    	<update>
    	    update code_task_pkg_define set pkg_id=#{pkg_id},pkg_name=#{pkg_name},task_num=#{task_num},state=#{state},create_oper_no=#{create_oper_no},create_time=all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss') where pkg_id=#{pkg_id}
    	</update>
    	<delete>
    	    delete from code_task_pkg_define where pkg_id=#{pkg_id}
    	</delete>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uoccode.po.CodeTaskPkgDesignPo" type="jdbc">
    	<query name="queryCodeTaskPkgDesignByPo">
    	 	select id,pkg_id,oper_code,product_id,tache_code,num from code_task_pkg_design where 1=1
            <if test="filter.pkg_id != null and filter.pkg_id != ''">
                and pkg_id=#{filter.pkg_id}
       		</if>
       		 <if test="filter.oper_code != null and filter.oper_code != ''">
                and  pkg_id in (select pkg_id from code_task_pkg_design  where pkg_id=#{filter.pkg_id} and oper_code=#{filter.oper_code})
       		</if>
       		<if test="filter.product_id != null and filter.product_id != ''">
                and  pkg_id in (select pkg_id from code_task_pkg_design  where pkg_id=#{filter.pkg_id} and product_id=#{filter.product_id})
       		</if>
       		<if test="filter.tache_code != null and filter.tache_code != ''">
                and  pkg_id in (select pkg_id from code_task_pkg_design  where pkg_id=#{filter.pkg_id} and tache_code=#{filter.tache_code})
       		</if>
    	</query>
    	<query name="queryCodeTaskPkgDesign">
    	    select distinct id,pkg_id,oper_code,product_id,tache_code,num from code_task_pkg_design where 1=1
             <if test="filter.id != null and filter.id != ''">
                and id=#{filter.id}
       		 </if>
             <if test="filter.pkg_id != null and filter.pkg_id != ''">
                and pkg_id=#{filter.pkg_id}
       		 </if>
       		 limit ${filter.offset},${filter.limit}
    	</query>
    	<query name="queryCodeTaskPkgDesignCount">
    	    select id,pkg_id,oper_code,product_id,tache_code,num from code_task_pkg_design where 1=1
             <if test="filter.id != null and filter.id != ''">
                and id=#{filter.id}
       		</if>
            <if test="filter.pkg_id != null and filter.pkg_id != ''">
                and pkg_id=#{filter.pkg_id}
       		</if>       		
    	</query>
    	<create>
    	    insert into code_task_pkg_design (id,pkg_id,oper_code,product_id,tache_code,num)values(#{id},#{pkg_id},#{oper_code},#{product_id},#{tache_code},#{num})
    	</create>
    	<update>
    	    update code_task_pkg_design set pkg_id=#{pkg_id},oper_code=#{oper_code},product_id=#{product_id},tache_code=#{tache_code},num=#{num} where id=#{id}
    	</update>
    	<delete>
    	    delete from code_task_pkg_design where pkg_id=#{pkg_id}
    	</delete>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcModTacheServicePo" type="jdbc">      
        <query name= "queryProcModTacheServiceList">
            select id,tache_code,service_name,service_desc,sort,input_str,province_code,area_code,queue_id,queue_name,oper_code from proc_tache_service where 1=1
            <if test="filter.service_name != null and filter.service_name != ''">
                and service_name=#{filter.service_name}
       		 </if>
       		 <if test="filter.queue_id != null and filter.queue_id != ''">
                and queue_id=#{filter.queue_id} 
       		 </if> 
       		 <if test="filter.tache_code != null and filter.tache_code != ''">
               and tache_code=#{filter.tache_code}
       		 </if>
       		 <if test="filter.province_code != null and filter.province_code != ''">
                 and province_code=#{filter.province_code}
       		 </if>
       		 <if test="filter.area_code != null and filter.area_code != ''">
                and area_code=#{filter.area_code}
       		 </if>       		     		 
            limit ${filter.offset},${filter.limit}
        </query>
        <query name= "queryProcModTacheServiceListCount">
           select id,tache_code,service_name,service_desc,sort,input_str,province_code,area_code,queue_id,queue_name,oper_code from proc_tache_service where 1=1
          <if test="filter.service_name != null and filter.service_name != ''">
                and service_name=#{filter.service_name}
       		 </if>
       		 <if test="filter.queue_id != null and filter.queue_id != ''">
                and queue_id=#{filter.queue_id} 
       		 </if> 
       		 <if test="filter.tache_code != null and filter.tache_code != ''">
               and tache_code=#{filter.tache_code}
       		 </if>
       		 <if test="filter.province_code != null and filter.province_code != ''">
                 and province_code=#{filter.province_code}
       		 </if>
       		 <if test="filter.area_code != null and filter.area_code != ''">
                and area_code=#{filter.area_code}
       		 </if>  
        </query>
        
        <create>
           insert into proc_tache_service (id,tache_code,service_name,queue_id,service_desc,queue_name,sort,input_str,province_code,area_code) 
           values (#{id},#{tache_code},#{service_name},#{queue_id},#{service_desc},#{queue_name},#{sort},#{input_str},#{province_code},#{area_code}) 
        </create>
        <delete>
            delete from proc_tache_service where id=#{id}
        </delete>      
        <update>
            update proc_tache_service set id=#{id},tache_code=#{tache_code},service_name=#{service_name},queue_id=#{queue_id},service_desc=#{service_desc},queue_name=#{queue_name},sort=#{sort},input_str=#{input_str},province_code=#{province_code},area_code=#{area_code}
             where id=#{id}
        </update>
        <query name="queryProcModTacheServiceByTacheCodeAndProvinceAndArea">
            select id,tache_code,service_name,service_desc,sort,input_str,province_code,area_code,queue_id,queue_name,oper_code from proc_tache_service where tache_code=#{filter.tache_code} and province_code=#{filter.province_code} and area_code=#{filter.area_code} and oper_code=#{filter.oper_code}
        </query>
        <query name="queryProcModTacheServiceAll">
            select id,tache_code,service_name,service_desc,sort,input_str,province_code,area_code,queue_id,queue_name,oper_code from proc_tache_service
        </query>
    </service>
     <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcModTacheBtnPo" type="jdbc">      
        <query name= "queryProcModTacheBtnList">
            select id,tache_code,btn_code,btn_desc,sort,call_url,province_code,area_code from proc_tache_btn where 1=1
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code=#{filter.tache_code}
       		 </if>
       		 <if test="filter.province_code != null and filter.province_code != ''">
                and province_code=#{filter.province_code} 
       		 </if>
       		  <if test="filter.area_code != null and filter.area_code != ''">
                 and area_code=#{filter.area_code}
       		 </if>             
            limit ${filter.offset},${filter.limit}
        </query>
        <query name= "queryProcModTacheBtnListCount">
           select id,tache_code,btn_code,btn_desc,sort,call_url,province_code,area_code from proc_tache_btn where 1=1
           <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code=#{filter.tache_code}
       		 </if>
       		 <if test="filter.province_code != null and filter.province_code != ''">
                and province_code=#{filter.province_code} 
       		 </if>
       		  <if test="filter.area_code != null and filter.area_code != ''">
                 and area_code=#{filter.area_code}
       		 </if>
        </query>
        <query name="queryProcModTacheBtnAll">
            select id,tache_code,btn_code,btn_desc,sort,call_url,province_code,area_code from proc_tache_btn
        </query>
        <create>
           insert into proc_tache_btn (id,tache_code,btn_code,btn_desc,sort,call_url,province_code,area_code) 
           values (#{id},#{tache_code},#{btn_code},#{btn_desc},#{sort},#{call_url},#{province_code},#{area_code}) 
        </create>
        <delete>
            delete from proc_tache_btn where id=#{id}
        </delete>      
        <update>
            update proc_tache_btn set id=#{id},tache_code=#{tache_code},btn_code=#{btn_code},btn_desc=#{btn_desc},sort=#{sort},call_url=#{call_url},province_code=#{province_code},area_code=#{area_code}
             where id=#{id}
        </update>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcTacheRetPo" type="jdbc">
	    <query name="queryProcTacheRetByPo">
	    	select id,tache_code,oper_code,accept_system,call_url,call_ord_mod,province_code,area_code from proc_tache_ret where 1=1
	    	<if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.province_code != null and filter.province_code != ''">
                and province_code = '${filter.province_code}'
            </if>
            <if test="filter.area_code != null and filter.area_code != ''">
                and area_code = '${filter.area_code}'
            </if>
            <if test="filter.accept_system != null and filter.accept_system != ''">
                and accept_system = '${filter.accept_system}'
            </if>
	    </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.SequencesPo" type="jdbc">
        <query name="querySequences">
            select id,seq_code,province_code,area_code,seq_desc,seq_head,seq_time_str,seq_tail_type,seq_tail_lenth,seq_tail_begin,seq_tail_curr,seq_tail_step,seq_tail_end,seq_tail_cir_type,seq_tail_rightjustify from sequences
        </query>
        <query name="querySequencesBySeqCodeAndProvinceCodeAndAreaCode">
            select id,seq_code,province_code,area_code,seq_desc,seq_head,seq_time_str,seq_tail_type,seq_tail_lenth,seq_tail_begin,seq_tail_curr,seq_tail_step,seq_tail_end,seq_tail_cir_type,seq_tail_rightjustify from sequences where seq_code=#{filter.seq_code} and province_code=#{filter.province_code} and area_code=#{filter.area_code}
        </query>
        <update>
            update sequences set seq_tail_curr=#{seq_tail_curr},seq_tail_end=#{seq_tail_end} where seq_code=#{seq_code} and province_code=#{province_code} and area_code=#{area_code}
        </update>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.OrdModOperSplitRulePo" type="jdbc">
        <query name ="queryOrdModOperSplitRuleByOperCode">
            select id,province_code,area_code,source_oper_code,source_oper_name,source_system_code,target_oper_code,target_oper_name from ord_oper_split_rule where source_oper_code=#{filter.source_oper_code}
        </query>
        <query name="queryOrdModOperSplitRuleAll">
            select id,province_code,area_code,source_oper_code,source_oper_name,source_system_code,target_oper_code,target_oper_name from ord_oper_split_rule
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.OrdCancelModAppPo" type="jdbc">
        <query name="queryOrdCancelModByPo">
           select a.id, a.mod_code, a.province_code, a.area_code, a.used_system, a.used_service, a.oper_code, a.tache_id
      		from ord_cancel_mod_app a where a.tache_id=#{filter.tache_id}
      		<if test="filter.oper_code != null and filter.oper_code != ''">
                and a.oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.used_service != null and filter.used_service != ''">
                and a.used_service = '${filter.used_service}'
            </if>
            <if test="filter.used_system != null and filter.used_system != ''">
                and a.used_system = '${filter.used_system}'
            </if>
            <if test="filter.area_code != null and filter.area_code != ''">
                and a.area_code = '${filter.area_code}'
            </if>
            <if test="filter.province_code != null and filter.province_code != ''">
                and a.province_code = '${filter.province_code}'
            </if>
            <if test="filter.mod_code != null and filter.mod_code != ''">
                and a.mod_code = '${filter.mod_code}'
            </if>
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.OrdModStateRulePo" type="jdbc">
        <get>
            select id,province_code,area_code,oper_code_a,oper_name_a,state_code_a,state_name_a,oper_code_b,oper_name_b,state_code_b,state_name_b,rela_type,rela_desc from ord_state_rule where  oper_code_a =#{oper_code_a} and state_code_a =#{state_code_a}
        </get>
        <create>
           insert into ord_state_rule (id,province_code,area_code,oper_code_a,oper_name_a,state_code_a,state_name_a,oper_code_b,oper_name_b,state_code_b,state_name_b,rela_type,rela_desc) 
           values (#{id},#{province_code},#{area_code},#{oper_code_a},#{oper_name_a},#{state_code_a},#{state_name_a},#{oper_code_b},#{oper_name_b},#{state_code_b},#{state_name_b},#{rela_type},#{rela_desc}) 
        </create>
        <delete>
            delete from ord_state_rule where id=#{id}
        </delete>      
        <update>
            update ord_state_rule set id=#{id},province_code=#{province_code},area_code=#{area_code},oper_code_a=#{oper_code_a},oper_name_a=#{oper_name_a},state_code_a=#{state_code_a},state_name_a=#{state_name_a},oper_code_b=#{oper_code_b},oper_name_b=#{oper_name_b},state_code_b=#{state_code_b},state_name_b=#{state_name_b},rela_type=#{rela_type},rela_desc=#{rela_desc} where id=#{id}
        </update>
        <query name="queryOrdModStateRuleAll">
            select id,province_code,area_code,oper_code_a,oper_name_a,state_code_a,state_name_a,oper_code_b,oper_name_b,state_code_b,state_name_b,rela_type,rela_desc from ord_state_rule
        </query>
        <query name="queryOrdModStateRuleById">
            select id,province_code,area_code,oper_code_a,oper_name_a,state_code_a,state_name_a,oper_code_b,oper_name_b,state_code_b,state_name_b,rela_type,rela_desc from ord_state_rule where id=#{filter.id}
        </query>
         <query name="getModOrderStateRuleList">
            select id,province_code,area_code,oper_code_a,oper_name_a,state_code_a,state_name_a,oper_code_b,oper_name_b,state_code_b,state_name_b,rela_type,rela_desc from ord_state_rule where 1=1 
             <if test="filter.oper_code_a != null and filter.oper_code_a != ''">
                and oper_code_a = '${filter.oper_code_a}'
            </if>
            <if test="filter.oper_code_b != null and filter.oper_code_b != ''">
                and oper_code_b = '${filter.oper_code_b}'
            </if>
            <if test="filter.state_code_a != null and filter.state_code_a != ''">
                and state_code_a = '${filter.state_code_a}'
            </if>
             <if test="filter.state_code_b != null and filter.state_code_b != ''">
                and state_code_b = '${filter.state_code_b}'
            </if>
            
            limit ${filter.offset},${filter.limit}      
        </query>
        <query name="queryOrdModStateRuleCount">
            select id,province_code,area_code,oper_code_a,oper_name_a,state_code_a,state_name_a,oper_code_b,oper_name_b,state_code_b,state_name_b,rela_type,rela_desc from ord_state_rule where 1=1 
            <if test="filter.oper_code_a != null and filter.oper_code_a != ''">
                and oper_code_a = '${filter.oper_code_a}'
            </if>
            <if test="filter.oper_code_b != null and filter.oper_code_b != ''">
                and oper_code_b = '${filter.oper_code_b}'
            </if>
            <if test="filter.state_code_a != null and filter.state_code_a != ''">
                and state_code_a = '${filter.state_code_a}'
            </if>
             <if test="filter.state_code_b != null and filter.state_code_b != ''">
                and state_code_b = '${filter.state_code_b}'
            </if>                   
        </query>
    </service>
  
    <service data="com.tydic.unicom.uoc.base.uoccode.po.OrdModTacheRulePo" type="jdbc">
        <get>
            select id,province_code,area_code,oper_code_a,oper_name_a,tache_code_a,tache_name_a,oper_code_b,oper_name_b,tache_code_b,tache_name_b,rela_type,rela_desc from ord_tache_rule where  oper_code_a =#{oper_code_a} and tache_code_a =#{tache_code_a}
        </get> 
        <query name="queryOrdModTacheRuleList">
            select id,province_code,area_code,oper_code_a,oper_name_a,tache_code_a,tache_name_a,oper_code_b,oper_name_b,tache_code_b,tache_name_b,rela_type,rela_desc from ord_tache_rule where 1=1          
            <if test="filter.oper_code_a != null and filter.oper_code_a != ''">
                and oper_code_a = '${filter.oper_code_a}'
            </if>
            <if test="filter.oper_code_b != null and filter.oper_code_b != ''">
                and oper_code_b = '${filter.oper_code_b}'
            </if>
            <if test="filter.tache_code_a != null and filter.tache_code_a != ''">
                and  tache_code_a = '${filter.tache_code_a}'
            </if>
            <if test="filter.tache_code_b != null and filter.tache_code_b != ''">
                and tache_code_b ='${filter.tache_code_b}'
            </if>           
            limit ${filter.offset},${filter.limit}                      
        </query>  
        <query name="queryOrdModTacheRuleListConut">
            select id,province_code,area_code,oper_code_a,oper_name_a,tache_code_a,tache_name_a,oper_code_b,oper_name_b,tache_code_b,tache_name_b,rela_type,rela_desc from ord_tache_rule where 1=1                       
             <if test="filter.oper_code_a != null and filter.oper_code_a != ''">
                and oper_code_a = '${filter.oper_code_a}'
            </if>
            <if test="filter.oper_code_b != null and filter.oper_code_b != ''">
                and oper_code_b = '${filter.oper_code_b}'
            </if>
            <if test="filter.tache_code_a != null and filter.tache_code_a != ''">
                and  tache_code_a = '${filter.tache_code_a}'
            </if>
            <if test="filter.tache_code_b != null and filter.tache_code_b != ''">
                and tache_code_b ='${filter.tache_code_b}'
            </if>                    
        </query>
        
        <query name="queryOrdModTacheRuleAll">
            select id,province_code,area_code,oper_code_a,oper_name_a,tache_code_a,tache_name_a,oper_code_b,oper_name_b,tache_code_b,tache_name_b,rela_type,rela_desc from ord_tache_rule
        </query>
        <create>
            insert into ord_tache_rule (id,province_code,area_code,oper_code_a,oper_name_a,tache_code_a,tache_name_a,oper_code_b,oper_name_b,tache_code_b,tache_name_b,rela_type,rela_desc)
            values (#{id},#{province_code},#{area_code},#{oper_code_a},#{oper_name_a},#{tache_code_a},#{tache_name_a},#{oper_code_b},#{oper_name_b},#{tache_code_b},#{tache_name_b},#{rela_type},#{rela_desc})
        </create>
        <update>
            update ord_tache_rule set id=#{id},province_code=#{province_code},area_code=#{area_code},oper_code_a=#{oper_code_a},oper_name_a=#{oper_name_a},tache_code_a=#{tache_code_a},tache_name_a=#{tache_name_a},oper_code_b=#{oper_code_b},oper_name_b=#{oper_name_b},tache_code_b=#{tache_code_b},tache_name_b=#{tache_name_b},rela_type=#{rela_type},rela_desc=#{rela_desc}  where id=#{id}
        </update>
        <delete>
            delete from ord_tache_rule where id=#{id}
        </delete>        
    </service>
   
    <service data="com.tydic.unicom.uoc.base.uoccode.po.OrdModAttrDefinePo" type="jdbc">
        <query name="queryOrdModAttrDefineAll">
            select id,attr_code,mod_code,attr_name,attr_type,attr_desc,is_allow_null,is_default_value,get_default_type,default_value from ord_attr_define
        </query>
        <query name="queryOrdModAttrDefineByModCode">
            select id,attr_code,mod_code,attr_name,attr_type,attr_desc,is_allow_null,is_default_value,get_default_type,default_value from ord_attr_define where  mod_code =#{mod_code}
        </query>
         <create>
           insert into ord_attr_define (id,attr_code,mod_code,attr_name,attr_type,attr_desc,is_allow_null,is_default_value,get_default_type,default_value) 
           values (#{id},#{attr_code},#{mod_code},#{attr_name},#{attr_type},#{attr_desc},#{is_allow_null},#{is_default_value},#{get_default_type},#{default_value}) 
        </create>
        <delete>
            delete from ord_attr_define where id=#{id}
        </delete>      
        <update>
            update ord_attr_define set id=#{id},attr_code=#{attr_code},mod_code=#{mod_code},attr_name=#{attr_name},attr_type=#{attr_type},attr_desc=#{attr_desc},is_allow_null=#{is_allow_null},is_default_value=#{is_default_value},get_default_type=#{get_default_type},default_value=#{default_value}
             where id=#{id}
        </update>
        <query name= "queryOrdModAttrDefineList">
           	select id,attr_code,mod_code,attr_name,attr_type,attr_desc,is_allow_null,is_default_value,get_default_type,default_value from ord_attr_define where 1=1 
             		           				
        	<if test="filter.mod_code != null and filter.mod_code != ''">
                	and mod_code =#{filter.mod_code} 
        	</if>
        	<if test="filter.attr_code != null and filter.attr_code != ''">
                and attr_code =#{filter.attr_code} 
        	</if>
        	<if test="filter.attr_name != null and filter.attr_name != ''">
                and attr_name  like '${filter.attr_name}%' 
        	</if>
        	limit ${filter.offset},${filter.limit}
        </query>
        <query name= "queryOrdModAttrDefineListCount">
           	select id,attr_code,mod_code,attr_name,attr_type,attr_desc,is_allow_null,is_default_value,get_default_type,default_value from ord_attr_define where 1=1 		
       		<if test="filter.mod_code != null and filter.mod_code != ''">
                	and mod_code =#{filter.mod_code} 
        	</if>
       		<if test="filter.attr_code != null and filter.attr_code != ''">
                and attr_code =#{filter.attr_code} 
        	</if>
        	<if test="filter.attr_name != null and filter.attr_name != ''">
                and attr_name  like '${filter.attr_name}%' 
        	</if>
        </query> 
         <query name= "queryAllOrdModAttrDefineList">
           	select id,attr_code,mod_code,attr_name,attr_type,attr_desc,is_allow_null,is_default_value,get_default_type,default_value from ord_attr_define where 1=1 
           	 <if test="filter.is_default_value != null and filter.is_default_value != ''">
                and is_default_value = '${filter.is_default_value}'
            </if> 		
        </query> 
    </service>
  
     <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcModTachePo" type="jdbc">
        <query name="queryProcModTacheByTacheCode">
            select tache_code,tache_name,tache_desc,used_time_len,tache_type,is_need_check,oper_type,province_code,area_code from proc_tache where tache_code=#{tache_code} 
        </query>
        <query name="queryProcModTacheAll">
            select tache_code,tache_name,tache_desc,used_time_len,tache_type,is_need_check,oper_type,province_code,area_code from proc_tache
        </query>
         <query name= "queryProcModTacheList">
            select tache_code,tache_name,tache_desc,used_time_len,tache_type,is_need_check,oper_type,province_code,area_code from proc_tache where 1=1 
            <if test="filter.province_code != null and filter.province_code != ''">
          			and province_code=#{filter.province_code}
         	</if>
         	<if test="filter.area_code != null and filter.area_code != ''">
          			 and area_code=#{filter.area_code}
         	</if>
         	<if test="filter.tache_code != null and filter.tache_code != ''">
          			 and tache_code=#{filter.tache_code} 
         	</if>           
            limit ${filter.offset},${filter.limit}	
        </query>
        <query name= "queryProcModTacheListCount">
           select tache_code,tache_name,tache_desc,used_time_len,tache_type,is_need_check,oper_type,province_code,area_code from proc_tache where 1=1 
             <if test="filter.province_code != null and filter.province_code != ''">
          			and province_code=#{filter.province_code}
         	</if>
         	<if test="filter.area_code != null and filter.area_code != ''">
          			 and area_code=#{filter.area_code}
         	</if>
         	<if test="filter.tache_code != null and filter.tache_code != ''">
          			 and tache_code=#{filter.tache_code} 
         	</if>
        </query>
        <create>
           insert into proc_tache (tache_code,tache_name,tache_desc,used_time_len,tache_type,is_need_check,oper_type,province_code,area_code) 
           values (#{tache_code},#{tache_name},#{tache_desc},#{used_time_len},#{tache_type},#{is_need_check},#{oper_type},#{province_code},#{area_code}) 
        </create>
        <delete>
            delete from proc_tache where tache_code=#{tache_code}
        </delete>      
        <update>
            update proc_tache set tache_code=#{tache_code},tache_name=#{tache_name},tache_desc=#{tache_desc},used_time_len=#{used_time_len},tache_type=#{tache_type},is_need_check=#{is_need_check},oper_type=#{oper_type},province_code=#{province_code},area_code=#{area_code}
             where tache_code=#{tache_code}
        </update>
    </service>
  
    <service data="com.tydic.unicom.uoc.base.uocinst.po.ProcInstTaskInstPo" type="jdbc">
        <create>
            insert into task_inst (task_id,task_code,task_name,tache_code,province_code,area_code,part_month,order_no,order_type,proc_inst_id,oper_code,task_state,task_property,create_time,finish_time,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,limit_time,prod_code) 
            values (#{task_id},#{task_code},#{task_name},#{tache_code},#{province_code},#{area_code},#{part_month},#{order_no},#{order_type},#{proc_inst_id},#{oper_code},#{task_state},#{task_property},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name},all_to_date(#{limit_time},'yyyy-mm-dd hh:mm:ss'),#{prod_code})
        </create>
        <query name="queryTaskInstByOrderNo1">
            select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst where order_no = '${filter.order_no}' and area_code='${filter.area_code}' and part_month='${filter.part_month}'
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
            <if test="filter.task_state != null and filter.task_state != ''">
                and task_state = '${filter.task_state}'
            </if>
             <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
        </query>
        <query name="queryTaskInstForCancleOrder">
            select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,
            task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss') create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss') finish_time ,
            accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss') limit_time ,
            prod_code from task_inst where tache_code=#{filter.tache_code} and task_state=#{filter.task_state} and sysdate-create_time&gt;25
        </query>
        <query name="queryCountNotOverdue24Hours">
            select task_id from task_inst where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and limit_time&gt;all_to_date('${filter.lowDateTime}','yyyy-mm-dd hh:mm:ss') and limit_time&lt;all_to_date('${filter.highDateTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
        </query>
        <query name="queryCountOverdueLessOneHour">
            select task_id from task_inst where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '0'.toString()">
                AND task_state &lt;&gt;102
                AND sysdate - limit_time &lt; 1/24
                AND sysdate - limit_time &gt;= 0/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time &lt; 1/24
                AND finish_time - limit_time &gt;= 0/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt;102 AND sysdate - limit_time &lt; 1/24 AND sysdate - limit_time &gt;= 0/24) OR ( task_state = 102  AND finish_time - limit_time &lt; 1/24 AND finish_time - limit_time &gt;= 0/24))
            </if>
        </query>
        
        <query name="queryCountOverdueOneToTwoHour">
            select task_id from task_inst where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '0'.toString()">
                AND task_state &lt;&gt; 102
                AND sysdate - limit_time &lt; 2/24
                AND sysdate - limit_time&gt;=1/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time &lt; 2/24
                AND finish_time - limit_time&gt;=1/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt; 102 AND sysdate - limit_time &lt; 2/24 AND sysdate - limit_time&gt;=1/24) OR ( task_state = 102  AND finish_time - limit_time &lt; 2/24 AND finish_time - limit_time&gt;=1/24))
            </if>
        </query>
        
        <query name="queryCountOverdueTwoToTwelveHour">
            select task_id from task_inst where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '0'.toString()">
                AND task_state &lt;&gt; 102
                AND sysdate - limit_time &lt; 12/24
                AND sysdate - limit_time&gt;=2/24
            </if>
             <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time &lt;
                12/24 AND finish_time - limit_time&gt;=2/24
            </if>
             <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt; 102 AND sysdate - limit_time &lt; 12/24 AND sysdate - limit_time&gt;=2/24) OR ( task_state = 102  AND finish_time - limit_time &lt; 12/24 AND finish_time - limit_time&gt;=2/24))
            </if>
        </query>
        
        <query name="queryCountOverdueTwelveToTwentyFourHour">
            select task_id from task_inst where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '0'.toString()">
                AND task_state &lt;&gt; 102
                AND sysdate - limit_time &lt; 24/24
                AND sysdate - limit_time&gt;=12/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time &lt; 24/24
                AND finish_time - limit_time&gt;=12/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt; 102 AND sysdate - limit_time &lt; 24/24 AND sysdate - limit_time&gt;=12/24) OR ( task_state = 102  AND finish_time - limit_time &lt; 24/24 AND finish_time - limit_time&gt;=12/24))
            </if>
        </query>
        
        <query name="queryCountOverdueMoreTwentyFourHour">
            select task_id from task_inst where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '0'.toString()">
                AND task_state &lt;&gt; 102
                AND sysdate - limit_time&gt;=24/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time&gt;=24/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt; 102 AND sysdate - limit_time&gt;=24/24) OR ( task_state = 102 AND finish_time - limit_time&gt;=24/24))
            </if>
        </query>
        
        <query name="queryCountNotOverdue">
            select task_id from task_inst where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '0'.toString()">
                AND task_state &lt;&gt; 102
                AND sysdate - limit_time&lt;0/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time&lt;0/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt; 102 AND sysdate - limit_time&lt;0/24) OR ( task_state = 102 AND finish_time - limit_time&lt;0/24))
            </if>
        </query>
        
        <query name="queryCountTaskAll">
            select task_id from task_inst where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '0'.toString()">
                and task_state &lt;&gt; 102
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                and task_state = 102
            </if>
        </query>
        
        <query name="queryProcInstTaskInstByTaskId">
            select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst where 1=1
            <if test="filter.task_id != null and filter.task_id != ''">
                and task_id = '${filter.task_id}'
            </if> 
            <if test="filter.task_code != null and filter.task_code != ''">
                and task_code = '${filter.task_code}'
            </if>            
           <!--  <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
            <if test="filter.task_property != null and filter.task_property != ''">
                and task_property = '${filter.task_property}'
            </if> -->
            <if test="filter.proc_inst_id != null and filter.proc_inst_id != ''">
                and proc_inst_id = '${filter.proc_inst_id}'
            </if>
        </query>
        <query name="queryProcInstTaskInstByOrderNoAndTaskState">
            select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst where order_no = '${filter.order_no}' and task_state = '${filter.task_state}' and area_code='${filter.area_code}' and part_month='${filter.part_month}'
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
        </query>
        <query name="queryProcInstTaskInstByTaskState">
            select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst where order_no = '${filter.order_no}' and (task_state ='100' or task_state='101') and area_code='${filter.area_code}' and part_month='${filter.part_month}'
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
        </query>
        <query name="queryProcInstTaskInstByTacheCodeAndProcInstId">
            select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst where 1=1 and area_code='${filter.area_code}' and part_month='${filter.part_month}'
           <if test="filter.proc_inst_id != null and filter.proc_inst_id != ''">
                and proc_inst_id = '${filter.proc_inst_id}'
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
        </query>
        <query name="queryProcInstTaskInstByOrderNo">
            select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst where order_no = '${filter.order_no}' and order_type='${filter.order_type}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and task_state in('100','101')
        </query>
        <query name="querytaskInstByOrderNoAndTacheCode">
            select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst where order_no = '${filter.order_no}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and task_state in('100','101')
             <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
        </query>
        <query name="queryTaskInstByTask">
            select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst where order_no = '${filter.order_no}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and task_state ='102' order by create_time desc
        </query>
        
         <query name="queryProcInstTaskInst">
           select a.task_id ,a.task_code ,a.task_name ,a.tache_code ,a.province_code ,a.area_code ,a.part_month ,a.order_no ,a.order_type ,a.proc_inst_id ,a.task_state ,a.task_property ,all_to_str(a.create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(a.finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,a.accept_oper_no ,a.accept_oper_name ,a.accept_depart_no ,a.accept_depart_name ,a.oper_code ,all_to_str(a.limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,a.prod_code from UOC_INST.task_inst a, UOC_INST.task_assign_depart b, UOC_INST.task_assign_oper c where 1=1 		  
		   and (a.order_no=b.order_no or a.order_no=c.order_no)
		   and a.tache_code in (#{filter.tache_code}) and a.create_time&gt;=all_to_date('${filter.accept_time_start}','yyyy-mm-dd hh:mm:ss') and a.create_time&lt;=all_to_date('${filter.accept_time_end}','yyyy-mm-dd hh:mm:ss')
		   and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}
           and b.area_code=#{filter.area_code} and b.part_month=#{filter.part_month}
           and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month}
           <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.accept_oper_name != null and filter.accept_oper_name != ''">
                and accept_oper_name like  '%${filter.accept_oper_name}%'
            </if>            
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                and accept_depart_no = '${filter.accept_depart_no}'
            </if>
            <if test="filter.accept_depart_name != null and filter.accept_depart_name != ''">
                and accept_depart_name like '%${filter.accept_depart_name}%'
            </if> 
            <if test="filter.order_no != null and filter.order_no != ''">
                and order_no = '${filter.order_no}'
            </if>
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
        </query>
        <query name="queryProcInstTaskInstByTacheCode">
  		     select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst where 1=1 and (task_state ='100' or task_state='101') and area_code='${filter.area_code}' and part_month='${filter.part_month}'
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
            <if test="filter.province_code != null and filter.province_code != ''">
                and province_code = '${filter.province_code}'
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
  		</query>
  		<query name="queryDepartTaskInstByCode">
  			select a.task_id ,a.task_code ,a.task_name ,a.tache_code ,a.province_code ,a.area_code ,a.part_month ,a.order_no ,a.order_type ,a.proc_inst_id ,a.task_state ,a.task_property ,all_to_str(a.create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(a.finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,a.accept_oper_no ,a.accept_oper_name ,a.accept_depart_no ,a.accept_depart_name ,a.oper_code ,all_to_str(a.limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,a.prod_code from task_inst a where 1=1 and (a.task_state ='100' or a.task_state='101')
  			<if test="filter.area_code != null and filter.area_code != ''">
                and a.area_code = '${filter.area_code}'
            </if>
  			<if test="filter.tache_code != null and filter.tache_code != ''">
                and a.tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and a.prod_code = '${filter.prod_code}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and a.oper_code = '${filter.oper_code}'
            </if>
            and a.accept_oper_no is null order by a.create_time asc
  		</query>
  		<query name="queryProcInstTaskInstListCountByServOrderNo">
  		     select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst a where 1=1 and (a.task_state ='100' or a.task_state='101') and a.task_property in('100','101','102')  and a.area_code='${filter.area_code}' and a.part_month='${filter.part_month}'  and a.order_type='101' and tache_code in(${filter.tache_code})
            <if test="filter.tache_code1 != null and filter.tache_code1 != ''">
                and a.tache_code = '${filter.tache_code1}'
            </if>
            <if test="filter.order_no != null and filter.order_no != ''">
                and a.order_no = '${filter.order_no}'
            </if>
            <if test="filter.person_flag != null and filter.person_flag != ''">
                and ((a.accept_oper_no is null and #{filter.person_flag} ='1')
                or (a.accept_oper_no is not  null  and #{filter.person_flag} ='0'))
            </if>
            <if test="filter.cust_name != '' or filter.cert_no != ''">
                and EXISTS (select d.serv_order_no from info_serv_person d where a.order_no=d.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month}
                <if test="filter.cust_name != null and filter.cust_name != ''">
                    and d.cust_name like '%${filter.cust_name}%'
                </if>  
                <if test="filter.cert_no != null and filter.cert_no != ''">
                    and d.cert_no ='${filter.cert_no}'                
                 </if>
                )              
            </if>
            <if test="filter.accept_time_start != ''  or filter.accept_time_end != ''  or filter.acc_nbr != ''">
                and EXISTS (select e.serv_order_no from info_service_order e where a.order_no=e.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month}  and e.create_time&gt;=all_to_date('${filter.accept_time_start}','yyyy-mm-dd hh:mm:ss') and e.create_time&lt;=all_to_date('${filter.accept_time_end}','yyyy-mm-dd hh:mm:ss')      
                 <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                    and e.acc_nbr ='${filter.acc_nbr}'                      
                 </if>
                 <if test="filter.deal_system_no != null and filter.deal_system_no != ''">
                	and EXISTS (select f.sale_order_no from info_sale_order f where f.sale_order_no=e.sale_order_no and f.accept_system='${filter.deal_system_no}')
	             </if>
                )              
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and a.prod_code in (${filter.prod_code})
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and a.oper_code='${filter.oper_code}' 
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no ='${filter.accept_oper_no}'    
            </if>                  
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                and a.accept_depart_no ='${filter.accept_depart_no}'    
            </if>
             <if test="filter.late_flag != null and filter.late_flag != ''">
                and (( a.limit_time&lt;=sysdate and #{filter.late_flag} ='1')
                or ( a.limit_time&gt;=sysdate and #{filter.late_flag} ='0'))
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and EXISTS (select distinct m.serv_order_no from info_service_order m,info_sale_order n where a.order_no=m.serv_order_no  and m.sale_order_no=m.sale_order_no and m.area_code=#{filter.area_code} and m.part_month=#{filter.part_month} and n.area_code=#{filter.area_code} and n.part_month=#{filter.part_month} and n.accept_no=#{filter.accept_no})
  		     </if>
  		     <if test="filter.sim_id != null and filter.sim_id != ''">
                and EXISTS (select sc.serv_order_no from info_serv_sim_card sc where sc.serv_order_no=a.order_no and sc.area_code=#{filter.area_code} and sc.part_month=#{filter.part_month} and sc.sim_id=#{filter.sim_id})
            </if>
  		</query>
  		
        <query name="queryProcInstTaskInstListByServOrderNo">
  		     select distinct task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst a where 1=1 and (a.task_state ='100' or a.task_state='101') and a.task_property in('100','101','102')  and a.area_code='${filter.area_code}' and a.part_month='${filter.part_month}'  and a.order_type='101' and tache_code in(${filter.tache_code})
            <if test="filter.tache_code1 != null and filter.tache_code1 != ''">
                and a.tache_code = '${filter.tache_code1}'
            </if>
            <if test="filter.order_no != null and filter.order_no != ''">
                and a.order_no = '${filter.order_no}'
            </if>
            <if test="filter.person_flag != null and filter.person_flag != ''">
                and ((a.accept_oper_no is null and #{filter.person_flag} ='1')
                or (a.accept_oper_no is not  null  and #{filter.person_flag} ='0'))
            </if>
            <if test="filter.cust_name != '' or filter.cert_no != ''">
                and EXISTS (select d.serv_order_no from info_serv_person d where a.order_no=d.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month}
                <if test="filter.cust_name != null and filter.cust_name != ''">
                    and d.cust_name like '%${filter.cust_name}%'
                </if>  
                <if test="filter.cert_no != null and filter.cert_no != ''">
                    and d.cert_no ='${filter.cert_no}'                
                </if>
                )              
            </if>
            
            <if test="filter.accept_time_start != ''  or filter.accept_time_end != ''  or filter.acc_nbr != ''">
                and EXISTS (select e.serv_order_no from info_service_order e where a.order_no=e.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.create_time&gt;=all_to_date('${filter.accept_time_start}','yyyy-mm-dd hh:mm:ss') and e.create_time&lt;=all_to_date('${filter.accept_time_end}','yyyy-mm-dd hh:mm:ss')
                 <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                    and e.acc_nbr ='${filter.acc_nbr}'                      
                 </if>
                 <if test="filter.deal_system_no != null and filter.deal_system_no != ''">
                	and EXISTS (select f.sale_order_no from info_sale_order f where f.sale_order_no=e.sale_order_no and f.accept_system='${filter.deal_system_no}')
	             </if>
                )              
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                 and a.prod_code in (${filter.prod_code})
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and a.oper_code='${filter.oper_code}' 
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no ='${filter.accept_oper_no}'    
            </if>                  
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                and a.accept_depart_no ='${filter.accept_depart_no}'    
            </if>
             <if test="filter.late_flag != null and filter.late_flag != ''">
                and (( a.limit_time&lt;=sysdate and #{filter.late_flag} ='1')
                or ( a.limit_time&gt;=sysdate and #{filter.late_flag} ='0'))
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and EXISTS (select distinct m.serv_order_no from info_service_order m,info_sale_order n where a.order_no=m.serv_order_no  and m.sale_order_no=m.sale_order_no and m.area_code=#{filter.area_code} and m.part_month=#{filter.part_month} and n.area_code=#{filter.area_code} and n.part_month=#{filter.part_month} and n.accept_no=#{filter.accept_no})
  		     </if>
  		      <if test="filter.sim_id != null and filter.sim_id != ''">
                and EXISTS (select sc.serv_order_no from info_serv_sim_card sc where sc.serv_order_no=a.order_no and sc.area_code=#{filter.area_code} and sc.part_month=#{filter.part_month} and sc.sim_id=#{filter.sim_id})
            </if>
  		     <if test="filter.sort_type_asc != null and filter.sort_type_asc != ''">
                order by a.create_time asc
            </if>
             <if test="filter.sort_type_desc != null and filter.sort_type_desc != ''">
                order by a.create_time desc
            </if>
           
  		     limit ${filter.offset},${filter.limit}      
  		</query>
  		
        <query name="queryProcInstTaskInstListBySaleOrderNo">
  		     select distinct task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst a where 1=1 and (a.task_state ='100' or a.task_state='101') and a.task_property in('100','101','102')  and a.area_code='${filter.area_code}' and a.part_month='${filter.part_month}'  and a.order_type='100' and tache_code in(${filter.tache_code})
            <if test="filter.tache_code1 != null and filter.tache_code1 != ''">
                and a.tache_code = '${filter.tache_code1}'
            </if>
            <if test="filter.order_no != null and filter.order_no != ''">
                and a.order_no = '${filter.order_no}'
            </if>
            <if test="filter.person_flag != null and filter.person_flag != ''">
                and ((a.accept_oper_no is null and #{filter.person_flag} ='1')
                or (a.accept_oper_no is not  null  and #{filter.person_flag} ='0'))
            </if>
            <if test="filter.cust_name != '' or filter.cert_no != ''">
                and EXISTS (select d.sale_order_no from info_sale_person d where a.order_no=d.sale_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month}
                <if test="filter.cust_name != null and filter.cust_name != ''">
                    and d.cust_name like '%${filter.cust_name}%'
                </if>  
                <if test="filter.cert_no != null and filter.cert_no != ''">
                    and d.cert_no ='${filter.cert_no}'                
                </if>
                )              
            </if>
            <if test="filter.accept_time_start != ''  or filter.accept_time_end != '' or filter.accept_no != ''">
                and EXISTS (select e.sale_order_no from info_sale_order e where a.order_no=e.sale_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.accept_time&gt;=all_to_date('${filter.accept_time_start}','yyyy-mm-dd hh:mm:ss') and e.accept_time&lt;=all_to_date('${filter.accept_time_end}','yyyy-mm-dd hh:mm:ss')            
                  <if test="filter.accept_no != null and filter.accept_no != ''">
                    and e.accept_no ='${filter.accept_no}'                      
                  </if>
                  <if test="filter.deal_system_no != null and filter.deal_system_no != ''">
                    and e.accept_system ='${filter.deal_system_no}'                      
                  </if>
                )              
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                 and a.prod_code in (${filter.prod_code})
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and a.oper_code='${filter.oper_code}' 
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no ='${filter.accept_oper_no}'    
            </if>                  
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                and a.accept_depart_no ='${filter.accept_depart_no}'    
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and EXISTS (select m.sale_order_no from info_sale_serv_map m where a.order_no=m.sale_order_no and m.area_code=#{filter.area_code} and m.part_month=#{filter.part_month} and m.acc_nbr=#{filter.acc_nbr})  or EXISTS (select n.sale_order_no from info_sale_ofr_map n where a.order_no=n.sale_order_no and n.area_code=#{filter.area_code} and n.part_month=#{filter.part_month} and n.acc_nbr=#{filter.acc_nbr})
            </if>
             <if test="filter.late_flag != null and filter.late_flag != ''">
                and (( a.limit_time&lt;=sysdate  and #{filter.late_flag} ='1')
                or ( a.limit_time&gt;=sysdate  and #{filter.late_flag} ='0'))
            </if>
            <if test="filter.sim_id != null and filter.sim_id != ''">
                and EXISTS (select sc.sale_order_no from info_serv_sim_card sc where sc.sale_order_no=a.order_no and sc.area_code=#{filter.area_code} and sc.part_month=#{filter.part_month} and sc.sim_id=#{filter.sim_id})
            </if>
            <if test="filter.sort_type_asc != null and filter.sort_type_asc != ''">
                order by a.create_time asc
            </if>
             <if test="filter.sort_type_desc != null and filter.sort_type_desc != ''">
                order by a.create_time desc
            </if>
            
  		     limit ${filter.offset},${filter.limit}      
  		</query>
  		<query name="queryProcInstTaskInstListCountBySaleOrderNo">
  		     select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst a where 1=1 and (a.task_state ='100' or a.task_state='101') and a.task_property in('100','101','102')  and a.area_code='${filter.area_code}' and a.part_month='${filter.part_month}'  and a.order_type='100' and tache_code in(${filter.tache_code})
            <if test="filter.tache_code1 != null and filter.tache_code1 != ''">
                and a.tache_code = '${filter.tache_code1}'
            </if>
            <if test="filter.order_no != null and filter.order_no != ''">
                and a.order_no = '${filter.order_no}'
            </if>
            <if test="filter.person_flag != null and filter.person_flag != ''">
               and ((a.accept_oper_no is null and #{filter.person_flag} ='1')
                or (a.accept_oper_no is not  null  and #{filter.person_flag} ='0'))
            </if>
            <if test="filter.cust_name != '' or filter.cert_no != ''">
                and EXISTS (select d.sale_order_no from info_sale_person d where a.order_no=d.sale_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month}
                <if test="filter.cust_name != null and filter.cust_name != ''">
                    and d.cust_name like '%${filter.cust_name}%'
                </if>  
                <if test="filter.cert_no != null and filter.cert_no != ''">
                    and d.cert_no ='${filter.cert_no}'                
                </if>
                )              
            </if>
            <if test="filter.accept_time_start != ''  or filter.accept_time_end != ''  or filter.accept_no != ''">
                and EXISTS (select e.sale_order_no from info_sale_order e where a.order_no=e.sale_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.accept_time&gt;=all_to_date('${filter.accept_time_start}','yyyy-mm-dd hh:mm:ss') and e.accept_time&lt;=all_to_date('${filter.accept_time_end}','yyyy-mm-dd hh:mm:ss')                 
                  <if test="filter.accept_no != null and filter.accept_no != ''">
                    and e.accept_no ='${filter.accept_no}'                      
                  </if>
                  <if test="filter.deal_system_no != null and filter.deal_system_no != ''">
                    and e.accept_system ='${filter.deal_system_no}'                      
                  </if>
                )              
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                 and a.prod_code in (${filter.prod_code})
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and a.oper_code='${filter.oper_code}' 
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no ='${filter.accept_oper_no}'    
            </if>                  
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                and a.accept_depart_no ='${filter.accept_depart_no}'    
             </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and EXISTS (select m.sale_order_no from info_sale_serv_map m where a.order_no=m.sale_order_no and m.area_code=#{filter.area_code} and m.part_month=#{filter.part_month} and m.acc_nbr=#{filter.acc_nbr})  or EXISTS (select n.sale_order_no from info_sale_ofr_map n where a.order_no=n.sale_order_no and n.area_code=#{filter.area_code} and n.part_month=#{filter.part_month} and n.acc_nbr=#{filter.acc_nbr})
            </if>
             <if test="filter.late_flag != null and filter.late_flag != ''">
                and (( a.limit_time&lt;=sysdate  and #{filter.late_flag} ='1')
                or ( a.limit_time&gt;=sysdate  and #{filter.late_flag} ='0'))
            </if>
            <if test="filter.sim_id != null and filter.sim_id != ''">
                and EXISTS (select sc.sale_order_no from info_serv_sim_card sc where sc.sale_order_no=a.order_no and sc.area_code=#{filter.area_code} and sc.part_month=#{filter.part_month} and sc.sim_id=#{filter.sim_id})
            </if>
  		</query>
  		<query name="queryAllTaskInstGroupByTacheCode">
            select tache_code,task_name,count(0)tache_count from task_inst where 1=1 and create_time&lt;all_to_date('${filter.end_time}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.start_time}','yyyy-mm-dd hh:mm:ss')  and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' 
            <if test="filter.oper_no != null and filter.oper_no != ''">
                and accept_oper_no = '${filter.oper_no}'
            </if> 
            <if test="filter.depart_no != null and filter.depart_no != ''">
                and accept_depart_no = '${filter.depart_no}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '0'.toString()">
                AND task_state &lt;&gt; 102
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
            </if>
            group by tache_code,task_name
        </query>
        <query name="queryCountAllTaskInstGroupByTacheCode">
            select task_id from task_inst where 1=1 and create_time&lt;all_to_date('${filter.end_time}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.start_time}','yyyy-mm-dd hh:mm:ss')  and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' 
            <if test="filter.oper_no != null and filter.oper_no != ''">
                and accept_oper_no = '${filter.oper_no}'
            </if> 
            <if test="filter.depart_no != null and filter.depart_no != ''">
                and accept_depart_no = '${filter.depart_no}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '0'.toString()">
                AND task_state &lt;&gt; 102
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
            </if>
        </query>
        <delete name="deleteProcInstTaskInstByOrderNo">
            delete from task_inst where order_no = ${filter.order_no} and order_type=${filter.order_type} and area_code=${filter.area_code} and part_month=${filter.part_month}
        </delete>
        <update name="updateTaskInstByPo">
             update task_inst set task_id=#{filter.task_id},task_code=#{filter.task_code},task_name=#{filter.task_name},tache_code=#{filter.tache_code},province_code=#{filter.province_code},area_code=#{filter.area_code},part_month=#{filter.part_month},order_no=#{filter.order_no},order_type=#{filter.order_type},proc_inst_id=#{filter.proc_inst_id},
             task_state=#{filter.task_state},oper_code=#{filter.oper_code},task_property=#{filter.task_property},create_time=all_to_date(#{filter.create_time},'yyyy-mm-dd hh:mm:ss'),finish_time=all_to_date(#{filter.finish_time},'yyyy-mm-dd hh:mm:ss'),accept_oper_no=#{filter.accept_oper_no},accept_oper_name=#{filter.accept_oper_name},accept_depart_no=#{filter.accept_depart_no},accept_depart_name=#{filter.accept_depart_name},limit_time=all_to_date(#{filter.limit_time},'yyyy-mm-dd hh:mm:ss'),prod_code=#{filter.prod_code}
             where order_no=#{filter.order_no} and order_type=#{filter.order_type} and area_code=#{filter.area_code} and part_month=#{filter.part_month}  and tache_code=#{filter.tache_code}
             <if test="filter.task_id != null and filter.task_id != ''">
                and task_id = #{filter.task_id}
             </if>
        </update>        
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcTaskAssignRulePo" type="jdbc">
    	<query name="queryByProcInstTaskInst">
    		select id,province_code,area_code,target_depart_no,target_oper_no,tache_code,oper_code,accept_oper_no,accept_depart_no,ext_cond1,ext_cond2,ext_cond3 from proc_task_assign_rule where 1=1 and province_code=#{filter.province_code} and area_code=#{filter.area_code}
    		<if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code=#{filter.tache_code}
            </if>
    		<if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                and accept_depart_no = '${filter.accept_depart_no}'
            </if>
            <if test="filter.target_oper_no != null and filter.target_oper_no != ''">
                and target_oper_no = '${filter.target_oper_no}'
            </if>
    		<if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.ext_cond1 != null and filter.ext_cond1 != ''">
                and ext_cond1 = '${filter.ext_cond1}'
            </if>
            <if test="filter.ext_cond2 != null and filter.ext_cond2 != ''">
                and ext_cond2 = '${filter.ext_cond2}'
            </if>
            <if test="filter.ext_cond3 != null and filter.ext_cond3 != ''">
                and ext_cond3 = '${filter.ext_cond3}'
            </if>
    	</query>
    	<query name="queryProcTaskAssignRuleByPage">
    	    select distinct id,province_code,area_code,target_depart_no,target_oper_no,tache_code,oper_code,accept_oper_no,accept_depart_no,ext_cond1,ext_cond2,ext_cond3 from proc_task_assign_rule where 1=1
    	    <if test="filter.province_code != null and filter.province_code != ''">
                and province_code = '${filter.province_code}'
            </if>
            <if test="filter.area_code != null and filter.area_code != ''">
                and area_code = '${filter.area_code}'
            </if>
            <if test="filter.target_depart_no != null and filter.target_depart_no != ''">
                and target_depart_no = '${filter.target_depart_no}'
            </if>
            <if test="filter.target_oper_no != null and filter.target_oper_no != ''">
                and target_oper_no = '${filter.target_oper_no}'
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
    	    <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                and accept_depart_no = '${filter.accept_depart_no}'
            </if>
    		<if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.ext_cond1 != null and filter.ext_cond1 != ''">
                and ext_cond1 = '${filter.ext_cond1}'
            </if>
            <if test="filter.ext_cond2 != null and filter.ext_cond2 != ''">
                and ext_cond2 = '${filter.ext_cond2}'
            </if>
            <if test="filter.ext_cond3 != null and filter.ext_cond3 != ''">
                and ext_cond3 = '${filter.ext_cond3}'
            </if>
            limit ${filter.offset},${filter.limit}
    	</query>
    	<query name="queryProcTaskAssignRuleById">
    	    select id,province_code,area_code,target_depart_no,target_oper_no,tache_code,oper_code,accept_oper_no,accept_depart_no,ext_cond1,ext_cond2,ext_cond3 from proc_task_assign_rule where id=#{filter.id}
    	</query>
    	<query name="queryProcTaskAssignRuleCount">
    	    select id,province_code,area_code,target_depart_no,target_oper_no,tache_code,oper_code,accept_oper_no,accept_depart_no,ext_cond1,ext_cond2,ext_cond3 from proc_task_assign_rule where 1=1
    	    <if test="filter.province_code != null and filter.province_code != ''">
                and province_code = '${filter.province_code}'
            </if>
            <if test="filter.area_code != null and filter.area_code != ''">
                and area_code = '${filter.area_code}'
            </if>
            <if test="filter.target_depart_no != null and filter.target_depart_no != ''">
                and target_depart_no = '${filter.target_depart_no}'
            </if>
            <if test="filter.target_oper_no != null and filter.target_oper_no != ''">
                and target_oper_no = '${filter.target_oper_no}'
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
    	    <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                and accept_depart_no = '${filter.accept_depart_no}'
            </if>
    		<if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.ext_cond1 != null and filter.ext_cond1 != ''">
                and ext_cond1 = '${filter.ext_cond1}'
            </if>
            <if test="filter.ext_cond2 != null and filter.ext_cond2 != ''">
                and ext_cond2 = '${filter.ext_cond2}'
            </if>
            <if test="filter.ext_cond3 != null and filter.ext_cond3 != ''">
                and ext_cond3 = '${filter.ext_cond3}'
            </if>
    	</query>
    	<create>
    	    insert into proc_task_assign_rule(id,province_code,area_code,target_depart_no,target_oper_no,tache_code,oper_code,accept_oper_no,accept_depart_no,ext_cond1,ext_cond2,ext_cond3)
    	    values (#{id},#{province_code},#{area_code},#{target_depart_no},#{target_oper_no},#{tache_code},#{oper_code},#{accept_oper_no},#{accept_depart_no},#{ext_cond1},#{ext_cond2},#{ext_cond3})
    	</create>
    	<update>
    	    update proc_task_assign_rule set province_code=#{province_code},area_code=#{area_code},target_depart_no=#{target_depart_no},
    	    target_oper_no=#{target_oper_no},tache_code=#{tache_code},oper_code=#{oper_code},accept_oper_no=#{accept_oper_no},
    	    accept_depart_no=#{accept_depart_no},ext_cond1=#{ext_cond1},ext_cond2=#{ext_cond2},ext_cond3=#{ext_cond3} where id=#{id}
    	</update>
    	<delete>
    	    delete from proc_task_assign_rule where id=#{id}
    	</delete>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcTaskRuleSpecPo" type="jdbc">
    	<query name="queryTaskRuleSpecByPo">
    		select id,rule_id,target_oper_no,proportion,flag from proc_task_rule_spec where 1=1 and flag='0'
    		<if test="filter.rule_id != null and filter.rule_id != ''">
                and rule_id = #{filter.rule_id}
            </if>
            <if test="filter.proportion != null and filter.proportion != ''">
                and proportion = #{filter.proportion}
            </if>
    	</query>
    	<query name="queryProcTaskRuleSpecById">
    	    select id,rule_id,target_oper_no,proportion,flag from proc_task_rule_spec where  id=#{filter.id}
    	</query>
    	<query name="queryTaskRuleSpecGroupByRuleId">
    	    select distinct rule_id from proc_task_rule_spec where flag='0' and rule_id like '%${filter.rule_id}%'
    	</query>
    	<query name="queryProcTaskRuleSpecByWeb">
    	    select id,rule_id,target_oper_no,proportion,flag from proc_task_rule_spec where 1=1
    	    <if test="filter.rule_id != null and filter.rule_id != ''">
                and rule_id like '%${filter.rule_id}%'
            </if>
            <if test="filter.target_oper_no != null and filter.target_oper_no != ''">
                and target_oper_no in (${filter.target_oper_no})
            </if>
            <if test="filter.proportion != null and filter.proportion != ''">
                and proportion = #{filter.proportion}
            </if>
            <if test="filter.flag != null and filter.flag != ''">
                and flag = #{filter.flag}
            </if>
            <!-- limit ${filter.offset},${filter.limit} -->
    	</query>
    	<query name="queryProcTaskRuleSpecCount">
    	    select id,rule_id,target_oper_no,proportion,flag from proc_task_rule_spec where 1=1
    	    <if test="filter.rule_id != null and filter.rule_id != ''">
                and rule_id like '%${filter.rule_id}%'
            </if>
            <if test="filter.target_oper_no != null and filter.target_oper_no != ''">
                and target_oper_no in (${filter.target_oper_no})
            </if>
            <if test="filter.proportion != null and filter.proportion != ''">
                and proportion = #{filter.proportion}
            </if>
            <if test="filter.flag != null and filter.flag != ''">
                and flag = #{filter.flag}
            </if>
    	</query>
    	<create>
    	    insert into proc_task_rule_spec(id,rule_id,target_oper_no,proportion,flag)
    	    values (#{id},#{rule_id},#{target_oper_no},#{proportion},#{flag})
    	</create>
    	<update>
    	    update proc_task_rule_spec set rule_id=#{rule_id},target_oper_no=#{target_oper_no},proportion=#{proportion},flag=#{flag} where id=#{id}
    	</update>
    	<delete>
    	    delete from proc_task_rule_spec where id=#{id}
    	</delete>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcTaskRuleDepartPo" type="jdbc">
    	<query name="queryTaskRuleDepartByPo">
    		select depart_no,rule_id,proportion from proc_task_rule_depart where 1=1
    		<if test="filter.depart_no != null and filter.depart_no != ''">
                and depart_no = #{filter.depart_no}
            </if>
    		<if test="filter.rule_id != null and filter.rule_id != ''">
                and rule_id = #{filter.rule_id}
            </if>
            <if test="filter.proportion != null and filter.proportion != ''">
                and proportion = #{filter.proportion}
            </if>
    	</query>
    	<query name="queryProcTaskRuleDepartByWeb">
    	    select depart_no,rule_id,proportion from proc_task_rule_depart where 1=1
    	    <if test="filter.depart_no != null and filter.depart_no != ''">
                and depart_no = #{filter.depart_no}
            </if>
    	    <if test="filter.rule_id != null and filter.rule_id != ''">
                and rule_id = #{filter.rule_id}
            </if>
            <if test="filter.proportion != null and filter.proportion != ''">
                and proportion = #{filter.proportion}
            </if>
            <!-- limit ${filter.offset},${filter.limit} -->
    	</query>
    	<query name="queryProcTaskRuleDepartCount">
    	    select depart_no,rule_id,proportion from proc_task_rule_depart where 1=1
    	    <if test="filter.depart_no != null and filter.depart_no != ''">
                and depart_no = #{filter.depart_no}
            </if>
    	    <if test="filter.rule_id != null and filter.rule_id != ''">
                and rule_id = #{filter.rule_id}
            </if>
            <if test="filter.proportion != null and filter.proportion != ''">
                and proportion = #{filter.proportion}
            </if>
    	</query>
    	<create>
    	    insert into proc_task_rule_depart(depart_no,rule_id,proportion)
    	    values (#{depart_no},#{rule_id},#{proportion})
    	</create>
    	<update>
    	    update proc_task_rule_depart set rule_id=#{rule_id},proportion=#{proportion} where depart_no=#{depart_no}
    	</update>
    	<delete>
    	    delete from proc_task_rule_depart where depart_no=#{depart_no}
    	</delete>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uocinst.po.ProcInstTaskAssignDepartPo" type="jdbc">
    	<create>
	    	insert into task_assign_depart (order_no, province_code, area_code, part_month, assign_depart_no) 
	    	values (#{order_no}, #{province_code}, #{area_code}, #{part_month}, #{assign_depart_no})
    	</create>
    	<update>
    		update task_assign_depart set assign_depart_no=#{assign_depart_no},area_code=#{area_code},part_month=#{part_month},province_code=#{province_code}
            where order_no=#{order_no} and part_month=#{part_month} and area_code=#{area_code}
    	</update>
    	<delete>
    		delete from task_assign_depart where order_no=#{order_no} and part_month=#{part_month} and area_code=#{area_code} and part_month=#{filter.part_month}
    	</delete>
    	<query name="queryProcInstTaskAssignDepartByPo">
    	    select order_no ,province_code ,area_code ,part_month ,assign_depart_no from task_assign_depart where 1=1 and area_code=#{filter.area_code} 
    	    <if test="filter.order_no != null and filter.order_no != ''">
          			and order_no=#{filter.order_no} 
         	</if>	
    	</query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoOrderCancelPo" type="jdbc">
    	<query name="queryInfoOrderCancelByPo">
    	    select a.order_no,a.order_type,a.province_code,a.area_code,a.part_month,a.cancel_type,all_to_str(a.cancel_time,'yyyy-mm-dd hh:mm:ss')cancel_time,a.cancel_oper_no,a.cancel_tache_code,a.cancel_reason,a.audit_state,all_to_str(a.audti_time,'yyyy-mm-dd hh:mm:ss')audti_time,a.audit_oper_no,a.audit_desc
 			from info_order_cancel a where 1=1  and a.order_no=#{filter.order_no} and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}
 			<if test="filter.order_type != null and filter.order_type != ''">
          			 and  a.order_type=#{filter.order_type} 
         	</if> 
    	</query>
    	<create>
  	       insert into info_order_cancel (order_no,order_type,province_code,area_code,part_month,cancel_type,cancel_time,cancel_oper_no,cancel_tache_code,cancel_reason,audit_state,audti_time,audit_oper_no,audit_desc) 
  	       values (#{order_no},#{order_type},#{province_code},#{area_code},#{part_month},#{cancel_type},all_to_date(#{cancel_time},'yyyy-mm-dd hh:mm:ss'),#{cancel_oper_no},#{cancel_tache_code},#{cancel_reason},#{audit_state},all_to_date(#{audti_time},'yyyy-mm-dd hh:mm:ss'),#{audit_oper_no},#{audit_desc})
  	    </create>
    	<update>
    		update info_order_cancel set order_type= #{order_type},area_code= #{area_code},part_month= #{part_month},province_code= #{province_code},cancel_type= #{cancel_type},cancel_time= all_to_date(#{cancel_time},'yyyy-mm-dd hh:mm:ss'),cancel_oper_no= #{cancel_oper_no},cancel_tache_code= #{cancel_tache_code},cancel_reason= #{cancel_reason},audit_state= #{audit_state},audti_time= all_to_date(#{audti_time},'yyyy-mm-dd hh:mm:ss'),audit_oper_no= #{audit_oper_no},audit_desc= #{audit_desc} 
			where order_no = #{order_no} and area_code= #{area_code} and part_month= #{part_month}
    	</update>
    	<delete>
  	        delete from info_order_cancel where order_no=#{filter.order_no} and area_code= #{filter.area_code} and part_month= #{filter.part_month}
  	    </delete>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uocinst.po.ProcInstTaskAssignOperPo" type="jdbc">
    	<create>
	    	insert into task_assign_oper (order_no, province_code, area_code, part_month, assign_oper_no) 
	    	values (#{order_no}, #{province_code}, #{area_code}, #{part_month}, #{assign_oper_no})
    	</create>
    	<update>
    		update task_assign_oper set assign_oper_no=#{assign_oper_no},area_code=#{area_code},part_month=#{part_month},province_code=#{province_code}
            where order_no=#{order_no} and part_month=#{part_month} and area_code=#{area_code}
    	</update>
		<delete>
    		delete from task_assign_oper where order_no=#{order_no} and part_month=#{part_month} and area_code=#{area_code}
    	</delete>
    	<query name="queryProcInstTaskAssignOperByPo">
    	    select order_no ,province_code ,area_code ,part_month ,assign_oper_no from task_assign_oper where 1=1 and area_code=#{filter.area_code} and part_month=#{filter.part_month}		
    		<if test="filter.order_no != null and filter.order_no != ''">
          			and order_no=#{filter.order_no} 
         	</if>
    	</query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uocinst.po.ProcInstTaskAssignRecordPo" type="jdbc">
    	<create>
	    	insert into task_assign_record (id,task_id,order_no,province_code, area_code, part_month, assign_time,assign_oper_no,to_depart_no,to_oper_no) 
	    	values (#{id}, #{task_id}, #{order_no}, #{province_code}, #{area_code}, #{part_month}, all_to_date(#{assign_time},'yyyy-mm-dd hh:mm:ss'),#{assign_oper_no},#{to_depart_no},#{to_oper_no})
    	</create>
    	<query name="queryProcInstTaskAssignRecordByOrderNo">
    	    select id,task_id,order_no,province_code, area_code, part_month, assign_time,assign_oper_no,to_depart_no,to_oper_no from task_assign_record where 1=1 and part_month=#{filter.part_month} and area_code=#{filter.area_code}
    	    <if test="filter.order_no != null and filter.order_no != ''">
    	        and order_no=#{filter.order_no}
    	    </if>
    	</query>
    	<delete>
    	    delete from task_assign_record where order_no=#{filter.order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
    	</delete>
    </service>
  
    <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcViewInfoPo" type="jdbc">
        <query name="queryProcViewInfo">
            select id,proc_mod_code,tache_code,seq_no from proc_view_info where 1=1
            <if test="filter.proc_mod_code != null and filter.proc_mod_code != ''">
          			and proc_mod_code=#{filter.proc_mod_code} 
         	</if>
        </query>
        
    </service>
    <service data="com.tydic.unicom.uoc.base.uoccode.po.ProcModTacheLoginPo" type="jdbc">
        <query name="queryProcModTacheLoginByTacheCode">
            select id,tache_code,role_id,province_code,area_code from proc_tache_login where 1=1 
            <if test="filter.tache_code != null and filter.tache_code != ''">
          			and tache_code=#{filter.tache_code} 
         	</if>
            <if test="filter.role_id != null and filter.role_id != ''">
          			and role_id ='${filter.role_id}'
         	</if>
        </query>
        <query name= "queryProcModTacheLoginList">
            select id,tache_code,role_id,province_code,area_code from proc_tache_login where 1=1
            <if test="filter.role_id != null and filter.role_id != ''">
          			and role_id ='${filter.role_id}'
         	</if>
         	<if test="filter.tache_code != null and filter.tache_code != ''">
          			and tache_code=#{filter.tache_code}
         	</if>
         	<if test="filter.province_code != null and filter.province_code != ''">
          			and province_code=#{filter.province_code}
         	</if>
         	<if test="filter.area_code != null and filter.area_code != ''">
          			 and area_code=#{filter.area_code}
         	</if>
             
            limit ${filter.offset},${filter.limit}	
        </query>
        <query name="queryProcModTacheLoginAll">
            select id,tache_code,role_id,province_code,area_code from proc_tache_login
        </query>
        <query name= "queryProcModTacheLoginListCount">
           select id,tache_code,role_id,province_code,area_code from proc_tache_login where 1=1
            <if test="filter.role_id != null and filter.role_id != ''">
          			and role_id ='${filter.role_id}'
         	</if>
         	<if test="filter.tache_code != null and filter.tache_code != ''">
          			and tache_code=#{filter.tache_code}
         	</if>
         	<if test="filter.province_code != null and filter.province_code != ''">
          			and province_code=#{filter.province_code}
         	</if>
         	<if test="filter.area_code != null and filter.area_code != ''">
          			 and area_code=#{filter.area_code}
         	</if>          
        </query>
        <create>
            insert into proc_tache_login (id,tache_code,role_id,province_code,area_code)
            values (#{id},#{tache_code},#{role_id},#{province_code},#{area_code})
        </create>
        <update>
            update proc_tache_login set id=#{id},tache_code=#{tache_code},role_id=#{role_id},province_code=#{province_code},area_code=#{area_code}  where id=#{id}
        </update>
        <delete>
            delete from proc_tache_login where id=#{id}
        </delete>
    </service>
   
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderPo" type="jdbc">
        <get>
            select serv_order_no ,ofr_order_no ,sale_order_no ,province_code ,area_code ,part_month ,oper_code ,oper_name ,acc_nbr ,cancle_flag ,order_state ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,proc_inst_id ,ord_mod_code ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,accept_depart_type,tele_type from info_service_order where serv_order_no =#{serv_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </get>
         <query name="queryInfoServiceOrderByOrderNo">
            select serv_order_no ,ofr_order_no ,sale_order_no ,province_code ,area_code ,part_month ,oper_code ,oper_name ,acc_nbr ,cancle_flag ,order_state ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,proc_inst_id ,ord_mod_code ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,accept_depart_type,tele_type from info_service_order where 1=1 and part_month=#{filter.part_month} and area_code=#{filter.area_code}
			<if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>
         	 <if test= "filter.ofr_order_no != null and filter.ofr_order_no != ''" >
                   and ofr_order_no ='${filter.ofr_order_no}'
             </if> 
             <if test= "filter.oper_code != null and filter.oper_code != ''" >
                   and oper_code ='${filter.oper_code}'
             </if>            
         
         </query>
         <query name="queryInfoServiceOrderByOfrOrderNo">
            select serv_order_no ,ofr_order_no ,sale_order_no ,province_code ,area_code ,part_month ,oper_code ,oper_name ,acc_nbr ,cancle_flag ,order_state ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,proc_inst_id ,ord_mod_code ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,accept_depart_type,tele_type from info_service_order where ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
         </query>
         <query name="queryInfoServiceOrderBySaleOrderNo">
            select serv_order_no ,ofr_order_no ,sale_order_no ,province_code ,area_code ,part_month ,oper_code ,oper_name ,acc_nbr ,cancle_flag ,order_state ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,proc_inst_id ,ord_mod_code ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,accept_depart_type,tele_type from info_service_order where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
         </query>
        <query name="queryInfoServiceOrderByPo">
        	select serv_order_no ,ofr_order_no ,sale_order_no ,province_code ,area_code ,part_month ,oper_code ,oper_name ,acc_nbr ,cancle_flag ,order_state ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,proc_inst_id ,ord_mod_code ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,accept_depart_type,tele_type from info_service_order where province_code=#{filter.province_code} and area_code=#{filter.area_code}
            <if test= "filter.oper_code != null and filter.oper_code != ''" >
                   and oper_code ='${filter.oper_code}'
            </if>
            <if test= "filter.accept_oper_no != null and filter.accept_oper_no != ''" >
                   and accept_oper_no ='${filter.accept_oper_no}'
            </if>
            <if test= "filter.accept_depart_no != null and filter.accept_depart_no != ''" >
                   and accept_depart_no ='${filter.accept_depart_no}'
            </if>
        </query>
        <query name="queryInfoServiceOrderAndSim">
			select a.serv_order_no,a.sale_order_no,a.acc_nbr from info_service_order a,info_serv_sim_card b,info_sale_order c where 1=1 and a.province_code=#{filter.province_code} and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month} and b.area_code=#{filter.area_code} and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month}
			<if test="filter.acc_nbr != null and filter.acc_nbr != ''">
				and a.acc_nbr='${filter.acc_nbr}'
			</if>
			<if test="filter.sim_id != null and filter.sim_id != ''">
			    and a.serv_order_no=b.serv_order_no and b.sim_id='${filter.sim_id}'
				<!-- and b.sim_id='${filter.sim_id}' -->
			</if>
			<if test="filter.contact_tel !=null and filter.contact_tel != ''">
			    <!-- and EXISTS (select d.sale_order_no from info_sale_order c,info_deliver_order d where 1=1 and a.sale_order_no=c.sale_order_no and a.sale_order_no=d.sale_order_no and c.sale_order_no=d.sale_order_no and d.contact_tel=#{filter.contact_tel} and d.province_code=#{filter.province_code} and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month}) -->
			    and EXISTS (select d.sale_order_no from info_deliver_order d where d.contact_tel='${filter.contact_tel}' and d.province_code=#{filter.province_code} and d.part_month=#{filter.part_month} and d.area_code=#{filter.area_code} and c.sale_order_no=d.sale_order_no and a.sale_order_no=d.sale_order_no and a.sale_order_no=c.sale_order_no)
			</if>
		</query>
        <create>
             insert into info_service_order (serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,
             part_month,oper_code,oper_name,acc_nbr,cancle_flag,order_state,create_time,finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,accept_depart_type,tele_type) 
             values (#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},
             #{part_month},#{oper_code},#{oper_name},#{acc_nbr},#{cancle_flag},#{order_state},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{proc_inst_id},#{ord_mod_code},#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name},#{accept_depart_type},#{tele_type})            
        </create>
        <update>
            update info_service_order set serv_order_no=#{serv_order_no},ofr_order_no=#{ofr_order_no},sale_order_no=#{sale_order_no},province_code=#{province_code},area_code=#{area_code}, part_month=#{part_month},oper_code=#{oper_code},
            oper_name=#{oper_name},acc_nbr=#{acc_nbr},cancle_flag=#{cancle_flag},order_state=#{order_state},create_time=all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),finish_time=all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),proc_inst_id=#{proc_inst_id},ord_mod_code=#{ord_mod_code},
            accept_oper_no=#{accept_oper_no},accept_oper_name=#{accept_oper_name},accept_depart_no=#{accept_depart_no},accept_depart_name=#{accept_depart_name},tele_type=#{tele_type} 
            where serv_order_no=#{serv_order_no}  and part_month=#{part_month} and area_code=#{area_code}              
        </update>
        <delete>
            delete from info_service_order where serv_order_no=#{serv_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </delete>
        <delete  name="deleteInfoServiceOrderBySaleOrderNo">
            delete from info_service_order where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>
    </service>
  
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderAttrPo" type="jdbc">
        <query name="getInfoServiceOrderAttrPo">
           select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,attr_code,attr_type,attr_after_value,attr_before_value,curr_seq,upper_seq            
            from info_serv_attr where serv_order_no=#{filter.serv_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>
        <!-- <query name="queryInfoServiceOrderAttrByOfrOrderNo">
            select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,attr_code,attr_type,attr_after_value,attr_before_value,curr_seq,upper_seq            
             from info_serv_attr where ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query> -->
        <query name="queryInfoServiceOrderAttrByOrderNo">
           select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,attr_code,attr_type,attr_after_value,attr_before_value,curr_seq,upper_seq
			from info_serv_attr where 1=1 and part_month=#{filter.part_month} and area_code=#{filter.area_code}
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}'
         	</if>
         	 <if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}'
         	</if> 
        </query>
         <delete name="deleteInfoServiceOrderAttrBySaleOrderNo">
            delete from info_serv_attr where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>
    </service>
   
     <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderFeePo" type="jdbc">
   	 	 <query name="queryInfoServiceOrderFeeBySaleOrderNo">
			select
				info_serv_fee.id,
				info_serv_fee.serv_order_no,
				info_serv_fee.ofr_order_no,
				info_serv_fee.sale_order_no,
				info_serv_fee.province_code,
				info_serv_fee.area_code,
				info_serv_fee.part_month,
				info_serv_fee.fee_item_code,
				info_serv_fee.fee_item_name,
				info_serv_fee.fee_item_type,
				info_serv_fee.total_fee,
				info_serv_fee.discount_fee,
				info_serv_fee.payed_fee,
				info_serv_fee.discount_sn,
				info_serv_fee.discount_comments
			from
				info_serv_fee
			where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
       	 </query>
       	 <query name="queryInfoServiceOrderFeeByServOrderNo">
            select
				info_serv_fee.id,
				info_serv_fee.serv_order_no,
				info_serv_fee.ofr_order_no,
				info_serv_fee.sale_order_no,
				info_serv_fee.province_code,
				info_serv_fee.area_code,
				info_serv_fee.part_month,
				info_serv_fee.fee_item_code,
				info_serv_fee.fee_item_name,
				info_serv_fee.fee_item_type,
				info_serv_fee.total_fee,
				info_serv_fee.discount_fee,
				info_serv_fee.payed_fee,
				info_serv_fee.discount_sn,
				info_serv_fee.discount_comments
			from
				info_serv_fee  
			where serv_order_no=#{filter.serv_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
       	 </query>
       	 <query name="queryInfoServiceOrderFeeByOfrOrderNo">
            select * from info_serv_fee where ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
       	 </query>
       	  <query name="queryInfoServiceOrderFeeByOrderNo">
           select
				info_serv_fee.id,
				info_serv_fee.serv_order_no,
				info_serv_fee.ofr_order_no,
				info_serv_fee.sale_order_no,
				info_serv_fee.province_code,
				info_serv_fee.area_code,
				info_serv_fee.part_month,
				info_serv_fee.fee_item_code,
				info_serv_fee.fee_item_name,
				info_serv_fee.fee_item_type,
				info_serv_fee.total_fee,
				info_serv_fee.discount_fee,
				info_serv_fee.payed_fee,
				info_serv_fee.discount_sn,
				info_serv_fee.discount_comments
			from
				info_serv_fee
			 where  part_month=#{filter.part_month} and area_code=#{filter.area_code}
       		<if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>
       		<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no=#{filter.ofr_order_no}
         	</if>
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no=#{filter.serv_order_no}
         	</if>
       	 </query>
       	 <delete name="deleteInfoServiceOrderFeeBySaleOrderNo">
            delete from info_serv_fee where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>
     </service>
    
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderPo" type="jdbc">
        <get>
            select sale_order_no,province_code,area_code,part_month,all_to_str(accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,order_type,accept_no,accept_type,accept_system,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,pay_flag,pay_type,express_flag,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,proc_inst_id,pre_proc_inst_id,accept_depart_type,callback_url from info_sale_order where  sale_order_no =#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </get>
        <query name="queryInfoSaleOrderPo">
           select sale_order_no,province_code,area_code,part_month,all_to_str(accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,order_type,accept_no,accept_type,accept_system,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,pay_flag,pay_type,express_flag,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,proc_inst_id,pre_proc_inst_id,accept_depart_type,callback_url
           from info_sale_order where 1=1  and area_code=#{filter.area_code}
           	<if test="filter.part_month != null and filter.part_month != ''">
          			 and part_month=#{filter.part_month}
         	</if>  
       	    <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.accept_no != null and filter.accept_no != ''">
          			and accept_no ='${filter.accept_no}' and accept_system ='${filter.accept_system}'
         	</if>  
        </query>
        <query name="queryInfoSaleOrder">
           
			select sale_order_no,province_code,area_code,part_month,all_to_str(accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,order_type,accept_no,accept_type,accept_system,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,pay_flag,pay_type,express_flag,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,proc_inst_id,pre_proc_inst_id,accept_depart_type,callback_url
            from info_sale_order where 1=1 and accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss')  and accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss') and area_code=#{filter.area_code} and part_month=#{filter.part_month} and province_code=#{filter.province_code}  and accept_depart_no=#{filter.accept_depart_no}
       	   <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
            <if test="filter.accept_no != null and filter.accept_no != ''">
                and accept_no = '${filter.accept_no}'
            </if>
            <if test="filter.accept_system != null and filter.accept_system != ''">
                and accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.order_state != null and filter.order_state != ''">
                and order_state = '${filter.order_state}'
            </if>
             <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
                and sale_order_no = '${filter.sale_order_no}'
            </if>
        </query>
        <query name="queryInfoSaleOrderPoList">
            select distinct sale_order_no,province_code,area_code,part_month,all_to_str(accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,order_type,accept_no,accept_type,accept_system,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,pay_flag,pay_type,express_flag,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,proc_inst_id,pre_proc_inst_id,accept_depart_type,callback_url
            from info_sale_order where 1=1 and accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss')   and accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss') and area_code=#{filter.area_code} and part_month=#{filter.part_month} and province_code=#{filter.province_code}  and accept_depart_no=#{filter.accept_depart_no}
       	   <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
            <if test="filter.accept_no != null and filter.accept_no != ''">
                and accept_no = '${filter.accept_no}'
            </if>
            <if test="filter.accept_system != null and filter.accept_system != ''">
                and accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.order_state != null and filter.order_state != ''">
                and order_state = '${filter.order_state}'
            </if>
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
                and sale_order_no = '${filter.sale_order_no}'
            </if>
            limit ${filter.offset},${filter.limit}
        </query>
        <query name="queryInfoSaleOrderByOrderState">
            select sale_order_no,province_code,area_code,part_month,all_to_str(accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,order_type,accept_no,accept_type,accept_system,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,pay_flag,pay_type,express_flag,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,proc_inst_id,pre_proc_inst_id,accept_depart_type,callback_url
            from info_sale_order where 1=1 and part_month='${filter.part_month}' and order_state = '${filter.order_state}' and area_code='${filter.area_code}' and mod(sale_order_no,#{filter.total_num})=#{filter.remainder} limit 0,1000
        </query>
  		<create>
  		    insert into info_sale_order(sale_order_no,province_code,area_code,part_month,accept_time,order_type,accept_no,accept_type,accept_system,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,pay_flag,pay_type,express_flag,cancle_flag,order_state,create_time,finish_time,ord_mod_code,proc_inst_id,pre_proc_inst_id,accept_depart_type,callback_url)
  			values(#{sale_order_no},#{province_code},#{area_code},#{part_month},all_to_date(#{accept_time},'yyyy-mm-dd hh:mm:ss'),#{order_type},#{accept_no},#{accept_type},#{accept_system},#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name},#{pay_flag},#{pay_type},#{express_flag},#{cancle_flag},#{order_state},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{ord_mod_code},#{proc_inst_id},#{pre_proc_inst_id},#{accept_depart_type},#{callback_url})
  		</create>
  		<update>
  		    update info_sale_order set sale_order_no=#{sale_order_no},province_code=#{province_code},area_code=#{area_code},part_month=#{part_month},accept_time=all_to_date(#{accept_time},'yyyy-mm-dd hh:mm:ss'),order_type=#{order_type},accept_no=#{accept_no},accept_type=#{accept_type},accept_system=#{accept_system},accept_oper_no=#{accept_oper_no},accept_oper_name=#{accept_oper_name},
  		    accept_depart_no=#{accept_depart_no},accept_depart_name=#{accept_depart_name},pay_flag =#{pay_flag},pay_type =#{pay_type},express_flag=#{express_flag},cancle_flag=#{cancle_flag},order_state=#{order_state},create_time=all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),finish_time=all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),ord_mod_code=#{ord_mod_code},proc_inst_id=#{proc_inst_id},pre_proc_inst_id=#{pre_proc_inst_id},callback_url=#{callback_url}
  		    where sale_order_no=#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
  		</update>
  		<delete>
  		    delete from info_sale_order where sale_order_no =#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
  		</delete>
    </service>
  
     <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderEditPo" type="jdbc">
  		 <get>
            select id,sale_order_no,province_code,area_code,part_month,edit_type,state,edit_system,oper_no,all_to_str(edit_time,'yyyy-mm-dd hh:mm:ss')edit_time,edit_desc,is_compress,json_url,json_content from info_sale_edit where  sale_order_no =#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </get>
        <query name="queryInfoSaleOrderEditPoBySaleOrderNo">
            select id,sale_order_no,province_code,area_code,part_month,edit_type,state,edit_system,oper_no,all_to_str(edit_time,'yyyy-mm-dd hh:mm:ss')edit_time,edit_desc,is_compress,json_url,json_content from info_sale_edit where 
             sale_order_no =#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}       
        </query>
  		<create>
  		    insert into info_sale_edit(id,sale_order_no,province_code,area_code,part_month,edit_type,state,edit_system,oper_no,edit_time,edit_desc,is_compress,json_url,json_content)
  			values(#{id},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{edit_type},#{state},#{edit_system},#{oper_no},all_to_date(#{edit_time},'yyyy-mm-dd hh:mm:ss'),#{edit_desc},#{is_compress},#{json_url},#{json_content})
  		</create>
  		<delete>
  		    delete from info_sale_edit where sale_order_no =#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
  		</delete>
    </service>
   
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderAttrPo" type="jdbc">
        <query name="queryInfoSaleOrderAttrBySaleOrderNo">
            select * from info_sale_attr where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>
  		<delete>
  		    delete from info_sale_attr where sale_order_no =#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
  		</delete>
    </service>
   
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderServMapPo" type="jdbc">
         <query name="queryInfoSaleOrderServMapBySaleOrderNo">
           select id,sale_order_no,province_code,area_code,part_month,oper_code,oper_name,acc_nbr,tele_type,ext_field_1,ext_field_3,ext_field_4,ext_field_5,ext_field_2
			 from info_sale_serv_map where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>
        <query name="queryInfoSaleOrderServMapByAccNbr">
            select id,sale_order_no,province_code,area_code,part_month,oper_code,oper_name,acc_nbr,tele_type,ext_field_1,ext_field_3,ext_field_4,ext_field_5,ext_field_2
			from info_sale_serv_map where acc_nbr=#{filter.acc_nbr} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>
        <delete>
            delete from info_sale_serv_map where sale_order_no=#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </delete>
        <create>
            insert into info_sale_serv_map(id,sale_order_no,province_code,area_code,part_month,oper_code,oper_name,acc_nbr,tele_type,ext_field_1,ext_field_3,ext_field_4,ext_field_5,ext_field_2) 
            values(#{id},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{oper_code},#{oper_name},#{acc_nbr},#{tele_type},#{ext_field_1},#{ext_field_3},#{ext_field_4},#{ext_field_5},#{ext_field_2})
        </create>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderOfrMapPo" type="jdbc">
         <query name="queryInfoSaleOrderOfrMapBySaleOrderNo">
            select sale_order_no,province_code,area_code,part_month,ofr_id,ofr_name,acc_nbr,ext_field_1,ext_field_3,ext_field_4,ext_field_5,ext_field_2
             from info_sale_ofr_map where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>
        <query name="queryInfoSaleOrderOfrMapByAccNbr">
            select sale_order_no,province_code,area_code,part_month,ofr_id,ofr_name,acc_nbr,ext_field_1,ext_field_3,ext_field_4,ext_field_5,ext_field_2 
            from info_sale_ofr_map where acc_nbr=#{filter.acc_nbr} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>
        <delete>
            delete from info_sale_ofr_map where sale_order_no=#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </delete>
    </service>
   
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderPersionPo" type="jdbc">
        <get>
            select sale_order_no,province_code,area_code,part_month,cust_id,cust_name,new_flag,cust_phone,email,cust_address,sex,cust_type,cert_type,cert_no,cert_address,cert_expire_date,cert_link1,cert_link2,cert_link3
			 from info_sale_person where  sale_order_no =#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </get>
   	  <delete>
            delete from info_sale_person where sale_order_no=#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </delete>     
     </service>
    
     <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderPersionCertPo" type="jdbc">
        <get>
            select sale_order_no,province_code,area_code,part_month,cert_face_url,cert_back_url,cert_hand_url,cert_video_url,audit_result,simil_rate,note,pic_person_url,pic_guardian_url,pic_from_person_url,pic_from_guardian_url          
            from info_sale_person_cert where  sale_order_no =#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </get>
   	  <delete>
            delete from info_sale_person_cert where sale_order_no=#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </delete>
        <create>
            insert into info_sale_person_cert(sale_order_no,province_code,area_code,part_month,cert_face_url,cert_back_url,cert_hand_url,cert_video_url,audit_result,simil_rate,note,pic_person_url,pic_guardian_url,pic_from_person_url,pic_from_guardian_url) 
            values(#{sale_order_no},#{province_code},#{area_code},#{part_month},#{cert_face_url},#{cert_back_url},#{cert_hand_url},#{cert_video_url},#{audit_result},#{simil_rate},#{note},#{pic_person_url},#{pic_guardian_url},#{pic_from_person_url},#{pic_from_guardian_url})
        </create>
        <update>
            update info_sale_person_cert set cert_face_url=#{cert_face_url},cert_back_url=#{cert_back_url},cert_hand_url=#{cert_hand_url},cert_video_url=#{cert_video_url},audit_result=#{audit_result},simil_rate=#{simil_rate},note=#{note},pic_person_url=#{pic_person_url},
            pic_guardian_url=#{pic_guardian_url},pic_from_person_url=#{pic_from_person_url},pic_from_guardian_url=#{pic_from_guardian_url}
            where  sale_order_no =#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </update>
     </service>
    
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderDistributionPo" type="jdbc">
        <get>
            select * from info_sale_distr where  sale_order_no =#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </get>
        <query name="queryInfoSaleOrderDistributionByPayOrderNo">
            select * from info_sale_distr where 1=1               
            and part_month=#{filter.part_month} 
            and area_code=#{filter.area_code}
            and sale_order_no in 
			(select rela_order_no from info_pay_order where 1=1 
			and rela_order_no=#{filter.sale_order_no} 
			and rela_order_type=#{filter.rela_order_type}) 
        </query>
   	  <delete>
            delete from info_sale_distr where sale_order_no=#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </delete>
     </service>
     
     <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderDistrDetailPo" type="jdbc">
      <query name="queryInfoSaleOrderDistrDetailBySaleOrderNo">
            select * from info_sale_distr_detail where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
      </query>
      <query name="queryInfoSaleOrderDistrDetailByPayOrderNo">
          	select * from info_sale_distr_detail where 1=1               
            and part_month=#{filter.part_month} 
            and area_code=#{filter.area_code}
            and sale_order_no in 
			(select rela_order_no from info_pay_order where 1=1 
			and rela_order_no=#{filter.sale_order_no} 
			and rela_order_type=#{filter.rela_order_type}) 
      </query>
   	  <delete>
            delete from info_sale_distr_detail where sale_order_no=#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </delete>
     </service>
     
     <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderExtPo" type="jdbc">
   	  <delete>
            delete from info_sale_ext where sale_order_no=#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </delete>
        <query name="queryInfoServiceOrderExtByOrderNo">
              	select a.sale_order_no,
				       a.province_code,
				       a.area_code,    
				       a.part_month,   
				       a.ext_field_1,  
				       a.ext_field_2,  
				       a.ext_field_3,  
				       a.ext_field_4,  
				       a.ext_field_5,  
				       a.ext_field_6,  
				       a.ext_field_7,  
				       a.ext_field_8,  
				       a.ext_field_9,  
				       a.ext_field_10, 
				       a.ext_field_11, 
				       a.ext_field_12, 
				       a.ext_field_13, 
				       a.ext_field_14, 
				       a.ext_field_15, 
				       a.ext_field_16, 
				       a.ext_field_17, 
				       a.ext_field_18, 
				       a.ext_field_19, 
				       a.ext_field_20  
  				from info_sale_ext a 
				 where 1=1  and part_month=#{filter.part_month} and area_code=#{filter.area_code}
              <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>            
      </query>
        <get>
            select a.sale_order_no,
				       a.province_code,
				       a.area_code,    
				       a.part_month,   
				       a.ext_field_1,  
				       a.ext_field_2,  
				       a.ext_field_3,  
				       a.ext_field_4,  
				       a.ext_field_5,  
				       a.ext_field_6,  
				       a.ext_field_7,  
				       a.ext_field_8,  
				       a.ext_field_9,  
				       a.ext_field_10, 
				       a.ext_field_11, 
				       a.ext_field_12, 
				       a.ext_field_13, 
				       a.ext_field_14, 
				       a.ext_field_15, 
				       a.ext_field_16, 
				       a.ext_field_17, 
				       a.ext_field_18, 
				       a.ext_field_19, 
				       a.ext_field_20  
  				from info_sale_ext a
            where sale_order_no=#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
      </get>
     </service>
     
     <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderExtPo" type="jdbc">
        <create>
         insert into info_serv_ext(serv_order_no,sale_order_no,ofr_order_no,province_code,area_code,part_month,ext_field_1,ext_field_2,ext_field_3,ext_field_4,ext_field_5,ext_field_6,ext_field_7,ext_field_8,ext_field_9,ext_field_10,ext_field_11,ext_field_12,ext_field_13,ext_field_14,ext_field_15,ext_field_16,ext_field_17,ext_field_18,ext_field_19,ext_field_20,
  		    ext_field_21,ext_field_22,ext_field_23,ext_field_24,ext_field_25,ext_field_26,ext_field_27,ext_field_28,ext_field_29,ext_field_30,ext_field_31,ext_field_32,ext_field_33,ext_field_34,ext_field_35,ext_field_36,ext_field_37,ext_field_38,ext_field_39,ext_field_40)
  			values(#{serv_order_no},#{sale_order_no},#{ofr_order_no},#{province_code},#{area_code},#{part_month},#{ext_field_1},#{ext_field_2},#{ext_field_3},#{ext_field_4},#{ext_field_5},#{ext_field_6},#{ext_field_7},#{ext_field_8},#{ext_field_9},#{ext_field_10},#{ext_field_11},#{ext_field_12},#{ext_field_13},#{ext_field_14},#{ext_field_15},#{ext_field_16},#{ext_field_17},#{ext_field_18},#{ext_field_19},#{ext_field_20},
  			#{ext_field_21},#{ext_field_22},#{ext_field_23},#{ext_field_24},#{ext_field_25},#{ext_field_26},#{ext_field_27},#{ext_field_28},#{ext_field_29},#{ext_field_30},#{ext_field_31},#{ext_field_32},#{ext_field_33},#{ext_field_34},#{ext_field_35},#{ext_field_36},#{ext_field_37},#{ext_field_38},#{ext_field_39},#{ext_field_40})
        </create>
        <update>
            update info_serv_ext set ext_field_6=#{ext_field_6} where serv_order_no=#{serv_order_no}
        </update>
   	    <delete name="deleteInfoServiceOrderExtBySaleOrderNo">
            delete from info_serv_ext where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>
        <query name="queryInfoServiceOrderExtByOrderNo">
			  select
					   a.serv_order_no,
				       a.sale_order_no,
				       a.ofr_order_no,
				       a.province_code,
				       a.area_code,
				       a.part_month,
				       a.ext_field_1,
				       a.ext_field_2,
				       a.ext_field_3,
				       a.ext_field_4,
				       a.ext_field_5,
				       a.ext_field_6,
				       a.ext_field_7,
				       a.ext_field_8,
				       a.ext_field_9,
				       a.ext_field_10,
				       a.ext_field_11,
				       a.ext_field_12,
				       a.ext_field_13,
				       a.ext_field_14,
				       a.ext_field_15,
				       a.ext_field_16,
				       a.ext_field_17,
				       a.ext_field_18,
				       a.ext_field_19,
				       a.ext_field_20,
				       a.ext_field_21,
				       a.ext_field_22,
				       a.ext_field_23,
				       a.ext_field_24,
				       a.ext_field_25,
				       a.ext_field_26,
				       a.ext_field_27,
				       a.ext_field_28,
				       a.ext_field_29,
				       a.ext_field_30,
				       a.ext_field_31,
				       a.ext_field_32,
				       a.ext_field_33,
				       a.ext_field_34,
				       a.ext_field_35,
				       a.ext_field_36,
				       a.ext_field_37,
				       a.ext_field_38,
				       a.ext_field_39,
				       a.ext_field_40
  				from info_serv_ext a where 1=1  and part_month=#{filter.part_month} and area_code=#{filter.area_code}
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>  
            
      </query>
     </service>
   
     <service data="com.tydic.unicom.uoc.base.uoccode.po.OrdModAppPo" type="jdbc">        
        <create>
           insert into ord_mod_app (id,mod_code,province_code,area_code,mod_used,used_system,used_service,oper_code,tache_id,oper_limit_time) 
           values (#{id},#{mod_code},#{province_code},#{area_code},#{mod_used},#{used_system},#{used_service},#{oper_code},#{tache_id},#{oper_limit_time}) 
        </create>
        <delete>
            delete from ord_mod_app where id=#{id}
        </delete>      
        <update>
            update ord_mod_app set id=#{id},mod_code=#{mod_code},province_code=#{province_code},area_code=#{area_code},mod_used=#{mod_used},
            used_system=#{used_system},used_service=#{used_service},oper_code=#{oper_code},tache_id=#{tache_id},
            oper_limit_time=#{oper_limit_time} where id=#{id}
        </update>
        <query name="queryOrdModAppList">
            select id,mod_code,province_code,area_code,mod_used,used_system,used_service,oper_code,tache_id,oper_limit_time from ord_mod_app where 1=1             			   
            <if test="filter.mod_code != null and filter.mod_code != ''">
                	and mod_code=#{filter.mod_code} 
        	</if>
            <if test="filter.mod_used != null and filter.mod_used != ''">
                	and mod_used=#{filter.mod_used} 
        	</if>
        	 <if test="filter.oper_code != null and filter.oper_code != ''">
                	and oper_code=#{filter.oper_code}
        	</if>
        	 <if test="filter.tache_id != null and filter.tache_id != ''">
                	and tache_id=#{filter.tache_id}  
        	</if>
        	<if test="filter.used_system != null and filter.used_system != ''">
                	and used_system=#{filter.used_system}  
        	</if>
            limit ${filter.offset},${filter.limit}			            
        </query> 
        <query name="queryOrdModAppListCount">
             select id,mod_code,province_code,area_code,mod_used,used_system,used_service,oper_code,tache_id,oper_limit_time from ord_mod_app where 1=1 
			<if test="filter.mod_code != null and filter.mod_code != ''">
                	and mod_code=#{filter.mod_code} 
        	</if>
        	<if test="filter.mod_used != null and filter.mod_used != ''">
                	and mod_used=#{filter.mod_used} 
        	</if>
        	 <if test="filter.oper_code != null and filter.oper_code != ''">
                	and oper_code=#{filter.oper_code}
        	</if>
        	 <if test="filter.tache_id != null and filter.tache_id != ''">
                	and tache_id=#{filter.tache_id}  
        	</if>
        	<if test="filter.used_system != null and filter.used_system != ''">
                	and used_system=#{filter.used_system}  
        	</if>
        </query>
        <query name="queryOrdModAppAll">
            select id,mod_code,province_code,area_code,mod_used,used_system,used_service,oper_code,tache_id,oper_limit_time from ord_mod_app
        </query>       
    </service>
	<service data="com.tydic.unicom.uoc.base.uoccode.po.OrdModCheckRulePo" type="jdbc">
		<create>
			insert into ord_check_rule
			(id,mod_code,mod_check_method,mod_check_desc,input_json)
			values
			(#{id},#{mod_code},#{mod_check_method},#{mod_check_desc},#{input_json})
		</create>
		<delete>
			delete from ord_check_rule where id=#{id}
		</delete>
		<update>
			update ord_check_rule set
			id=#{id},mod_code=#{mod_code},mod_check_method=#{mod_check_method},mod_check_desc=#{mod_check_desc},input_json=#{input_json}
			where id=#{id}
		</update>
		<query name="queryOrdModCheckRuleList">
			select id,mod_code,mod_check_method,mod_check_desc,input_json from ord_check_rule where 1=1 and mod_code=#{filter.mod_code} limit ${filter.offset},${filter.limit} 						
		</query>
		<query name="queryOrdModCheckRuleListCount">
			select id,mod_code,mod_check_method,mod_check_desc,input_json from ord_check_rule where 1=1 and mod_code=#{filter.mod_code}
		</query>
		<query name="queryOrdModCheckRuleAll">
		    select id,mod_code,mod_check_method,mod_check_desc,input_json from ord_check_rule
		</query>
	</service>
     <service data="com.tydic.unicom.uoc.base.uoccode.po.OrdModDefinePo" type="jdbc">        
        <create>
           insert into ord_mod_define (mod_code,mod_name,mod_desc,province_code,area_code,state,json_module,create_staff,create_time) 
           values (#{mod_code},#{mod_name},#{mod_desc},#{province_code},#{area_code},#{state},#{json_module},#{create_staff},#{create_time}) 
        </create>
        <delete>
            delete from ord_mod_define where mod_code=#{mod_code}
        </delete>      
        <update>
            update ord_mod_define set mod_code=#{mod_code},mod_name=#{mod_name},mod_desc=#{mod_desc},province_code=#{province_code},area_code=#{area_code},state=#{state},json_module=#{json_module},create_staff=#{create_staff},create_time=#{create_time}
             where mod_code=#{mod_code}
        </update>
          <query name= "queryOrdModDefineList">
           		select mod_code,mod_name,mod_desc,province_code,area_code,state,json_module,create_staff,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss') create_time,interface_param_json,interface_type from ord_mod_define where 1=1           		 	
           		 <if test="filter.mod_code != null and filter.mod_code != ''">
                	and mod_code=#{filter.mod_code} 
       			 </if>
           		 <if test="filter.mod_name != null and filter.mod_name != ''">
                	and mod_name like '${filter.mod_name}%'
       			 </if>
           		  limit ${filter.offset},${filter.limit}								
        </query>
        <query name= "queryOrdModDefineListCount">
          select mod_code,mod_name,mod_desc,province_code,area_code,state,json_module,create_staff,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss') create_time,interface_param_json,interface_type from ord_mod_define where 1=1
           		 <if test="filter.mod_code != null and filter.mod_code != ''">
                	and mod_code=#{filter.mod_code} 
       			 </if>
           		 <if test="filter.mod_name != null and filter.mod_name != ''">
                	and mod_name like '${filter.mod_name}%'
       			 </if>	           		  
        </query> 
        <query name="queryOrdModDefineAll">
            select mod_code,mod_name,mod_desc,province_code,area_code,state,json_module,create_staff,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss') create_time,interface_param_json,interface_type from ord_mod_define
        </query>      
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.RuleAttrDefinePo" type="jdbc">
        <query name="queryRuleAttrDefineAll">
            select attr_code,attr_name,rule_code,province_code,area_code,attr_desc,attr_type,is_golbal_attr,default_value,get_type,get_method from rule_attr_define
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.RuleDefinePo" type="jdbc">
        <query name="queryRuleDefineAll">
            select rule_code,type_code,rule_name,province_code,area_code,state,rule_desc,get_type,get_method,create_staff,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss') create_time from rule_define
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.RuleInstancePo" type="jdbc">
        <query name="queryRuleInstanceAll">
            select id,rule_code,province_code,area_code,target_value,get_method,target_desc,cond_value_1,cond_value_2,cond_value_3,cond_value_4,cond_value_5,cond_value_6,cond_value_7,cond_value_8,cond_value_9,cond_value_10 from rule_instance
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uoccode.po.RuleTypePo" type="jdbc">
        <query name="queryRuleTypeAll">
            select type_code,type_name,province_code,area_code,type_desc,create_staff,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss') create_time from rule_type
        </query>
    </service>
     
    <service data="com.tydic.unicom.uoc.base.uoccode.po.OrdModAttrCheckRulePo" type="jdbc">        
        <create>
           insert into ord_attr_check_rule (id,attr_code,mod_code,mod_check_method,mod_check_desc) 
           values (#{id},#{attr_code},#{mod_code},#{mod_check_method},#{mod_check_desc}) 
        </create>
        <delete>
            delete from ord_attr_check_rule where id=#{id}
        </delete>      
        <update>
            update ord_attr_check_rule set id=#{id},attr_code=#{attr_code},mod_code=#{mod_code},mod_check_method=#{mod_check_method},mod_check_desc=#{mod_check_desc}
             where id=#{id}
        </update>
        <query name="queryOrdModAttrCheckRuleList">
            select id,attr_code,mod_code,mod_check_method,mod_check_desc from ord_attr_check_rule where 1=1                      
            <if test="filter.attr_code != null and filter.attr_code != ''">
                and attr_code=#{filter.attr_code} 
        	</if>
        	<if test="filter.mod_code != null and filter.mod_code != ''">
                 and mod_code=#{filter.mod_code}
        	</if>
            limit ${filter.offset},${filter.limit}
        </query> 
         <query name="queryOrdModAttrCheckRuleListCount">
            select id,attr_code,mod_code,mod_check_method,mod_check_desc from ord_attr_check_rule where 1=1 
            <if test="filter.attr_code != null and filter.attr_code != ''">
                and attr_code=#{filter.attr_code} 
        	</if>
        	<if test="filter.mod_code != null and filter.mod_code != ''">
                 and mod_code=#{filter.mod_code}
        	</if>        
        </query> 
        <query name="queryOrdModAttrCheckRuleAll">
            select id,attr_code,mod_code,mod_check_method,mod_check_desc from ord_attr_check_rule
        </query>     
    </service>
    <service data="com.tydic.unicom.uoc.base.uoccode.po.OrdModParaFieldRelationPo" type="jdbc">        
        <create>
           insert into ord_para_field_relation (id,attr_code,mod_code,table_name,field_name) 
           values (#{id},#{attr_code},#{mod_code},#{table_name},#{field_name}) 
        </create>
        <delete>
            delete from ord_para_field_relation where id=#{id}
        </delete>      
        <update>
            update ord_para_field_relation set id=#{id},attr_code=#{attr_code},mod_code=#{mod_code},table_name=#{table_name},field_name=#{field_name}
             where id=#{id}
        </update>
        <query name="queryOrdModParaFieldRelationList">
            select id,attr_code,mod_code,table_name,field_name from ord_para_field_relation where 1=1              
            <if test="filter.attr_code != null and filter.attr_code != ''">
                and attr_code=#{filter.attr_code}
        	</if>
        	<if test="filter.table_name != null and filter.table_name != ''">
               and table_name=#{filter.table_name}
        	</if>
        	<if test="filter.field_name != null and filter.field_name != ''">
                and field_name=#{filter.field_name} 
        	</if>
            limit ${filter.offset},${filter.limit}			           
        </query> 
        <query name="queryOrdModParaFieldRelationListCount">
             select id,attr_code,mod_code,table_name,field_name from ord_para_field_relation where 1=1 
			 <if test="filter.attr_code != null and filter.attr_code != ''">
                and attr_code=#{filter.attr_code}
        	</if>
        	<if test="filter.table_name != null and filter.table_name != ''">
               and table_name=#{filter.table_name}
        	</if>
        	<if test="filter.field_name != null and filter.field_name != ''">
                and field_name=#{filter.field_name} 
        	</if>
        </query>
        <query name="queryOrdModParaFieldRelationAll">
            select id,attr_code,mod_code,table_name,field_name from ord_para_field_relation
        </query>       
    </service>
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoOfrOrderPo" type="jdbc">
        <get>
            select ofr_order_no,sale_order_no,province_code,area_code,part_month,ofr_id,ofr_name,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name from info_ofr_order where ofr_order_no =#{ofr_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </get>
        <query name="queryInfoOfrOrderBySaleOrderNo">
            select ofr_order_no,sale_order_no,province_code,area_code,part_month,ofr_id,ofr_name,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name from info_ofr_order where sale_order_no =#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>
        <create>
            insert into info_ofr_order(ofr_order_no,sale_order_no,province_code,area_code,part_month,ofr_id,ofr_name,cancle_flag,order_state,create_time,finish_time,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name)
  			values(#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{ofr_id},#{ofr_name},#{cancle_flag},#{order_state},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{ord_mod_code},#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name})
        </create>
        <update>
            update info_ofr_order set ofr_order_no=#{ofr_order_no},sale_order_no=#{sale_order_no},province_code=#{province_code},area_code=#{area_code},part_month=#{part_month},ofr_id=#{ofr_id},
            ofr_name=#{ofr_name},cancle_flag=#{cancle_flag},order_state=#{order_state},create_time=all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),finish_time=all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),ord_mod_code=#{ord_mod_code}
            where ofr_order_no =#{ofr_order_no}  and part_month=#{part_month} and area_code=#{area_code}
        </update>
         <delete name="deleteInfoOfrOrderBySaleOrderNo">
            delete from info_ofr_order where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>  
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoDeliverOrderPo" type="jdbc">
         <get>
            select deliver_order_no,sale_order_no,province_code,area_code,part_month,deliver_state,all_to_str(deliver_time,'yyyy-mm-dd hh:mm:ss')deliver_time,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,logistics_no,send_target_addr,goods_name,note,send_name,real_phone,send_addr,contact_name,contact_tel,post_province,post_city,post_area,address,post_province_name,post_city_name,post_area_name,cod_charge,insure_charge,return_tracking_no,send_origin_addr,delivery_region,delivery_dept_no,cod_bank_no from info_deliver_order where deliver_order_no =#{deliver_order_no}  and part_month=#{part_month} and area_code=#{area_code}
        </get>
        <query name="queryInfoDeliverOrderBySaleOrderNo">
            select deliver_order_no,sale_order_no,province_code,area_code,part_month,deliver_state,all_to_str(deliver_time,'yyyy-mm-dd hh:mm:ss')deliver_time,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,logistics_no,send_target_addr,goods_name,note,send_name,real_phone,send_addr,contact_name,contact_tel,post_province,post_city,post_area,address,post_province_name,post_city_name,post_area_name,cod_charge,insure_charge,return_tracking_no,send_origin_addr,delivery_region,delivery_dept_no,cod_bank_no  from info_deliver_order where sale_order_no =#{filter.sale_order_no}  and part_month=#{filter.part_month} and area_code=#{filter.area_code} order by create_time desc
        </query>
        <query name="queryInfoDeliverOrderAll">
			select deliver_order_no,sale_order_no,province_code,area_code,part_month,deliver_state,all_to_str(deliver_time,'yyyy-mm-dd hh:mm:ss')deliver_time,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,logistics_no,send_target_addr,goods_name,note,send_name,real_phone,send_addr,contact_name,contact_tel,post_province,post_city,post_area,address,post_province_name,post_city_name,post_area_name,cod_charge,insure_charge,return_tracking_no,send_origin_addr,delivery_region,delivery_dept_no,cod_bank_no  from info_deliver_order
             where 1=1 and finish_time&lt;all_to_date('${filter.finish_time}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.create_time}','yyyy-mm-dd hh:mm:ss') and area_code='${filter.area_code}' and part_month='${filter.part_month}'     
        </query>
        <update>
            update info_deliver_order set deliver_order_no=#{deliver_order_no},sale_order_no=#{sale_order_no},province_code=#{province_code},area_code=#{area_code},part_month=#{part_month},
            deliver_state=#{deliver_state},deliver_time=all_to_date(#{deliver_time},'yyyy-mm-dd hh:mm:ss'),logistics_no=#{logistics_no},send_target_addr=#{send_target_addr},create_time=all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),finish_time=all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),proc_inst_id=#{proc_inst_id},ord_mod_code=#{ord_mod_code},
            accept_oper_no=#{accept_oper_no},accept_oper_name=#{accept_oper_name},accept_depart_no=#{accept_depart_no},accept_depart_name=#{accept_depart_name},goods_name=#{goods_name},note=#{note},send_name=#{send_name},real_phone=#{real_phone},send_addr=#{send_addr},
            contact_name=#{contact_name},contact_tel=#{contact_tel},post_province=#{post_province},post_city=#{post_city},post_area=#{post_area},address=#{address},post_province_name=#{post_province_name},post_city_name=#{post_city_name},post_area_name=#{post_area_name},cod_charge=#{cod_charge},insure_charge=#{insure_charge},return_tracking_no=#{return_tracking_no},send_origin_addr=#{send_origin_addr},delivery_region=#{delivery_region},delivery_dept_no=#{delivery_dept_no},cod_bank_no=#{cod_bank_no}
             where deliver_order_no =#{deliver_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </update>
         <delete>
            delete from info_deliver_order where deliver_order_no=#{deliver_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </delete>
        <create>
            insert into info_deliver_order (deliver_order_no,sale_order_no,province_code,area_code,part_month,deliver_state,deliver_time,logistics_no,send_target_addr,create_time,finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,goods_name,note,send_name,real_phone,send_addr,contact_name,contact_tel,post_province,post_city,post_area,address,post_province_name,post_city_name,post_area_name,cod_charge,insure_charge,return_tracking_no,send_origin_addr,delivery_region,delivery_dept_no,cod_bank_no) 
            values(#{deliver_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{deliver_state},all_to_date(#{deliver_time},'yyyy-mm-dd hh:mm:ss'),#{logistics_no},#{send_target_addr},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{proc_inst_id},#{ord_mod_code},#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name},#{goods_name},#{note},#{send_name},#{real_phone},#{send_addr},
                   #{contact_name},#{contact_tel},#{post_province},#{post_city},#{post_area},#{address},#{post_province_name},#{post_city_name},#{post_area_name},#{cod_charge},#{insure_charge},#{return_tracking_no},#{send_origin_addr},#{delivery_region},#{delivery_dept_no},#{cod_bank_no})
        </create>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoPayOrderPo" type="jdbc">
         <get>
            select pay_order_no,rela_order_no,rela_order_type,province_code,area_code,part_month,pay_fee,pay_type,pay_state,real_pay_sn,all_to_str(pay_time,'yyyy-mm-dd hh:mm:ss')pay_time,pay_system_code,pay_system_name,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name  from info_pay_order where pay_order_no =#{pay_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </get>
        <query name="queryInfoPayOrderByRelaOrderNo">
            select pay_order_no,rela_order_no,rela_order_type,province_code,area_code,part_month,pay_fee,pay_type,pay_state,real_pay_sn,all_to_str(pay_time,'yyyy-mm-dd hh:mm:ss')pay_time,pay_system_code,pay_system_name,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name from info_pay_order where rela_order_no =#{filter.rela_order_no} and rela_order_type =#{filter.rela_order_type} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>
        <update>
            update info_pay_order  set pay_order_no =#{pay_order_no},rela_order_no=#{rela_order_no},rela_order_type=#{rela_order_type},province_code=#{province_code},area_code=#{area_code},part_month=#{part_month},
            pay_fee=#{pay_fee},pay_state=#{pay_state},real_pay_sn=#{real_pay_sn},pay_time=all_to_date(#{pay_time},'yyyy-mm-dd hh:mm:ss'),pay_system_code=#{pay_system_code},pay_system_name=#{pay_system_name},create_time=all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),finish_time=all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),proc_inst_id=#{proc_inst_id},ord_mod_code=#{ord_mod_code} 
            where pay_order_no =#{pay_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </update>
        <create>
             insert into info_pay_order(pay_order_no,rela_order_no,rela_order_type,province_code,area_code,part_month,pay_fee,pay_type,pay_state,real_pay_sn,pay_time,pay_system_code,pay_system_name,create_time,finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name)
             values(#{pay_order_no},#{rela_order_no},#{rela_order_type},#{province_code},#{area_code},#{part_month},#{pay_fee},#{pay_type},#{pay_state},#{real_pay_sn},all_to_date(#{pay_time},'yyyy-mm-dd hh:mm:ss'),#{pay_system_code},#{pay_system_name},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{proc_inst_id},#{ord_mod_code},#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name})
        </create>
        <delete>
            delete from info_pay_order where pay_order_no=#{filter.pay_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>
        <query name="queryInfoPayOrderByPayType">
  			select pay_order_no,rela_order_no,rela_order_type,province_code,area_code,part_month,pay_fee,pay_type,pay_state,real_pay_sn,all_to_str(pay_time,'yyyy-mm-dd hh:mm:ss')pay_time,pay_system_code,pay_system_name,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name from info_pay_order  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.province_code != null and filter.province_code != ''">
          			and province_code ='${filter.province_code}'
         	</if>  
         	<if test="filter.pay_type != null and filter.pay_type != ''">
          			and pay_type ='${filter.pay_type}' 
         	</if>   
         	<if test="filter.rela_order_type != null and filter.rela_order_type != ''">
          			and rela_order_type ='${filter.rela_order_type}' 
         	</if>    
		</query> 
    </service>
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderSimCardPo" type="jdbc">        
        <!-- <query name="queryInfoServiceOrderSimCardByOfrOrderNo">
            select * from info_serv_sim_card where  ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query> -->
         <query name="queryInfoServiceOrderSimCardByOrderNo">
           select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,sim_id,imsi,card_type,card_fee,card_data,card_data_proc_id,ext_field_1,ext_field_2,ext_field_3,ext_field_4
 			from info_serv_sim_card where 1=1  and   part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>  
        </query>
        <query name="queryInfoServiceOrderSimCardAllSimId">
           select b.sim_id,a.serv_order_no,a.sale_order_no,a.acc_nbr as ext_field_1 from info_service_order a,info_serv_sim_card b
			 where 1=1 and a.serv_order_no = b.serv_order_no and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}
			   and b.area_code=#{filter.area_code} and b.part_month = #{filter.part_month}
			<if test="filter.sim_id != null and filter.sim_id != ''">
				and substr(b.sim_id,length(sim_id) - (length(#{filter.sim_id}) - 1) + 1, (length(#{filter.sim_id}) - 1)) = substr(#{filter.sim_id},0,length(#{filter.sim_id}) - 1)
			</if>
			<if test="filter.acc_nbr != null and filter.acc_nbr != ''">
				and a.acc_nbr='${filter.acc_nbr}'
			</if>
			<if test="filter.contact_tel !=null and filter.contact_tel != ''">
			    and EXISTS (select d.sale_order_no from info_deliver_order d where d.contact_tel='${filter.contact_tel}' and d.part_month=#{filter.part_month} and d.area_code=#{filter.area_code} and d.sale_order_no=a.sale_order_no )
			</if>
        </query> 
        <delete name="deleteInfoServiceOrderSimCardBySaleOrderNo">
            delete from info_serv_sim_card where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>                
    </service>
     <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderPersionPo" type="jdbc">        
        <!-- <query name="queryInfoServiceOrderPersionByOfrOrderNo">
            select * from info_serv_person where  ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query> -->  
        <query name="queryInfoServiceOrderPersionByOrderNo">
            select serv_order_no,ofr_order_no ,sale_order_no ,province_code ,area_code ,part_month ,cust_id ,cust_name ,new_flag ,cust_phone ,email ,cust_address ,sex ,cust_type ,cert_type ,cert_no ,cert_address ,cert_expire_date ,cert_link1 ,cert_link2 ,cert_link3
 			 from info_serv_person where  1=1 and part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>
         	 <if test= "filter.ofr_order_no != null and filter.ofr_order_no != ''" >
                           and ofr_order_no ='${filter.ofr_order_no}'
             </if>         	
        </query> 
        <delete name="deleteInfoServiceOrderPersionBySaleOrderNo">
            delete from info_serv_person where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>              
    </service>
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderProdMapPo" type="jdbc">        
        <!-- <query name="queryInfoServiceOrderProdMapByOfrOrderNo">
            select * from info_serv_prod_map where  ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query> -->   
       <query name="queryInfoServiceOrderProdMapByOrderNo">
            select a.serv_order_no,a.ofr_order_no,a.sale_order_no,a.province_code,a.area_code,a.part_month,a.prod_code,a.prod_name,a.first_month_rent,a.roam_level,a.call_level,a.ext_field_1,a.ext_field_2
 			 from info_serv_prod_map a where  1=1 and part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>
         	 <if test= "filter.ofr_order_no != null and filter.ofr_order_no != ''" >
                   and ofr_order_no ='${filter.ofr_order_no}'
             </if>  
        </query>
        <query name="queryInfoServiceOrderProdMapByProdCode">
  		select serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,prod_code,prod_name,first_month_rent,roam_level,call_level,ext_field_1,ext_field_2
 		 from info_serv_prod_map  where 1=1 and area_code=#{filter.area_code}            
            <if test="filter.part_month != null and filter.part_month != ''">
          			and part_month ='${filter.part_month}'
         	</if> 
            <if test="filter.province_code != null and filter.province_code != ''">
          			and province_code ='${filter.province_code}'
         	</if>  
         	<if test="filter.prod_code != null and filter.prod_code != ''">
          			and prod_code ='${filter.prod_code}' 
         	</if>
		</query> 
        <delete name="deleteInfoServiceOrderProdMapBySaleOrderNo">
            delete from info_serv_prod_map where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
     <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderActivityPo" type="jdbc">        
       <!--  <query name="queryInfoServiceOrderActivityByOfrOrderNo">
            select * from info_serv_activity where  ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query> -->
         <query name="queryInfoServiceOrderActivityByServOrderNo">
           select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,activity_id,activity_name,ext_field_1,ext_field_2
             from info_serv_activity where  serv_order_no=#{filter.serv_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>
         <query name="queryInfoServiceOrderActivityByOrderNo">
           select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,activity_id,activity_name,ext_field_1,ext_field_2
			from info_serv_activity where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>  
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>
        </query> 
        <delete name="deleteInfoServiceOrderActivityBySaleOrderNo">
            delete from info_serv_activity where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>             
    </service>
    
    
      <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoOfrOrderInvoicePo" type="jdbc">        
        <query name="queryInfoOfrOrderInvoiceByOrderNo">
            select * from info_ofr_invoice where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>  
        </query> 
        <delete name="deleteInfoOfrOrderInvoiceBySaleOrderNo">
            delete from info_ofr_invoice where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
      <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoOfrOrderPayPo" type="jdbc">        
        <query name="queryInfoOfrOrderPayByOrderNo">
            select * from info_ofr_pay where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>  
        </query> 
        <delete name="deleteInfoOfrOrderPayBySaleOrderNo">
            delete from info_ofr_pay where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
      <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoOfrOrderFeePo" type="jdbc">        
        <query name="queryInfoOfrOrderFeeByOrderNo">
            select * from info_ofr_fee where  1=1 and part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>  
        </query> 
        <delete name="deleteInfoOfrOrderFeeBySaleOrderNo">
            delete from info_ofr_fee where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
      <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderPayPo" type="jdbc">        
        <query name="queryInfoServiceOrderPayByOrderNo">
            select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,pay_type,total_fee,discount_fee,payed_fee,pay_sn,pay_oper_no,pay_oper_name
 			 from info_serv_pay where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>  
        </query> 
       <!--  <query name="queryInfoServiceOrderPayByOfrOrderNo">
            select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,pay_type,total_fee,discount_fee,payed_fee,pay_sn,pay_oper_no,pay_oper_name
 			 from info_serv_pay where  ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query> -->
        <delete name="deleteInfoServiceOrderPayBySaleOrderNo">
            delete from info_serv_pay where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
      
      <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderTerminalPo" type="jdbc">        
        <query name="queryInfoServiceOrderTerminalByOrderNo">
            select id ,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,terminal_code ,terminal_name ,terminal_type ,terminal_type_name ,cost_price ,sale_price ,terminal_brand ,terminal_color ,ext_field_1 ,ext_field_2 from info_serv_terminal where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if> 
        </query>
        <!-- <query name="queryInfoServiceOrderTerminalByOfrOrderNo">
            select * from info_serv_terminal where  ofr_order_no=#{filter.ofr_order_no} and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query> --> 
        <delete name="deleteInfoServiceOrderTerminalBySaleOrderNo">
            delete from info_serv_terminal where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
      <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderAgreementPo" type="jdbc">        
        <query name="queryInfoServiceOrderAgreementByOrderNo">
           select serv_order_no,ofr_order_no,sale_order_no,agreement_id,province_code,area_code,part_month,limit_type,limit_months,end_method,guarant_type,ext_field_1,ext_field_2           
            from info_serv_agreement where  1=1 and part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>  
        </query>
        <!-- <query name="queryInfoServiceOrderAgreementByOfrOrderNo">
            select * from  where info_serv_agreement ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>  -->
        <query name="queryInfoServiceOrderAgreementByServOrderNo">
            select serv_order_no,ofr_order_no,sale_order_no,agreement_id,province_code,area_code,part_month,limit_type,limit_months,end_method,guarant_type,ext_field_1,ext_field_2
			from  where info_serv_agreement serv_order_no=#{filter.serv_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>
        <delete name="deleteInfoServiceOrderAgreementBySaleOrderNo">
            delete from info_serv_agreement where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
      <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderPackagePo" type="jdbc">        
        <query name="queryInfoServiceOrderPackageByOrderNo">
           select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,pack_code,pack_name,all_to_str(begin_time,'yyyy-mm-dd hh:mm:ss')begin_time,all_to_str(end_time,'yyyy-mm-dd hh:mm:ss')end_time,ext_field_1,ext_field_2            
            from info_serv_pkg where  1=1 and part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>  
        </query> 
        <!--  <query name="queryInfoServiceOrderPackageByOfrOrderNo">
            select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,pack_code,pack_name,all_to_str(begin_time,'yyyy-mm-dd hh:mm:ss')begin_time,all_to_str(end_time,'yyyy-mm-dd hh:mm:ss')end_time,ext_field_1,ext_field_2
			 from info_serv_pkg where  ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}             
        </query> --> 
        <delete name="deleteInfoServiceOrderPackageBySaleOrderNo">
            delete from info_serv_pkg where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
       <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderFixPo" type="jdbc">        
        <query name="queryInfoServiceOrderFixByOrderNo">
			select
				info_serv_fix.serv_order_no,
				info_serv_fix.ofr_order_no,
				info_serv_fix.sale_order_no,
				info_serv_fix.province_code,
				info_serv_fix.area_code,
				info_serv_fix.part_month,
				info_serv_fix.acc_nbr,
				info_serv_fix.machine_nbr,
				info_serv_fix.stardand_addr_id,
				info_serv_fix.install_address,
				info_serv_fix.nbr_area_code,
				info_serv_fix.ext_field_1,
				info_serv_fix.ext_field_2
			from
				info_serv_fix 
			where  
				1=1 and part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no=#{filter.ofr_order_no} 
         	</if> 
        </query>
        <!-- <query name="queryInfoServiceOrderFixByOfrOrderNo">
            select * from info_serv_fix where  ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>  --> 
        <delete name="deleteInfoServiceOrderFixBySaleOrderNo">
            delete from info_serv_fix where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
        <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderM165Po" type="jdbc">        
        <query name="queryInfoServiceOrderM165ByOrderNo">
		  select
				info_serv_m165.serv_order_no,
				info_serv_m165.ofr_order_no,
				info_serv_m165.sale_order_no,
				info_serv_m165.province_code,
				info_serv_m165.area_code,
				info_serv_m165.part_month,
				info_serv_m165.acc_nbr,
				info_serv_m165.passwd,
				info_serv_m165.line_nbr,
				info_serv_m165.stardand_addr_id,
				info_serv_m165.install_address,
				info_serv_m165.nbr_area_code,
				info_serv_m165.accept_type,
				info_serv_m165.speed,
				info_serv_m165.ext_field_1,
				info_serv_m165.ext_field_2
			from
				info_serv_m165 
			where 
				1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>  
        </query>
         <!-- <query name="queryInfoServiceOrderM165ByOfrOrderNo">
            select * from info_serv_m165 where  ofr_order_no=#{filter.ofr_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query> -->  
        <delete name="deleteInfoServiceOrderM165BySaleOrderNo">
            delete from info_serv_m165 where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
         <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderGoodNbrPo" type="jdbc">        
        <query name="queryInfoServiceOrderGoodNbrByOrderNo">
			   select
					info_serv_good_nbr.serv_order_no,
					info_serv_good_nbr.ofr_order_no,
					info_serv_good_nbr.sale_order_no,
					info_serv_good_nbr.province_code,
					info_serv_good_nbr.area_code,
					info_serv_good_nbr.part_month,
					info_serv_good_nbr.nbr_level,
					info_serv_good_nbr.nbr_pre_save,
					info_serv_good_nbr.month_consume,
					info_serv_good_nbr.time_dur_pro,
					info_serv_good_nbr.ext_field_1,
					info_serv_good_nbr.ext_field_2
				from
					info_serv_good_nbr 
				where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if> 
        </query>
       <!--  <query name="queryInfoServiceOrderGoodNbrByOfrOrderNo">
            select * from info_serv_good_nbr where  ofr_order_no=#{filter.ofr_order_no} and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>  --> 
        <delete name="deleteInfoServiceOrderGoodNbrBySaleOrderNo">
            delete from info_serv_good_nbr where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
          <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderCollectionPo" type="jdbc">        
        <query name="queryInfoServiceOrderCollectionByOrderNo">
           select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,account_id,bank_code,bank_name,bank_account,bank_area_code,bank_area_name,collection_type,collection_sn,save_type,upper_bank_code           
            from info_serv_collection where  1=1 and part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>  
        </query>         
        <query name="queryInfoServiceOrderCollectionByServOrderNo">
            select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,account_id,bank_code,bank_name,bank_account,bank_area_code,bank_area_name,collection_type,collection_sn,save_type,upper_bank_code
			from info_serv_collection where  serv_order_no=#{filter.serv_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query> 
        <delete name="deleteInfoServiceOrderCollectionBySaleOrderNo">
            delete from info_serv_collection where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
           <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderGuarantorPo" type="jdbc">        
        <query name="queryInfoServiceOrderGuarantorByOrderNo">
			select
				info_serv_guarantor.id,
				info_serv_guarantor.serv_order_no,
				info_serv_guarantor.ofr_order_no,
				info_serv_guarantor.sale_order_no,
				info_serv_guarantor.province_code,
				info_serv_guarantor.area_code,
				info_serv_guarantor.part_month,
				info_serv_guarantor.guarant_type,
				info_serv_guarantor.guarant_project,
				info_serv_guarantor.guarant_method,
				all_to_str(info_serv_guarantor.guarant_eff_time,'yyyy-mm-dd hh:mm:ss') guarant_eff_time,
				info_serv_guarantor.guarant_depart_code,
				info_serv_guarantor.guarant_sn
			from
				info_serv_guarantor
			where 
				1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if> 
        </query>
        <!-- <query name="queryInfoServiceOrderGuarantorByOfrOrderNo">
            select * from info_serv_guarantor where  ofr_order_no=#{filter.ofr_order_no} and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </query>  --> 
        <delete name="deleteInfoServiceOrderGuarantorBySaleOrderNo">
            delete from info_serv_guarantor where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>
    
           
       <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoServiceOrderDeveloperPo" type="jdbc">        
        <query name="queryInfoServiceOrderDeveloperByOrderNo">
			select
				info_serv_developer.id,
				info_serv_developer.serv_order_no,
				info_serv_developer.ofr_order_no,
				info_serv_developer.sale_order_no,
				info_serv_developer.province_code,
				info_serv_developer.area_code,
				info_serv_developer.part_month,
				info_serv_developer.acc_nbr,
				info_serv_developer.developer_code,
				info_serv_developer.developer_name,
				info_serv_developer.develop_depart_id,
				info_serv_developer.develop_depart_name,
				info_serv_developer.develop_type,
				info_serv_developer.develop_target_code,
				all_to_str(info_serv_developer.develop_time, 'yyyy-mm-dd hh:mm:ss') develop_time
			from
				info_serv_developer
			where 
				 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if> 
        </query>		
        <query name="queryInfoServiceOrderDeveloperByServOrderNo">
           select
				info_serv_developer.id,
				info_serv_developer.serv_order_no,
				info_serv_developer.ofr_order_no,
				info_serv_developer.sale_order_no,
				info_serv_developer.province_code,
				info_serv_developer.area_code,
				info_serv_developer.part_month,
				info_serv_developer.acc_nbr,
				info_serv_developer.developer_code,
				info_serv_developer.developer_name,
				info_serv_developer.develop_depart_id,
				info_serv_developer.develop_depart_name,
				info_serv_developer.develop_type,
				info_serv_developer.develop_target_code,
				all_to_str(info_serv_developer.develop_time) develop_time
			from
				info_serv_developer 
			where  
			    serv_order_no=#{filter.serv_order_no} and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
        </query> 
        <delete name="deleteInfoServiceOrderDeveloperBySaleOrderNo">
            delete from info_serv_developer where sale_order_no=#{filter.sale_order_no} and part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete>        
    </service>

       
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSaleOrderFeePo" type="jdbc">  
         <get>
             select a.sale_order_no,
				       a.province_code,
				       a.area_code,
				       a.part_month,
				       a.total_fee,
				       a.discount_fee,
				       a.payed_fee,
				       a.pay_flag,
				       all_to_str(a.pay_time,'yyyy-mm-dd hh:mm:ss')pay_time,
				       all_to_str(a.create_time,'yyyy-mm-dd hh:mm:ss')create_time
             from info_sale_fee a where sale_order_no =#{sale_order_no}  and part_month=#{part_month} and area_code=#{area_code}
        </get>  
        <query name="queryInfoSaleOrderFeeByPayOrder">
			select a.sale_order_no,
				       a.province_code,
				       a.area_code,
				       a.part_month,
				       a.total_fee,
				       a.discount_fee,
				       a.payed_fee,
				       a.pay_flag,
				       all_to_str(a.pay_time,'yyyy-mm-dd hh:mm:ss')pay_time,
				       all_to_str(a.create_time,'yyyy-mm-dd hh:mm:ss')create_time
             from info_sale_fee a where 1=1
			and part_month=${filter.part_month}
			and area_code=#{filter.area_code}
			and sale_order_no =
			(select rela_order_no from info_pay_order where 1=1
			and part_month=${filter.part_month}
			and area_code=#{filter.area_code}
			and rela_order_no=#{filter.sale_order_no}
			and rela_order_type=${filter.rela_order_type})
        </query>             
        <delete>
            delete from info_sale_fee where sale_order_no=#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}
        </delete>     
        <create>
            insert into info_sale_fee(sale_order_no,province_code,area_code,part_month,total_fee,discount_fee,payed_fee,pay_flag,pay_time,create_time)
            values(#{sale_order_no},#{province_code},#{area_code},#{part_month},#{total_fee},#{discount_fee},#{payed_fee},#{pay_flag},all_to_date(#{pay_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'))
        </create>   
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uocinst.po.ProcInstTaskDealRecordPo" type="jdbc">  
        <query name="queryProcInstTaskDealRecordByOrderNo">
            select id,task_id,province_code,area_code,part_month,all_to_str(deal_time,'yyyy-mm-dd hh:mm:ss')deal_time,deal_oper_no,deal_system_no,deal_code,deal_desc,order_no,order_type,tache_code,oper_code,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,prod_code from task_deal_record where order_no=#{filter.order_no}  and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
        	<if test="filter.order_type != null and filter.order_type != ''">
          			and order_type ='${filter.order_type}'
         	</if>
         	<if test="filter.tache_code != null and filter.tache_code != ''">
          			and tache_code ='${filter.tache_code}'
         	</if>
         	<if test="filter.oper_code != null and filter.oper_code != ''">
          			and oper_code ='${filter.oper_code}'
         	</if>
         	order by deal_time desc
        </query>
        <delete name="deleteProcInstTaskDealRecordByOrderNo">
            delete from task_deal_record where order_no=#{filter.order_no}  and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
        </delete> 
         <create>
  		    insert into task_deal_record(id,task_id,province_code,area_code,part_month,deal_time,deal_oper_no,deal_system_no,deal_code,deal_desc,order_no,order_type,tache_code,oper_code,create_time,prod_code)
  			values(#{id},#{task_id},#{province_code},#{area_code},#{part_month},all_to_date(#{deal_time},'yyyy-mm-dd hh:mm:ss'),#{deal_oper_no},#{deal_system_no},#{deal_code},#{deal_desc},#{order_no},#{order_type},#{tache_code},#{oper_code},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),#{prod_code})
  		</create>       
    </service>
    
      <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderHisPo" type="jdbc">  
        <create>
  		    insert into info_sale_order_h(sale_order_no,province_code,area_code,part_month,accept_time,order_type,accept_no,accept_type,accept_system,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,pay_flag,pay_type,express_flag,cancle_flag,order_state,create_time,finish_time,ord_mod_code,proc_inst_id,pre_proc_inst_id,accept_depart_type,callback_url)
  			values(#{sale_order_no},#{province_code},#{area_code},#{part_month},all_to_date(#{accept_time},'yyyy-mm-dd hh:mm:ss'),#{order_type},#{accept_no},#{accept_type},#{accept_system},#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name},#{pay_flag},#{pay_type},#{express_flag},#{cancle_flag},#{order_state},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{ord_mod_code},#{proc_inst_id},#{pre_proc_inst_id},#{accept_depart_type},#{callback_url})
  		</create>
  		<query name="queryInfoSaleOrderHisBySaleOrderNo">
  			select sale_order_no,province_code,area_code,part_month,all_to_str(accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,order_type,accept_no,accept_type,accept_system,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,pay_flag,pay_type,express_flag,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,proc_inst_id,pre_proc_inst_id,accept_depart_type,callback_url  from info_sale_order_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>     
		</query>
		<query name="queryInfoSaleOrderHis">
            select sale_order_no,province_code,area_code,part_month,all_to_str(accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,order_type,accept_no,accept_type,accept_system,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,pay_flag,pay_type,express_flag,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,proc_inst_id,pre_proc_inst_id,accept_depart_type,callback_url  from info_sale_order_h where 1=1 and accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss')  and accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss') and area_code=#{filter.area_code} and part_month=#{filter.part_month} and province_code=#{filter.province_code}  and accept_depart_no=#{filter.accept_depart_no}
       	   <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
            <if test="filter.accept_no != null and filter.accept_no != ''">
                and accept_no = '${filter.accept_no}'
            </if>
            <if test="filter.accept_system != null and filter.accept_system != ''">
                and accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.order_state != null and filter.order_state != ''">
                and order_state = '${filter.order_state}'
            </if>
             <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
                and sale_order_no = '${filter.sale_order_no}'
            </if>
        </query>
        <query name="queryInfoSaleOrderPoHisList">
            select distinct sale_order_no,province_code,area_code,part_month,all_to_str(accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,order_type,accept_no,accept_type,accept_system,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,pay_flag,pay_type,express_flag,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,proc_inst_id,pre_proc_inst_id,accept_depart_type,callback_url  from info_sale_order_h where 1=1 and accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss')  and accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss') and area_code=#{filter.area_code} and part_month=#{filter.part_month} and province_code=#{filter.province_code}  and accept_depart_no=#{filter.accept_depart_no}
       	    <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
            <if test="filter.accept_no != null and filter.accept_no != ''">
                and accept_no = '${filter.accept_no}'
            </if>
            <if test="filter.accept_system != null and filter.accept_system != ''">
                and accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.order_state != null and filter.order_state != ''">
                and order_state = '${filter.order_state}'
            </if>
             <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
                and sale_order_no = '${filter.sale_order_no}'
            </if>
            limit ${filter.offset},${filter.limit}
        </query>
    </service>
    
       <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderFeeHisPo" type="jdbc">  
        <create>
  		    insert into info_sale_fee_h(sale_order_no,province_code,area_code,part_month,total_fee,discount_fee,payed_fee,pay_flag,pay_time,create_time)
  			values(#{sale_order_no},#{province_code},#{area_code},#{part_month},#{total_fee},#{discount_fee},#{payed_fee},#{pay_flag},all_to_date(#{pay_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'))
  		</create>
  		<query name="queryInfoSaleOrderFeeHisBySaleOrderNo">
  			select  sale_order_no,province_code,area_code,part_month,total_fee,discount_fee,payed_fee,pay_flag,all_to_str(pay_time,'yyyy-mm-dd hh:mm:ss')pay_time,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time  from info_sale_fee_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>     
		</query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderEditHisPo" type="jdbc">  
        <create>
  		    insert into info_sale_edit_h(id,sale_order_no,province_code,area_code,part_month,edit_type,state,edit_system,oper_no,edit_time,edit_desc,is_compress,json_url,json_content)
  			values(#{id},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{edit_type},#{state},#{edit_system},#{oper_no},all_to_date(#{edit_time},'yyyy-mm-dd hh:mm:ss'),#{edit_desc},#{is_compress},#{json_url},#{json_content})
  		</create>
  		<query name="queryInfoSaleOrderEditHisByOrderNo">
  			select id,sale_order_no,province_code,area_code,part_month,edit_type,state,edit_system,oper_no,all_to_str(edit_time,'yyyy-mm-dd hh:mm:ss')edit_time,edit_desc,is_compress,json_url,json_content  from info_sale_edit_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>     
		</query>
    </service>
    
     
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderAttrHisPo" type="jdbc">  
        <create>
  		    insert into info_sale_attr_h(id,sale_order_no,province_code,area_code,part_month,attr_code,attr_type,attr_after_value,attr_before_value)
  			values(#{id},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{attr_code},#{attr_type},#{attr_after_value},#{attr_before_value})
  		</create>
  		<query name="queryInfoSaleOrderAttrHisByOrderNo">
  			select * from info_sale_attr_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderPersionHisPo" type="jdbc">  
        <create>
  		    insert into info_sale_person_h(sale_order_no,province_code,area_code,part_month,cust_id,cust_name,new_flag,cust_phone,email,cust_address,sex,cust_type,cert_type,cert_no,cert_address,cert_expire_date,cert_link1,cert_link2,cert_link3)
  			values(#{sale_order_no},#{province_code},#{area_code},#{part_month},#{cust_id},#{cust_name},#{new_flag},#{cust_phone},#{email},#{cust_address},#{sex},#{cust_type},#{cert_type},#{cert_no},#{cert_address},#{cert_expire_date},#{cert_link1},#{cert_link2},#{cert_link3})
  		</create>
  		<query name="queryInfoSaleOrderPersionHisBySaleOrderNo">
  			select * from info_sale_person_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>    
		</query>
    </service>
    
      <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderPersionCertHisPo" type="jdbc">  
        <create>
             insert into info_sale_person_cert_h(sale_order_no,province_code,area_code,part_month,cert_face_url,cert_back_url,cert_hand_url,cert_video_url,audit_result,simil_rate,note,pic_person_url,pic_guardian_url,pic_from_person_url,pic_from_guardian_url) 
             values(#{sale_order_no},#{province_code},#{area_code},#{part_month},#{cert_face_url},#{cert_back_url},#{cert_hand_url},#{cert_video_url},#{audit_result},#{simil_rate},#{note},#{pic_person_url},#{pic_guardian_url},#{pic_from_person_url},#{pic_from_guardian_url})
        </create>
  		<get>
  			select sale_order_no,province_code,area_code,part_month,cert_face_url,cert_back_url,cert_hand_url,cert_video_url,audit_result,simil_rate,note,pic_person_url,pic_guardian_url,pic_from_person_url,pic_from_guardian_url          
            from info_sale_person_cert_h where  sale_order_no =#{sale_order_no} and part_month=#{part_month} and area_code=#{area_code}            
		</get>
    </service>
     
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderDistributionHisPo" type="jdbc">  
        <create>
  		    insert into info_sale_distr_h(sale_order_no,province_code,area_code,part_month,logistics_type,contact_name,contact_tel,post_province,post_city,post_area,address,post_code,distribution_begin_time,distribution_end_time,self_chl_id,self_chl_name,pay_type)
  			values(#{sale_order_no},#{province_code},#{area_code},#{part_month},#{logistics_type},#{contact_name},#{contact_tel},#{post_province},#{post_city},#{post_area},#{address},#{post_code},#{distribution_begin_time},#{distribution_end_time},#{self_chl_id},#{self_chl_name},#{pay_type})
  		</create>
  		<query name="queryInfoSaleOrderDistributionHisByOrderNo">
  			select * from info_sale_distr_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>    
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderDistrDetailHisPo" type="jdbc">  
        <create>
  		    insert into info_sale_distr_detail_h(id,sale_order_no,province_code,area_code,part_month,article_code,article_imsi,article_name,article_num,article_desc)
  			values(#{id},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{article_code},#{article_imsi},#{article_name},#{article_num},#{article_desc})
  		</create>
  		<query name="queryInfoSaleOrderDistrDetailHisByOrderNo">
  			select * from info_sale_distr_detail_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderOfrMapHisPo" type="jdbc">  
        <create>
  		    insert into info_sale_ofr_map_h(id,sale_order_no,province_code,area_code,part_month,ofr_id,ofr_name,acc_nbr,ext_field_1,ext_field_3,ext_field_4,ext_field_5,ext_field_2)
  			values(#{id},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{ofr_id},#{ofr_name},#{acc_nbr},#{ext_field_1},#{ext_field_3},#{ext_field_4},#{ext_field_5},#{ext_field_2})
  		</create>
  		<query name="queryInfoSaleOrderOfrMapHisBySaleOrderNo">
  			select * from info_sale_ofr_map_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>     
		</query>
		
  		<query name="queryInfoSaleOrderOfrMapHisByAccNbr">
  			select * from info_sale_ofr_map_h  where  acc_nbr=#{filter.acc_nbr}  and  part_month=#{filter.part_month} and area_code=#{filter.area_code}                
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderServMapHisPo" type="jdbc">  
        <create>
  		    insert into info_sale_serv_map_h(id,sale_order_no,province_code,area_code,part_month,oper_code,oper_name,acc_nbr,tele_type,ext_field_1,ext_field_3,ext_field_4,ext_field_5,ext_field_2)
  			values(#{id},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{oper_code},#{oper_name},#{acc_nbr},#{tele_type},#{ext_field_1},#{ext_field_3},#{ext_field_4},#{ext_field_5},#{ext_field_2})
  		</create>
  		<query name="queryInfoSaleOrderServMapHisBySaleOrderNo">
  			select * from info_sale_serv_map_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>     
		</query>
		<query name="queryInfoSaleOrderServMapHisByAccNbr">
  			select * from info_sale_serv_map_h  where acc_nbr=#{filter.acc_nbr}  and  part_month=#{filter.part_month} and area_code=#{filter.area_code}              
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoOfrOrderHisPo" type="jdbc">  
        <create>
  		    insert into info_ofr_order_h(ofr_order_no,sale_order_no,province_code,area_code,part_month,ofr_id,ofr_name,cancle_flag,order_state,create_time,finish_time,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name)
  			values(#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{ofr_id},#{ofr_name},#{cancle_flag},#{order_state},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{ord_mod_code},#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name})
  		</create>
  		<query name="queryInfoOfrOrderHisByOrderNo">
  			select ofr_order_no,sale_order_no,province_code,area_code,part_month,ofr_id,ofr_name,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name  from info_ofr_order_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoOfrOrderInvoiceHisPo" type="jdbc">  
        <create>
  		    insert into info_ofr_invoice_h(invoice_sn,ofr_order_no,sale_order_no,province_code,area_code,part_month,invoice_type,invoice_head,note_sn,print_fee,invoice_flag,need_invoice,send_flag,print_num)
  			values(#{invoice_sn},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{invoice_type},#{invoice_head},#{note_sn},#{print_fee},#{invoice_flag},#{need_invoice},#{send_flag},#{print_num})
  		</create>
  		<query name="queryInfoOfrOrderInvoiceHisByOrderNo">
  			select * from info_ofr_invoice_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoOfrOrderPayHisPo" type="jdbc">  
        <create>
  		    insert into info_ofr_pay_h(id,ofr_order_no,sale_order_no,province_code,area_code,part_month,fee_item_code,pay_type,pay_sn,discount_sn,pay_oper_no,pay_oper_name)
  			values(#{id},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{fee_item_code},#{pay_type},#{pay_sn},#{discount_sn},#{pay_oper_no},#{pay_oper_name})
  		</create>
  		<query name="">
  			select * from info_ofr_pay_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
	</query>
 
    </service>
    
       <service data="com.tydic.unicom.uoc.base.uochis.po.InfoOfrOrderFeeHisPo" type="jdbc">  
         <create>
  		    insert into info_ofr_fee_h(id,ofr_order_no,sale_order_no,province_code,area_code,part_month,fee_item_code,fee_item_name,total_fee,discount_fee,payed_fee)
  			values(#{id},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{fee_item_code},#{fee_item_name},#{total_fee},#{discount_fee},#{payed_fee})
  		 </create>
  		 <query name="queryInfoOfrOrderFeeHisByOrderNo">
  		     select * from  info_ofr_fee_h where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}           
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if> 
  		 </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderHisPo" type="jdbc">  
         <create>
  		    insert into info_service_order_h(serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,oper_code,oper_name,acc_nbr,cancle_flag,order_state,create_time,finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,accept_depart_type,tele_type)
  			values(#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{oper_code},#{oper_name},#{acc_nbr},#{cancle_flag},#{order_state},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{proc_inst_id},#{ord_mod_code},#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name},#{accept_depart_type},#{tele_type})
  		</create>
  		<query name="queryInfoServiceOrderHisByOrderNo">
  			select serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,oper_code,oper_name,acc_nbr,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,accept_depart_type,tele_type  from  info_service_order_h where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
		<query name="queryInfoServiceOrderHisByPo">
			select serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,oper_code,oper_name,acc_nbr,cancle_flag,order_state,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,accept_depart_type,tele_type from info_service_order_h where province_code=#{filter.province_code} and area_code=#{filter.area_code}
            <if test= "filter.oper_code != null and filter.oper_code != ''" >
                   and oper_code ='${filter.oper_code}'
            </if>
            <if test= "filter.accept_oper_no != null and filter.accept_oper_no != ''" >
                   and accept_oper_no ='${filter.accept_oper_no}'
            </if>
            <if test= "filter.accept_depart_no != null and filter.accept_depart_no != ''" >
                   and accept_depart_no ='${filter.accept_depart_no}'
            </if>
		</query>
    </service>
    
     
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderPayHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_pay_h(id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,pay_type,total_fee,discount_fee,payed_fee,pay_sn,pay_oper_no,pay_oper_name)
  			values(#{id},#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{pay_type},#{total_fee},#{discount_fee},#{payed_fee},#{pay_sn},#{pay_oper_no},#{pay_oper_name})
  		</create>
  		<query name="queryInfoServiceOrderPayHisByOrderNo">
  			select * from info_serv_pay_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderFeeHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_fee_h(id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,fee_item_code,fee_item_name,fee_item_type,total_fee,discount_fee,payed_fee,discount_sn,discount_comments)
  			values(#{id},#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{fee_item_code},#{fee_item_name},#{fee_item_type},#{total_fee},#{discount_fee},#{payed_fee},#{discount_sn},#{discount_comments})
  		</create>
  		<query name="queryInfoServiceOrderFeeHisByOrderNo">
  		select * from info_serv_fee_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
      <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderAttrHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_attr_h(id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,attr_code,attr_type,attr_after_value,attr_before_value,curr_seq,upper_seq)
  			values(#{id},#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{attr_code},#{attr_type},#{attr_after_value},#{attr_before_value},#{curr_seq},#{upper_seq})
  		</create>
  		<query name="queryInfoServiceOrderAttrHisByOrderNo">
  			select * from info_serv_attr_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderProdMapHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_prod_map_h(serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,prod_code,prod_name,first_month_rent,roam_level,call_level,ext_field_1,ext_field_2)
  			values(#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{prod_code},#{prod_name},#{first_month_rent},#{roam_level},#{call_level},#{ext_field_1},#{ext_field_2})
  		</create>
  		<query name="queryInfoServiceOrderProdMapHisByOrderNo">
  		select * from info_serv_prod_map_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
		<query name="queryInfoServiceOrderProdMapHisByProdCode">
  		select * from info_serv_prod_map_h  where 1=1 and area_code=#{filter.area_code} 
  		 	<if test="filter.part_month != null and filter.part_month != ''">
          			and part_month ='${filter.part_month}'
         	</if>           
            <if test="filter.province_code != null and filter.province_code != ''">
          			and province_code ='${filter.province_code}'
         	</if>  
         	<if test="filter.prod_code != null and filter.prod_code != ''">
          			and prod_code ='${filter.prod_code}' 
         	</if>   
		</query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderTerminalHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_terminal_h(id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,terminal_code,terminal_name,terminal_type,terminal_type_name,cost_price,sale_price,terminal_brand,terminal_color,ext_field_1,ext_field_2)
  			values(#{id},#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{terminal_code},#{terminal_name},#{terminal_type},#{terminal_type_name},#{cost_price},#{sale_price},#{terminal_brand},#{terminal_color},#{ext_field_1},#{ext_field_2})
  		</create>
  		<query name="queryInfoServiceOrderTerminalHisByOrderNo">
  		select * from  info_serv_terminal_h where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderActivityHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_activity_h(id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,activity_id,activity_name,ext_field_1,ext_field_2)
  			values(#{id},#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{activity_id},#{activity_name},#{ext_field_1},#{ext_field_2})
  		</create>
  		<query name="queryInfoServiceOrderActivityHisByOrderNo">
  			select * from info_serv_activity_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderAgreementHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_agreement_h(serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,agreement_id,limit_type,limit_months,end_method,guarant_type,ext_field_1,ext_field_2)
  			values(#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{agreement_id},#{limit_type},#{limit_months},#{end_method},#{guarant_type},#{ext_field_1},#{ext_field_2})
  		</create>
  		<query name="queryInfoServiceOrderAgreementHisByOrderNo">
  			select * from  info_serv_agreement_h where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderPackageHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_pkg_h(id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,pack_code,pack_name,begin_time,end_time,ext_field_1,ext_field_2)
  			values(#{id},#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{pack_code},#{pack_name},all_to_date(#{begin_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{end_time},'yyyy-mm-dd hh:mm:ss'),#{ext_field_1},#{ext_field_2})
  		</create>
  		<query name="queryInfoServiceOrderPackageHisByOrderNo">
  			select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,pack_code,pack_name,all_to_str(begin_time,'yyyy-mm-dd hh:mm:ss')begin_time,all_to_str(end_time,'yyyy-mm-dd hh:mm:ss')end_time,ext_field_1,ext_field_2 from info_serv_pkg_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderSimCardHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_sim_card_h(id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,sim_id,imsi,card_type,card_fee,card_data,card_data_proc_id,ext_field_1,ext_field_2,ext_field_3,ext_field_4)
  			values(#{id},#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{sim_id},#{imsi},#{card_type},#{card_fee},#{card_data},#{card_data_proc_id},#{ext_field_1},#{ext_field_2},#{ext_field_3},#{ext_field_4})
  		</create>
  		<query name="queryInfoServiceOrderSimCardHisByOrderNo">
  		select * from info_serv_sim_card_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderFixHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_fix_h(serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,acc_nbr,machine_nbr,stardand_addr_id,install_address,nbr_area_code,ext_field_1,ext_field_2)
  			values(#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{acc_nbr},#{machine_nbr},#{stardand_addr_id},#{install_address},#{nbr_area_code},#{ext_field_1},#{ext_field_2})
  		</create>
  		<query name="queryInfoServiceOrderFixHisByOrderNo">
  			select * from info_serv_fix_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderM165HisPo" type="jdbc">  
        <create>
  		    insert into info_serv_m165_h(serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,acc_nbr,passwd,line_nbr,stardand_addr_id,install_address,nbr_area_code,accept_type,speed,ext_field_1,ext_field_2)
  			values(#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{acc_nbr},#{passwd},#{line_nbr},#{stardand_addr_id},#{install_address},#{nbr_area_code},#{accept_type},#{speed},#{ext_field_1},#{ext_field_2})
  		</create>
  		<query name="queryInfoServiceOrderM165HisByOrderNo">
  			select * from info_serv_m165_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderGoodNbrHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_good_nbr_h(serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,nbr_level,nbr_pre_save,month_consume,time_dur_pro,ext_field_1,ext_field_2)
  			values(#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{nbr_level},#{nbr_pre_save},#{month_consume},#{time_dur_pro},#{ext_field_1},#{ext_field_2})
  		</create>
  		<query name="queryInfoServiceOrderGoodNbrHisByOrderNo">
  			select * from info_serv_good_nbr_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderCollectionHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_collection_h(id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,account_id,bank_code,bank_name,bank_account,bank_area_code,bank_area_name,collection_type,collection_sn,save_type,upper_bank_code)
  			values(#{id},#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{account_id},#{bank_code},#{bank_name},#{bank_account},#{bank_area_code},#{bank_area_name},#{collection_type},#{collection_sn},#{save_type},#{upper_bank_code})
  		</create>
  		<query name="queryInfoServiceOrderCollectionHisByOrderNo">
  			select * from info_serv_collection_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderGuarantorHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_guarantor_h(id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,guarant_type,guarant_project,guarant_method,guarant_eff_time,guarant_depart_code,guarant_sn)
  			values(#{id},#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{guarant_type},#{guarant_project},#{guarant_method},all_to_date(#{guarant_eff_time},'yyyy-mm-dd hh:mm:ss'),#{guarant_depart_code},#{guarant_sn})
  		</create>
  		<query name="queryInfoServiceOrderGuarantorHisByOrderNo">
  			select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,guarant_type,guarant_project,guarant_method,all_to_str(guarant_eff_time,'yyyy-mm-dd hh:mm:ss')guarant_eff_time,guarant_depart_code,guarant_sn  from  info_serv_guarantor_h where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderDeveloperHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_developer_h(id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,acc_nbr,developer_code,developer_name,develop_depart_id,develop_depart_name,develop_type,develop_target_code,develop_time)
  			values(#{id},#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{acc_nbr},#{developer_code},#{developer_name},#{develop_depart_id},#{develop_depart_name},#{develop_type},#{develop_target_code},all_to_date(#{develop_time},'yyyy-mm-dd hh:mm:ss'))
  		</create>
  		<query name="queyInfoServiceOrderDeveloperHisByOrderNo">
  			select id,serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,acc_nbr,developer_code,developer_name,develop_depart_id,develop_depart_name,develop_type,develop_target_code,all_to_str(develop_time,'yyyy-mm-dd hh:mm:ss')develop_time  from  info_serv_developer_h where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderPersionHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_person_h(serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,cust_id,cust_name,new_flag,cust_phone,email,cust_address,sex,cust_type,cert_type,cert_no,cert_address,cert_expire_date,cert_link1,cert_link2,cert_link3)
  			values(#{serv_order_no},#{ofr_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{cust_id},#{cust_name},#{new_flag},#{cust_phone},#{email},#{cust_address},#{sex},#{cust_type},#{cert_type},#{cert_no},#{cert_address},#{cert_expire_date},#{cert_link1},#{cert_link2},#{cert_link3})
  		</create>
  		<query name="queryInfoServiceOrderPersionHisByOrderNo">
  			 select serv_order_no,ofr_order_no,sale_order_no,province_code,area_code,part_month,cust_id,cust_name,new_flag,cust_phone,email,cust_address,sex,cust_type,cert_type,cert_no,cert_address,cert_expire_date,cert_link1,cert_link2,cert_link3
   			 from info_serv_person_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoServiceOrderExtHisPo" type="jdbc">  
        <create>
  		    insert into info_serv_ext_h(serv_order_no,sale_order_no,ofr_order_no,province_code,area_code,part_month,ext_field_1,ext_field_2,ext_field_3,ext_field_4,ext_field_5,ext_field_6,ext_field_7,ext_field_8,ext_field_9,ext_field_10,ext_field_11,ext_field_12,ext_field_13,ext_field_14,ext_field_15,ext_field_16,ext_field_17,ext_field_18,ext_field_19,ext_field_20,
  		    ext_field_21,ext_field_22,ext_field_23,ext_field_24,ext_field_25,ext_field_26,ext_field_27,ext_field_28,ext_field_29,ext_field_30,ext_field_31,ext_field_32,ext_field_33,ext_field_34,ext_field_35,ext_field_36,ext_field_37,ext_field_38,ext_field_39,ext_field_40)
  			values(#{serv_order_no},#{sale_order_no},#{ofr_order_no},#{province_code},#{area_code},#{part_month},#{ext_field_1},#{ext_field_2},#{ext_field_3},#{ext_field_4},#{ext_field_5},#{ext_field_6},#{ext_field_7},#{ext_field_8},#{ext_field_9},#{ext_field_10},#{ext_field_11},#{ext_field_12},#{ext_field_13},#{ext_field_14},#{ext_field_15},#{ext_field_16},#{ext_field_17},#{ext_field_18},#{ext_field_19},#{ext_field_20},
  			#{ext_field_21},#{ext_field_22},#{ext_field_23},#{ext_field_24},#{ext_field_25},#{ext_field_26},#{ext_field_27},#{ext_field_28},#{ext_field_29},#{ext_field_30},#{ext_field_31},#{ext_field_32},#{ext_field_33},#{ext_field_34},#{ext_field_35},#{ext_field_36},#{ext_field_37},#{ext_field_38},#{ext_field_39},#{ext_field_40})
  		</create>
  		<query name="queryInfoServiceOrderExtHisByServOrderNo">
  			select * from info_serv_ext_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if> 
         	<if test="filter.ofr_order_no != null and filter.ofr_order_no != ''">
          			and ofr_order_no ='${filter.ofr_order_no}' 
         	</if>     
		</query>
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSaleOrderExtHisPo" type="jdbc">  
       <create>
  		    insert into info_sale_ext_h(sale_order_no,province_code,area_code,part_month,ext_field_1,ext_field_2,ext_field_3,ext_field_4,ext_field_5,ext_field_6,ext_field_7,ext_field_8,ext_field_9,ext_field_10,ext_field_11,ext_field_12,ext_field_13,ext_field_14,ext_field_15,ext_field_16,ext_field_17,ext_field_18,ext_field_19,ext_field_20)
  			values(#{sale_order_no},#{province_code},#{area_code},#{part_month},#{ext_field_1},#{ext_field_2},#{ext_field_3},#{ext_field_4},#{ext_field_5},#{ext_field_6},#{ext_field_7},#{ext_field_8},#{ext_field_9},#{ext_field_10},#{ext_field_11},#{ext_field_12},#{ext_field_13},#{ext_field_14},#{ext_field_15},#{ext_field_16},#{ext_field_17},#{ext_field_18},#{ext_field_19},#{ext_field_20})
  		</create>
  		<query name="queryInfoSaleOrderExtHisBySaleOrderNo">
  			select * from info_sale_ext_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>     
		</query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.ProcInstTaskInstHisPo" type="jdbc">  
       <create>
  		    insert into task_inst_h(task_id,task_code,task_name,tache_code,province_code,area_code,part_month,order_no,order_type,proc_inst_id,oper_code,task_state,task_property,create_time,finish_time,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,limit_time,prod_code)
  			values(#{task_id},#{task_code},#{task_name},#{tache_code},#{province_code},#{area_code},#{part_month},#{order_no},#{order_type},#{proc_inst_id},#{oper_code},#{task_state},#{task_property},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name},all_to_date(#{limit_time},'yyyy-mm-dd hh:mm:ss'),#{prod_code})
  		</create>
  		<query name="queryTaskInstHisByOrderNo1">
            select task_id ,task_code ,task_name ,tache_code ,province_code ,area_code ,part_month ,order_no ,order_type ,proc_inst_id ,task_state ,task_property ,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time ,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time ,accept_oper_no ,accept_oper_name ,accept_depart_no ,accept_depart_name ,oper_code ,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time ,prod_code from task_inst_h where order_no = '${filter.order_no}' and area_code='${filter.area_code}' and part_month='${filter.part_month}'
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
            <if test="filter.task_state != null and filter.task_state != ''">
                and task_state = '${filter.task_state}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
        </query>
  		<query name="queryProcInstTaskInstHisByOrderNo">
  		     select task_id,task_code,task_name,tache_code,province_code,area_code,part_month,order_no,order_type,proc_inst_id,oper_code,task_state,task_property,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time,prod_code  from task_inst_h where order_no = '${filter.order_no}' and (task_state ='100' or task_state='101') and area_code='${filter.area_code}' and part_month='${filter.part_month}'
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
  		</query>
  		<query name="queryProcInstTaskInstHisByTacheCode">
  		     select task_id,task_code,task_name,tache_code,province_code,area_code,part_month,order_no,order_type,proc_inst_id,oper_code,task_state,task_property,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,all_to_str(limit_time,'yyyy-mm-dd hh:mm:ss')limit_time,prod_code  from task_inst_h where 1=1 and (task_state ='100' or task_state='101') and area_code='${filter.area_code}' and part_month='${filter.part_month}'
            <if test="filter.order_type != null and filter.order_type != ''">
                and order_type = '${filter.order_type}'
            </if>
            <if test="filter.province_code != null and filter.province_code != ''">
                and province_code = '${filter.province_code}'
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
  		</query>
  		<query name="queryTotalCountTaskHis">
  		    select task_id from task_inst_h where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                and task_state = 102
            </if>
  		</query>
  		<query name="queryCountNotOverdueTaskHis">
  		    select task_id from task_inst_h where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time&lt;0/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt; 102 AND sysdate - limit_time&lt;0/24) OR ( task_state = 102 AND finish_time - limit_time&lt;0/24))
            </if>
  		</query>
  		<query name="queryCountOverdueLessOneHourTaskHis">
  		    select task_id from task_inst_h where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time &lt; 1/24
                AND finish_time - limit_time &gt;= 0/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt;102 AND sysdate - limit_time &lt; 1/24 AND sysdate - limit_time &gt;= 0/24) OR ( task_state = 102  AND finish_time - limit_time &lt; 1/24 AND finish_time - limit_time &gt;= 0/24))
            </if>
  		</query>
  		<query name="queryCountOverdueOneToTwoHourTaskHis">
  		    select task_id from task_inst_h where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time &lt; 2/24
                AND finish_time - limit_time&gt;=1/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt; 102 AND sysdate - limit_time &lt; 2/24 AND sysdate - limit_time&gt;=1/24) OR ( task_state = 102  AND finish_time - limit_time &lt; 2/24 AND finish_time - limit_time&gt;=1/24))
            </if>
  		</query>
  		<query name="queryCountOverdueTwoToTwelveHourTaskHis">
  		     select task_id from task_inst_h where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time &lt; 12/24
                AND finish_time - limit_time&gt;=2/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt; 102 AND sysdate - limit_time &lt; 12/24 AND sysdate - limit_time&gt;=2/24) OR ( task_state = 102  AND finish_time - limit_time &lt; 12/24 AND finish_time - limit_time&gt;=2/24))
            </if>
  		</query>
  		<query name="queryCountOverdueTwelveToTwentyFourHourTaskHis">
  		    select task_id from task_inst_h where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time &lt; 24/24
                AND finish_time - limit_time&gt;=12/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt; 102 AND sysdate - limit_time &lt; 24/24 AND sysdate - limit_time&gt;=12/24) OR ( task_state = 102  AND finish_time - limit_time &lt; 24/24 AND finish_time - limit_time&gt;=12/24))
            </if>
  		</query>
  		<query name="queryCountOverdueMoreTwentyFourHourTaskHis">
  		    select task_id from task_inst_h where 1=1 and create_time&lt;all_to_date('${filter.endTime}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.startTime}','yyyy-mm-dd hh:mm:ss') and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' and accept_depart_no='${filter.accept_depart_no}'
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and accept_oper_no = '${filter.accept_oper_no}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and tache_code = '${filter.tache_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
                AND finish_time - limit_time&gt;=24/24
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '2'.toString()">
                AND ((task_state &lt;&gt; 102 AND sysdate - limit_time&gt;=24/24) OR ( task_state = 102 AND finish_time - limit_time&gt;=24/24))
            </if>
  		</query>
  		<query name="queryAllTaskInstHisGroupByTacheCode">
            select tache_code,task_name,count(0)tache_count from task_inst_h where 1=1 and create_time&lt;all_to_date('${filter.end_time}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.start_time}','yyyy-mm-dd hh:mm:ss')  and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' 
            <if test="filter.oper_no != null and filter.oper_no != ''">
                and accept_oper_no = '${filter.oper_no}'
            </if> 
            <if test="filter.depart_no != null and filter.depart_no != ''">
                and accept_depart_no = '${filter.depart_no}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
            </if>
            group by tache_code,task_name
        </query>
        <query name="queryCountAllTaskInstHisGroupByTacheCode">
            select task_id from task_inst_h where 1=1 and create_time&lt;all_to_date('${filter.end_time}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.start_time}','yyyy-mm-dd hh:mm:ss')  and province_code='${filter.province_code}' and area_code='${filter.area_code}' and part_month='${filter.part_month}' 
            <if test="filter.oper_no != null and filter.oper_no != ''">
                and accept_oper_no = '${filter.oper_no}'
            </if> 
            <if test="filter.depart_no != null and filter.depart_no != ''">
                and accept_depart_no = '${filter.depart_no}'
            </if>
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and prod_code = '${filter.prod_code}'
            </if> 
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '0'.toString()">
                AND task_state &lt;&gt; 102
            </if>
            <if test="filter.state != null and filter.state != '' and filter.state == '1'.toString()">
                AND task_state = 102
            </if>
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.ProcInstTaskDealRecordHisPo" type="jdbc">  
       	<create>
  		    insert into task_deal_record_h(id,task_id,province_code,area_code,part_month,deal_time,deal_oper_no,deal_system_no,deal_code,deal_desc,order_no,order_type,tache_code,oper_code,create_time,prod_code)
  			values(#{id},#{task_id},#{province_code},#{area_code},#{part_month},all_to_date(#{deal_time},'yyyy-mm-dd hh:mm:ss'),#{deal_oper_no},#{deal_system_no},#{deal_code},#{deal_desc},#{order_no},#{order_type},#{tache_code},#{oper_code},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),#{prod_code})
  		</create>
  		<query name="queryTaskDealRecordHisByOrderNo">
            select id,task_id,province_code,area_code,part_month,all_to_str(deal_time,'yyyy-mm-dd hh:mm:ss')deal_time,deal_oper_no,deal_system_no,deal_code,deal_desc,order_no,order_type,tache_code,oper_code,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,prod_code from task_deal_record_h where order_no=#{filter.order_no}  and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
        	<if test="filter.order_type != null and filter.order_type != ''">
          			and order_type ='${filter.order_type}'
         	</if>
         	<if test="filter.tache_code != null and filter.tache_code != ''">
          			and tache_code ='${filter.tache_code}'
         	</if>
         	<if test="filter.oper_code != null and filter.oper_code != ''">
          			and oper_code ='${filter.oper_code}'
         	</if>
         	order by deal_time desc
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoPayOrderHisPo" type="jdbc">  
       <create>
  		    insert into info_pay_order_h(pay_order_no,rela_order_no,rela_order_type,province_code,area_code,part_month,pay_fee,pay_type,pay_state,real_pay_sn,pay_time,pay_system_code,pay_system_name,create_time,finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name)
  			values(#{pay_order_no},#{rela_order_no},#{rela_order_type},#{province_code},#{area_code},#{part_month},#{pay_fee},#{pay_type},#{pay_state},#{real_pay_sn},all_to_date(#{pay_time},'yyyy-mm-dd hh:mm:ss'),#{pay_system_code},#{pay_system_name},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{proc_inst_id},#{ord_mod_code},#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name})
  		</create>
  		<query name="queryInfoPayOrderHisByOrderNo">
  			select pay_order_no,rela_order_no,rela_order_type,province_code,area_code,part_month,pay_fee,pay_type,pay_state,real_pay_sn,all_to_str(pay_time,'yyyy-mm-dd hh:mm:ss')pay_time,pay_system_code,pay_system_name,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name  from info_pay_order_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.pay_order_no != null and filter.pay_order_no != ''">
          			and pay_order_no ='${filter.pay_order_no}'
         	</if>  
         	<if test="filter.rela_order_no != null and filter.rela_order_no != ''">
          			and rela_order_no ='${filter.rela_order_no}' 
         	</if>     
		</query> 
		<query name="queryInfoPayOrderHisByPayType">
  			select  pay_order_no,rela_order_no,rela_order_type,province_code,area_code,part_month,pay_fee,pay_type,pay_state,real_pay_sn,all_to_str(pay_time,'yyyy-mm-dd hh:mm:ss')pay_time,pay_system_code,pay_system_name,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name   from info_pay_order_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}            
            <if test="filter.province_code != null and filter.province_code != ''">
          			and province_code ='${filter.province_code}'
         	</if>  
         	<if test="filter.pay_type != null and filter.pay_type != ''">
          			and pay_type ='${filter.pay_type}' 
         	</if>   
         	<if test="filter.rela_order_type != null and filter.rela_order_type != ''">
          			and rela_order_type ='${filter.rela_order_type}' 
         	</if>    
		</query> 
    </service>
    
     <service data="com.tydic.unicom.uoc.base.uochis.po.InfoDeliverOrderHisPo" type="jdbc">  
       <create>
  		    insert into info_deliver_order_h (deliver_order_no,sale_order_no,province_code,area_code,part_month,deliver_state,deliver_time,logistics_no,send_target_addr,create_time,finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,goods_name,note,send_name,real_phone,send_addr,contact_name,contact_tel,post_province,post_city,post_area,address,post_province_name,post_city_name,post_area_name,cod_charge,insure_charge,return_tracking_no,send_origin_addr,delivery_region,delivery_dept_no,cod_bank_no) 
            values(#{deliver_order_no},#{sale_order_no},#{province_code},#{area_code},#{part_month},#{deliver_state},all_to_date(#{deliver_time},'yyyy-mm-dd hh:mm:ss'),#{logistics_no},#{send_target_addr},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),all_to_date(#{finish_time},'yyyy-mm-dd hh:mm:ss'),#{proc_inst_id},#{ord_mod_code},#{accept_oper_no},#{accept_oper_name},#{accept_depart_no},#{accept_depart_name},#{goods_name},#{note},#{send_name},#{real_phone},#{send_addr},
                   #{contact_name},#{contact_tel},#{post_province},#{post_city},#{post_area},#{address},#{post_province_name},#{post_city_name},#{post_area_name},#{cod_charge},#{insure_charge},#{return_tracking_no},#{send_origin_addr},#{delivery_region},#{delivery_dept_no},#{cod_bank_no})
  		</create>
  		<query name="queryInfoDeliverOrderHisByOrderNo">
  		    select  deliver_order_no,sale_order_no,province_code,area_code,part_month,deliver_state,all_to_str(deliver_time,'yyyy-mm-dd hh:mm:ss')deliver_time,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,logistics_no,send_target_addr,goods_name,note,send_name,real_phone,send_addr,contact_name,contact_tel,post_province,post_city,post_area,address,post_province_name,post_city_name,post_area_name,cod_charge,insure_charge,return_tracking_no,send_origin_addr,delivery_region,delivery_dept_no,cod_bank_no  from info_deliver_order_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code}
            
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
          			and sale_order_no ='${filter.sale_order_no}'
         	</if>  
         	<if test="filter.deliver_order_no != null and filter.deliver_order_no != ''">
          			and deliver_order_no ='${filter.deliver_order_no}' 
         	</if>          	
  		</query>
  		<query name="queryInfoDeliverOrderHisAll">
			select deliver_order_no,sale_order_no,province_code,area_code,part_month,deliver_state,all_to_str(deliver_time,'yyyy-mm-dd hh:mm:ss')deliver_time,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,all_to_str(finish_time,'yyyy-mm-dd hh:mm:ss')finish_time,proc_inst_id,ord_mod_code,accept_oper_no,accept_oper_name,accept_depart_no,accept_depart_name,logistics_no,send_target_addr,goods_name,note,send_name,real_phone,send_addr,contact_name,contact_tel,post_province,post_city,post_area,address,post_province_name,post_city_name,post_area_name,cod_charge,insure_charge,return_tracking_no,send_origin_addr,delivery_region,delivery_dept_no,cod_bank_no  from info_deliver_order_h
             where 1=1 and finish_time&lt;all_to_date('${filter.finish_time}','yyyy-mm-dd hh:mm:ss') and create_time&gt;all_to_date('${filter.create_time}','yyyy-mm-dd hh:mm:ss') and area_code='${filter.area_code}' and part_month='${filter.part_month}'
         </query>
    </service>
    
   <service data="com.tydic.unicom.uoc.base.uocinst.po.SalesOrderListPo" type="jdbc">          
        <query name="querySalesOrderList">
           select DISTINCT a.sale_order_no  from info_sale_order a,info_service_order b,info_serv_person c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
           	<if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and a.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
            <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
            <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
            <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
                and a.sale_order_no = '${filter.sale_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and EXISTS (select e.order_no from task_inst e where e.order_no=b.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='101' and e.tache_code=#{filter.tache_code})
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
            limit ${filter.offset},${filter.limit}               
        </query>
        <query name="querySalesOrderListCount">
            select DISTINCT a.sale_order_no   from info_sale_order a,info_service_order b,info_serv_person c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and a.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
                and a.sale_order_no = '${filter.sale_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and EXISTS (select e.order_no from task_inst e where e.order_no=b.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='101' and e.tache_code=#{filter.tache_code})
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if> 
        </query>
    </service>
    
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.SalesOrderListHisPo" type="jdbc">  
        <query name="querySalesOrderListHis">
            select DISTINCT a.sale_order_no  from info_sale_order_h a,info_service_order_h b,info_serv_person_h c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and a.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
                and a.sale_order_no = '${filter.sale_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map_h d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and EXISTS (select e.order_no from task_inst_h e where e.order_no=b.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='101' and e.tache_code=#{filter.tache_code})
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order_h f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
            limit ${filter.offset},${filter.limit}              
        </query>
        <query name="querySalesOrderListHisCount">
            select DISTINCT a.sale_order_no  from info_sale_order_h a,info_service_order_h b,info_serv_person_h c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and a.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.sale_order_no != null and filter.sale_order_no != ''">
                and a.sale_order_no = '${filter.sale_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map_h d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and EXISTS (select e.order_no from task_inst_h e where e.order_no=b.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='101' and e.tache_code=#{filter.tache_code})
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order_h f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
        </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uochis.po.ServOrderListHisPo" type="jdbc">  
        <query name="queryServOrderHisList">
            select distinct b.serv_order_no,b.order_state,c.cert_no,c.cust_name,c.cust_phone,c.cust_address,b.acc_nbr,all_to_str(a.accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,a.accept_system,b.oper_code,a.accept_oper_no,a.accept_depart_no,a.accept_oper_name,a.accept_depart_name,a.accept_no,a.province_code,a.area_code,a.sale_order_no   from info_sale_order_h a,info_service_order_h b,info_serv_person_h c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and b.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.serv_order_no != null and filter.serv_order_no != ''">
                and b.serv_order_no = '${filter.serv_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map_h d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code_flag != null and filter.tache_code_flag != ''">
                and  (EXISTS(select e.order_no from task_inst e where e.order_no=b.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='101' and e.tache_code=#{filter.tache_code}   and #{filter.tache_code_flag} ='1')
                or EXISTS(select e.order_no from task_inst e where e.order_no=a.sale_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='100' and e.tache_code=#{filter.tache_code}   and #{filter.tache_code_flag} ='0'))
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order_h f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
            <if test="filter.sim_id != null and filter.sim_id != ''">
                and EXISTS (select sc.serv_order_no from info_serv_sim_card sc where sc.serv_order_no=b.serv_order_no and sc.area_code=#{filter.area_code} and sc.part_month=#{filter.part_month} and sc.sim_id=#{filter.sim_id})
            </if>
            <if test="filter.sort_type_asc != null and filter.sort_type_asc != ''">
                order by a.accept_time asc
            </if>
             <if test="filter.sort_type_desc != null and filter.sort_type_desc != ''">
                order by a.accept_time desc
            </if>
            
            limit ${filter.offset},${filter.limit}               
        </query>
         <query name="queryServOrderHisListCount">
             select b.serv_order_no,b.order_state,c.cert_no,c.cust_name,b.acc_nbr,all_to_str(a.accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,a.accept_system,b.oper_code,a.accept_oper_no,a.accept_depart_no,a.accept_oper_name,a.accept_depart_name,a.accept_no,a.province_code,a.area_code,a.sale_order_no   from info_sale_order_h a,info_service_order_h b,info_serv_person_h c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and b.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.serv_order_no != null and filter.serv_order_no != ''">
                and b.serv_order_no = '${filter.serv_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map_h d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code_flag != null and filter.tache_code_flag != ''">
                and  (EXISTS(select e.order_no from task_inst e where e.order_no=b.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='101' and e.tache_code=#{filter.tache_code}   and #{filter.tache_code_flag} ='1')
                or EXISTS(select e.order_no from task_inst e where e.order_no=a.sale_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='100' and e.tache_code=#{filter.tache_code}   and #{filter.tache_code_flag} ='0'))
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order_h f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
            <if test="filter.sim_id != null and filter.sim_id != ''">
                and EXISTS (select sc.serv_order_no from info_serv_sim_card sc where sc.serv_order_no=b.serv_order_no and sc.area_code=#{filter.area_code} and sc.part_month=#{filter.part_month} and sc.sim_id=#{filter.sim_id})
            </if>
        </query>
        <query name="queryServOrderHisListBySaleTacheCode">
            select distinct b.serv_order_no,b.order_state,c.cert_no,c.cust_name,b.acc_nbr,all_to_str(a.accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,a.accept_system,b.oper_code,a.accept_oper_no,a.accept_depart_no,a.accept_oper_name,a.accept_depart_name,a.accept_no,a.province_code,a.area_code,a.sale_order_no   from info_sale_order_h a,info_service_order_h b,info_serv_person_h c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and b.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.serv_order_no != null and filter.serv_order_no != ''">
                and b.serv_order_no = '${filter.serv_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map_h d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and EXISTS (select e.order_no from task_inst_h e where e.order_no=b.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='100' and e.tache_code=#{filter.tache_code})
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order_h f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
            
            limit ${filter.offset},${filter.limit}               
        </query>
         <query name="queryServOrderHisListCountBySaleTacheCode">
            select b.serv_order_no,b.order_state,c.cert_no,c.cust_name,b.acc_nbr,all_to_str(a.accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,a.accept_system,b.oper_code,a.accept_oper_no,a.accept_depart_no,a.accept_oper_name,a.accept_depart_name,a.accept_no,a.province_code,a.area_code,a.sale_order_no   from info_sale_order_h a,info_service_order_h b,info_serv_person_h c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and b.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.serv_order_no != null and filter.serv_order_no != ''">
                and b.serv_order_no = '${filter.serv_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map_h d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and EXISTS (select e.order_no from task_inst_h e where e.order_no=b.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='100' and e.tache_code=#{filter.tache_code})
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order_h f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
          </query>
    </service>
    
    <service data="com.tydic.unicom.uoc.base.uocinst.po.ServOrderListPo" type="jdbc">  
        <query name="queryServOrderList">
            select distinct b.serv_order_no,b.order_state,c.cert_no,c.cust_name,c.cust_phone,c.cust_address,b.acc_nbr,all_to_str(a.accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,a.accept_system,b.oper_code,a.accept_oper_no,a.accept_depart_no,a.accept_oper_name,a.accept_depart_name,a.accept_no,a.province_code,a.area_code,a.sale_order_no   from info_sale_order a,info_service_order b,info_serv_person c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and b.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.serv_order_no != null and filter.serv_order_no != ''">
                and b.serv_order_no = '${filter.serv_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code_flag != null and filter.tache_code_flag != ''">
                and  (EXISTS(select e.order_no from task_inst e where e.order_no=b.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='101' and e.tache_code=#{filter.tache_code}   and #{filter.tache_code_flag} ='1')
                or EXISTS(select e.order_no from task_inst e where e.order_no=a.sale_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='100' and e.tache_code=#{filter.tache_code}   and #{filter.tache_code_flag} ='0'))
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
            <if test="filter.sim_id != null and filter.sim_id != ''">
                and EXISTS (select sc.serv_order_no from info_serv_sim_card sc where sc.serv_order_no=b.serv_order_no and sc.area_code=#{filter.area_code} and sc.part_month=#{filter.part_month} and sc.sim_id=#{filter.sim_id})
            </if>
            <if test="filter.sort_type_asc != null and filter.sort_type_asc != ''">
                order by a.accept_time asc
            </if>
             <if test="filter.sort_type_desc != null and filter.sort_type_desc != ''">
                order by a.accept_time desc
            </if>
            
            limit ${filter.offset},${filter.limit}               
        </query>
         <query name="queryServOrderListCount">
             select b.serv_order_no,b.order_state,c.cert_no,c.cust_name,b.acc_nbr,all_to_str(a.accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,a.accept_system,b.oper_code,a.accept_oper_no,a.accept_depart_no,a.accept_oper_name,a.accept_depart_name,a.accept_no,a.province_code,a.area_code,a.sale_order_no   from info_sale_order a,info_service_order b,info_serv_person c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and b.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.serv_order_no != null and filter.serv_order_no != ''">
                and b.serv_order_no = '${filter.serv_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code_flag != null and filter.tache_code_flag != ''">
                and  (EXISTS(select e.order_no from task_inst e where e.order_no=b.serv_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='101' and e.tache_code=#{filter.tache_code}   and #{filter.tache_code_flag} ='1')
                or EXISTS(select e.order_no from task_inst e where e.order_no=a.sale_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='100' and e.tache_code=#{filter.tache_code}   and #{filter.tache_code_flag} ='0'))
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
            <if test="filter.sim_id != null and filter.sim_id != ''">
                and EXISTS (select sc.serv_order_no from info_serv_sim_card sc where sc.serv_order_no=b.serv_order_no and sc.area_code=#{filter.area_code} and sc.part_month=#{filter.part_month} and sc.sim_id=#{filter.sim_id})
            </if>
        </query>
        <query name="queryServOrderListBySaleTacheCode">
            select distinct b.serv_order_no,b.order_state,c.cert_no,c.cust_name,b.acc_nbr,all_to_str(a.accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,a.accept_system,b.oper_code,a.accept_oper_no,a.accept_depart_no,a.accept_oper_name,a.accept_depart_name,a.accept_no,a.province_code,a.area_code,a.sale_order_no   from info_sale_order a,info_service_order b,info_serv_person c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and b.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.serv_order_no != null and filter.serv_order_no != ''">
                 and b.serv_order_no = '${filter.serv_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and EXISTS (select e.order_no from task_inst e where e.order_no=a.sale_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='100' and e.tache_code=#{filter.tache_code})
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
            
            limit ${filter.offset},${filter.limit}               
        </query>
         <query name="queryServOrderListCountBySaleTacheCode">
             select b.serv_order_no,b.order_state,c.cert_no,c.cust_name,b.acc_nbr,all_to_str(a.accept_time,'yyyy-mm-dd hh:mm:ss')accept_time,a.accept_system,b.oper_code,a.accept_oper_no,a.accept_depart_no,a.accept_oper_name,a.accept_depart_name,a.accept_no,a.province_code,a.area_code,a.sale_order_no   from info_sale_order a,info_service_order b,info_serv_person c   where a.sale_order_no=b.sale_order_no and a.sale_order_no=c.sale_order_no  and b.serv_order_no=c.serv_order_no  and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}  and b.area_code=#{filter.area_code}  and b.part_month=#{filter.part_month} and c.area_code=#{filter.area_code} and c.part_month=#{filter.part_month} and a.accept_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and a.accept_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')  and a.province_code=#{filter.province_code}
            <if test="filter.accept_depart_no != null and filter.accept_depart_no != ''">
                 and a.accept_depart_no=#{filter.accept_depart_no}
            </if>
            <if test="filter.accept_oper_no != null and filter.accept_oper_no != ''">
                and a.accept_oper_no = '${filter.accept_oper_no}'
            </if>
            <if test="filter.order_state != null and filter.order_state != ''">
                and b.order_state = '${filter.order_state}'
            </if>
            <if test="filter.acc_nbr != null and filter.acc_nbr != ''">
                and b.acc_nbr = '${filter.acc_nbr}'
            </if>
            <if test="filter.oper_code != null and filter.oper_code != ''">
                and b.oper_code = '${filter.oper_code}'
            </if>
             <if test="filter.accept_no != null and filter.accept_no != ''">
                and a.accept_no = '${filter.accept_no}'
            </if>
             <if test="filter.accept_system != null and filter.accept_system != ''">
                and a.accept_system = '${filter.accept_system}'
            </if>
             <if test="filter.cust_name != null and filter.cust_name != ''">
                and  c.cust_name like '%${filter.cust_name}%'
            </if> 
            <if test="filter.cert_no != null and filter.cert_no != ''">
                and c.cert_no='${filter.cert_no}'
            </if>  
            <if test="filter.serv_order_no != null and filter.serv_order_no != ''">
                 and b.serv_order_no = '${filter.serv_order_no}'
            </if> 
            <if test="filter.prod_code != null and filter.prod_code != ''">
                and EXISTS (select d.serv_order_no from info_serv_prod_map d where d.serv_order_no=b.serv_order_no and d.area_code=#{filter.area_code} and d.part_month=#{filter.part_month} and d.prod_code=#{filter.prod_code})
            </if>
            <if test="filter.tache_code != null and filter.tache_code != ''">
                and EXISTS (select e.order_no from task_inst e where e.order_no=a.sale_order_no and e.area_code=#{filter.area_code} and e.part_month=#{filter.part_month} and e.order_type='100' and e.tache_code=#{filter.tache_code})
            </if>
            <if test="filter.pay_type != null and filter.pay_type != ''">
                and EXISTS (select f.rela_order_no from info_pay_order f where f.rela_order_no=a.sale_order_no and f.area_code=#{filter.area_code} and f.part_month=#{filter.part_month} and f.pay_type=#{filter.pay_type})
            </if>
        </query>
    </service>
    <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoSmsWarnPo" type="jdbc">  
        <create>
  		   insert into info_sms_warn(id,order_no,order_type,province_code,area_code,part_month,tache_code,oper_code,acc_nbr,sms_content,send_time,send_status,remarks,accept_oper_no,accept_depart_no,insert_time)
  			values(#{id},#{order_no},#{order_type},#{province_code},#{area_code},#{part_month},#{tache_code},#{oper_code},#{acc_nbr},#{sms_content},all_to_date(#{send_time},'yyyy-mm-dd hh:mm:ss'),#{send_status},#{remarks},#{accept_oper_no},#{accept_depart_no},all_to_date(#{insert_time},'yyyy-mm-dd hh:mm:ss'))
  		</create>
  		<delete>
  			delete from info_sms_warn where order_no=#{order_no} and province_code=#{province_code} and area_code=#{area_code}
  		</delete>
    </service>
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoSmsWarnHisPo" type="jdbc">  
        <create>
  		   insert into info_sms_warn_h(id,order_no,order_type,province_code,area_code,part_month,tache_code,oper_code,acc_nbr,sms_content,send_time,send_status,remarks,accept_oper_no,accept_depart_no,insert_time)
  			values(#{id},#{order_no},#{order_type},#{province_code},#{area_code},#{part_month},#{tache_code},#{oper_code},#{acc_nbr},#{sms_content},all_to_date(#{send_time},'yyyy-mm-dd hh:mm:ss'),#{send_status},#{remarks},#{accept_oper_no},#{accept_depart_no},all_to_date(#{insert_time},'yyyy-mm-dd hh:mm:ss'))
  		</create>
    </service>
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoWriteCardResultHisPo" type="jdbc">  
        <create>
  		  insert into info_write_card_result_h(id,serv_order_no,province_code,area_code,part_month,sim_id,cust_name,acc_nbr,create_time,accept_oper_no,accept_depart_no,write_card_result,failed_desc)
  			values(#{id},#{serv_order_no},#{province_code},#{area_code},#{part_month},#{sim_id},#{cust_name},#{acc_nbr},all_to_date(#{create_time},'yyyy-mm-dd hh:mm:ss'),#{accept_oper_no},#{accept_depart_no},#{write_card_result},#{failed_desc})
  		</create>
  		<query name="queryInfoWriteCardResultHis">
  		    select distinct id,serv_order_no,province_code,area_code,part_month,sim_id,cust_name,acc_nbr,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,accept_oper_no,accept_depart_no,write_card_result,failed_desc  from info_write_card_result_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code} and  create_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and create_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')           
            <if test="filter.province_code != null and filter.province_code != ''">
          			and province_code ='${filter.province_code}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>   
         	<if test="filter.write_card_result != null and filter.write_card_result != ''">
          			and write_card_result ='${filter.write_card_result}' 
         	</if>  
         	<if test="filter.sim_id != null and filter.sim_id != ''">
          			and sim_id ='${filter.sim_id}'
         	</if>
         	<if test="filter.acc_nbr != null and filter.acc_nbr != ''">
          			and acc_nbr ='${filter.acc_nbr}'
         	</if>    
         	<if test="filter.cust_name != null and filter.cust_name != ''">
          			and cust_name  like '%${filter.cust_name}%'
         	</if> 
         	<if test="filter.sim_id_begin != null and filter.sim_id_begin != ''">
          			and sim_id &gt;='${filter.sim_id_begin}'
         	</if>  
         	<if test="filter.sim_id_end != null and filter.sim_id_end != ''">
          			and sim_id &lt;='${filter.sim_id_end}' 
         	</if>
         	limit ${filter.offset},${filter.limit}             	
  		</query>
  		<query name="queryInfoWriteCardResultCount">
  		    select  id,serv_order_no,province_code,area_code,part_month,sim_id,cust_name,acc_nbr,all_to_str(create_time,'yyyy-mm-dd hh:mm:ss')create_time,accept_oper_no,accept_depart_no,write_card_result,failed_desc  from info_write_card_result_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code} and  create_time&gt;=all_to_date(#{filter.accept_time_start},'yyyy-mm-dd hh:mm:ss') and create_time&lt;=all_to_date(#{filter.accept_time_end},'yyyy-mm-dd hh:mm:ss')
            <if test="filter.province_code != null and filter.province_code != ''">
          			and province_code ='${filter.province_code}'
         	</if>  
         	<if test="filter.serv_order_no != null and filter.serv_order_no != ''">
          			and serv_order_no ='${filter.serv_order_no}' 
         	</if>
         	<if test="filter.write_card_result != null and filter.write_card_result != ''">
          			and write_card_result ='${filter.write_card_result}' 
         	</if>
         	<if test="filter.sim_id != null and filter.sim_id != ''">
          			and sim_id ='${filter.sim_id}'
         	</if> 
         	<if test="filter.acc_nbr != null and filter.acc_nbr != ''">
          			and acc_nbr ='${filter.acc_nbr}'
         	</if>  
         	<if test="filter.cust_name != null and filter.cust_name != ''">
          			and cust_name  like '%${filter.cust_name}%'
         	</if> 
         	<if test="filter.sim_id_begin != null and filter.sim_id_begin != ''">
          			and sim_id &gt;='${filter.sim_id_begin}'
         	</if>  
         	<if test="filter.sim_id_end != null and filter.sim_id_end != ''">
          			and sim_id &lt;='${filter.sim_id_end}' 
         	</if>
  		</query>
    </service>
 
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoGztHisPo" type="jdbc">  
        <create>
  		  insert into info_gzt_h(serv_order_no,province_code,area_code,part_month,addr,birthday,certid,certname,nation,photo,sex,exp,issue,cert_face_url)
  			values(#{serv_order_no},#{province_code},#{area_code},#{part_month},#{addr},#{birthday},#{certid},#{certname},#{nation},#{photo},#{sex},#{exp},#{issue},#{cert_face_url})
  		</create>
  		<query name="queryInfoGztHisByServOrderNo">
  		    select  serv_order_no,province_code,area_code,part_month,addr,birthday,certid,certname,nation,photo,sex,exp,issue,cert_face_url  from info_gzt_h  where 1=1 and  part_month=#{filter.part_month} and area_code=#{filter.area_code} and serv_order_no=#{filter.serv_order_no}        	
  		</query>
    </service>
 
    <service data="com.tydic.unicom.uoc.base.uochis.po.InfoOrderCancelHisPo" type="jdbc">
    	<query name="queryInfoOrderCancelHisByPo">
    	    select a.order_no,a.order_type,a.province_code,a.area_code,a.part_month,a.cancel_type,all_to_str(a.cancel_time,'yyyy-mm-dd hh:mm:ss')cancel_time,a.cancel_oper_no,a.cancel_tache_code,a.cancel_reason,a.audit_state,all_to_str(a.audti_time,'yyyy-mm-dd hh:mm:ss')audti_time,a.audit_oper_no,a.audit_desc
 			from info_order_cancel_h a where 1=1  and a.order_no=#{filter.order_no} and a.area_code=#{filter.area_code} and a.part_month=#{filter.part_month}
 			<if test="filter.order_type != null and filter.order_type != ''">
          			 and  a.order_type=#{filter.order_type} 
         	</if> 
    	</query>
    	<create>
  	       insert into info_order_cancel_h (order_no,order_type,province_code,area_code,part_month,cancel_type,cancel_time,cancel_oper_no,cancel_tache_code,cancel_reason,audit_state,audti_time,audit_oper_no,audit_desc) 
  	       values (#{order_no},#{order_type},#{province_code},#{area_code},#{part_month},#{cancel_type},all_to_date(#{cancel_time},'yyyy-mm-dd hh:mm:ss'),#{cancel_oper_no},#{cancel_tache_code},#{cancel_reason},#{audit_state},all_to_date(#{audti_time},'yyyy-mm-dd hh:mm:ss'),#{audit_oper_no},#{audit_desc})
  	    </create>
    </service>
    <service data="com.tydic.unicom.uoc.base.uoccode.po.InfoUserGrantPo" type="jdbc">
    	<create>
  	       insert into info_user_grant (device_number,user_no,user_status,grant_type,total_grant,residual_grant,each_grant,in_net_date) 
  	       values (#{device_number},#{user_no},#{user_status},#{grant_type},#{total_grant},#{residual_grant},#{each_grant},#{in_net_date})
  	    </create>
  	    <update>
  	        update info_user_grant  set residual_grant =#{residual_grant}
            where device_number =#{device_number} and user_status=#{user_status}
  	    </update>
  	    <query name="queryInfoUserGrantList">
  	        select device_number,user_no,user_status,grant_type,total_grant,residual_grant,each_grant,in_net_date from info_user_grant where 1=1
            <if test="filter.device_number != null and filter.device_number != ''">
          		and device_number ='${filter.device_number}'
         	</if>
         	<if test="filter.user_status != null and filter.user_status != ''">
          		and user_status ='${filter.user_status}'
         	</if>
  	    </query>
  	    <query name="queryNeedGrantUser">
  	        select a.device_number,a.user_no,a.user_status,a.grant_type,a.total_grant,a.residual_grant,a.each_grant,a.in_net_date from   
			(select i.device_number,i.user_no,i.user_status,i.grant_type,i.total_grant,i.residual_grant,i.each_grant,i.in_net_date from 
			info_user_grant i where i.user_status = '0' and i.residual_grant &gt; 0 and i.device_number not in (select device_number from user_grant_fee where acct_month = #{filter.current_month})) a,
			(select service_num from comm_d_f_user_extinfo where attr_code = '1001' and month_id=#{filter.yester_month} and day_id=#{filter.yester_day} group by service_num) c where a.device_number=c.service_num
  	    </query>
    </service>
    <service data="com.tydic.unicom.uoc.base.uoccode.po.UserGrantFeePo" type="jdbc">
    	<create>
    	    insert into user_grant_fee (device_number,active_flag,acct_month,grant_fee,deal_flag,deal_result,create_date,update_date,grant_type) 
  	       	values (#{device_number},#{active_flag},#{acct_month},#{grant_fee},#{deal_flag},#{deal_result},#{create_date},#{update_date},#{grant_type})
    	</create>
    	<update>
    	    update user_grant_fee  set deal_flag =#{deal_flag},deal_result=#{deal_result},update_date=#{update_date}
            where device_number =#{device_number} and acct_month=#{acct_month}
    	</update>
    	<query name="queryUserGrantFeeList">
  	        select device_number,active_flag,acct_month,grant_fee,deal_flag,deal_result,create_date,update_date,grant_type from user_grant_fee where 1=1
            <if test="filter.device_number != null and filter.device_number != ''">
          		and device_number ='${filter.device_number}'
         	</if>
         	<if test="filter.acct_month != null and filter.acct_month != ''">
          		and acct_month ='${filter.acct_month}'
         	</if>
         	<if test="filter.deal_flag != null and filter.deal_flag != ''">
          		and deal_flag ='${filter.deal_flag}'
         	</if>
  	    </query>
    </service>
    <service data="com.tydic.unicom.uoc.base.uocinst.po.LogHalfYearPkgPo" type="jdbc">
    	<create>
    	insert into log_halfyear_pkg_h (id,order_no,province_code,area_code,part_month,acc_nbr,res_money,res_count,res_type,valid_month,accept_oper_no,accept_depart_no,insert_time)
    	values (#{id},#{order_no},#{province_code},#{area_code},#{part_month},#{acc_nbr},#{res_money},#{res_count},#{res_type},#{valid_month},#{accept_oper_no},#{accept_depart_no},all_to_date(#{insert_time},'yyyy-mm-dd hh:mm:ss'))
    	</create>
    </service>
    <!-- <service data="com.tydic.unicom.uoc.base.uocinst.po.InfoProdAttrPo" type="jdbc">
        <create>
            insert into info_prod_attr (id,prod_order_sn,ofr_order_sn,cust_order_sn,province_code,area_code,attr_code,attr_value_type,upper_attr_code,upper_attr_value,attr_after_value,attr_before_value) 
            values (#{id},#{prod_order_sn},#{ofr_order_sn},#{cust_order_sn},#{province_code},#{area_code},#{attr_code},#{attr_value_type},#{upper_attr_code},#{upper_attr_value},#{attr_after_value},#{attr_before_value})
        </create>
    </service> -->
    
	<!-- <service data="com.tydic.unicom.demo.po.TestUserPo" type="jdbc">
		CREATE
		<create> 
		insert into test_user (ID, NAME, AGE)values (#{id}, #{name}, #{age});		
		</create>
		UPDATE 支持配置name属性
		<update name="update1"> 
		update test_user set name=#{filter.name},age=#{filter.age} where id=#{filter.id}
		</update>
		
		<update> 
		update test_user set name=#{name},age=#{age} where id=#{id}
		</update>
		DELETE 支持配置name属性
		<delete> 
		delete from test_user where name=#{name}
		</delete>
		
		<delete name="delete1"> 
		delete from test_user where name=#{filter.name}
		</delete>
		
		QUERY 支持配置name属性
		<query name="query">
			select * from test_user where name = #{filter.name}
		</query>
		
		<query name="query2">
			select * from test_user2 limit 5; 
		</query>
		
		<query name="query1">
			select * from test_user where name = #{filter.name} and id=#{filter.id}
		</query>
		
		<query name="query4">
			select * from test_user where name like '${filter.name}%'
		</query>
		
		<queryfor name="int">
			select count(*) from test_user where name = #{filter.name}
		</queryfor>

	</service>	 -->
	
	<!-- <service data="com.tydic.unicom.demo.po.TestActivemqSendPo" type="activemq"> 
	</service>
	<service data="com.tydic.unicom.demo.po.TestRedisPo" type="redis"> 
	</service> -->
	
</services>